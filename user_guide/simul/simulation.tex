\chapter{ Perform a MESONH simulation} \label{ch:model}


\section{Presentation}

The MESONH user will  
specify some free parameters of the run by fixing their new values in the
NAMELISTs of the file EXSEG\$n.nam. 

When more than one model is present, each model needs its own MESONH file to be
initialized and its own EXSEG\$n.nam file to fix the free-parameters (note that a lot
of physical free-parameters depends on the mesh and therefore vary with the
model number). 

The input files are read by the program in order to realize the initialization and
the eventual coupling of the
MESONH model with a large-scale model ( CEP, Arp\`ege...). \\

The output files are of two types:
\begin{itemize}
\item
synchronous files for a given instant of the run. They contain the prognostic
fields and  eventually,
additionnal records for supplementary diagnostic  fields at the same instant.
The file name ends by {\tt 00n} with {\tt n}$>$0
\item
a diachronic file for the temporal series of prognostic or diagnostic fields.
The file name ends by {\tt 000}
\end{itemize}

\section{The input EXSEG\$n.nam file}
We now describe in the following subsection the different NAMELISTs present in 
a complete EXSEG\$n.nam file. 
Each variable present in a namelist of the EXSEG\$n.nam file
belongs to a declarative module whose name is related to the namelist name:

NAM\_xxxxx    $\Longrightarrow $ MODD\_xxxxx

The documentation of the
declarative modules  MODD\_xxxxx can be found in the Fortran code and contains 
a description of each variable of the Namelist NAM\_xxxxx. Thus, we 
only give the list of the subset of MODD\_xxxxx present in the Namelist  
NAM\_xxxxx with a short description of each parameter.


 For instance, if no
value is present for the variable CPRESOPT in the NAMELIST NAM\_DYNn of 
EXSEG2.nam ( the index 2 is for model 2 ), the
model will take the value present in the MESONH file, used to initialize the
model 2 for this segment. This information is present in the descriptive part of
the MESONH file (see Chapter 3). If it is also absent from the MESONH
initial file, the model will use its default value defined in the  
code.\\


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_2D\_FRC}
\index{NAM\_2D\_FRC!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
L2D\_ADV\_FRC   &  logical  & .FALSE.   \\
L2D\_REL\_FRC   &  logical  & .FALSE.   \\
XRELAX\_HEIGHT\_BOT & real & 0.\\
XRELAX\_HEIGHT\_TOP & real & 30000.\\
XRELAX\_TIME & real & 864000.\\

\hline
\end{tabular}
\end{center}
\begin{itemize}
\item L2D\_ADV\_FRC : flag to activate advecting forcing (2D simulations),
 using files passed through namelist PRE\_IDEA1.nam
\index{L2D\_ADV\_FRC!\innam{NAM\_2D\_FRC}}
\item L2D\_REL\_FRC : flag to activate relaxation forcing (2D simulations), 
using files passed through namelist PRE\_IDEA1.nam
\index{L2D\_REL\_FRC!\innam{NAM\_2D\_FRC}}
\item XRELAX\_HEIGHT\_BOT : lower limit of relaxation (m)
\index{XRELAX\_HEIGHT\_BOT!\innam{NAM\_2D\_FRC}}
\item XRELAX\_HEIGHT\_TOP : upper limit of relxation (m)
\index{XRELAX\_HEIGHT\_TOP!\innam{NAM\_2D\_FRC}}
\item XRELAX\_TIME : relaxation timsescale (s)
\index{XRELAX\_TIME!\innam{NAM\_2D\_FRC}}
\end{itemize}
\subsection{Namelist NAM\_ADVn (scalar advection schemes of model n)}
\label{ss:withn}
\index{NAM\_ADVn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
CUVW\_ADV\_SCHEME   &  6 characters  & 'WENO\_K'   \\
CMET\_ADV\_SCHEME    &  6 characters  & 'PPM\_01'   \\
CSV\_ADV\_SCHEME    &  6 characters  & 'PPM\_01'   \\
CTEMP\_SCHEME    &  4 characters  & 'RK53'   \\
NWENO\_ORDER    &  integer       & 3   \\
LSPLIT\_CFL   &  logical       & .TRUE.   \\
LSPLIT\_WENO   &  logical       & .TRUE.   \\
XSPLIT\_CFL   &  real          & 0.8      \\
LCFL\_WRIT  &  logical       & .FALSE.   \\
\hline
\end{tabular}
\end{center}


It contains the different advection schemes for dynamic variables (u,v and w), scalar
meteorological variables
(temperature, water substances, TKE) and tracers used by the model n. 
They are included in the declarative module MODD\_ADVn
\begin{itemize}

\item
\index{CUVW\_ADV\_SCHEME!\innam{NAM\_ADVn}}
CUVW\_ADV\_SCHEME: Advection scheme used for 
horizontal and vertical velocities:
The following options
are possible : 
\begin{itemize}
\item 'WENO\_K' WENO odd\_ordered advection scheme
\item 'CEN2ND' 2nd order advection scheme CENtred on space and time
\item 'CEN4TH' 4th order advection scheme CENtred on space and time
\end{itemize}

\item
\index{CMET\_ADV\_SCHEME!\innam{NAM\_ADVn}}
CMET\_ADV\_SCHEME: Advection scheme used for the following METeorological variables:
temperature, water substances and TKE. The following options
are possible (see the Scientific Documentation for more details): 
\begin{itemize}
\item 'PPM\_00' PPM advection scheme without constraint
\item 'PPM\_01' Monotonic version of PPM. It is POSITIVE definite.
\end{itemize}


\item
\index{CSV\_ADV\_SCHEME!\innam{NAM\_ADVn}}
CSV\_ADV\_SCHEME: Advection scheme used for the tracer variables. The same options as CMET\_ADV\_SCHEME can be used.\\

Note that if LLG=T in NAM\_CONF, CSV\_ADV\_SCHEME must be equal to CMET\_ADV\_SCHEME.

\item
\index{CTEMP\_SCHEME!\innam{NAM\_ADVn}}
CTEMP\_SCHEME: Temporal scheme for momentum advection (the rest of the model is in Forward In Time).
The following options are possible :
\begin{itemize}
\item 'LEFR' Leap-Frog scheme (only for CEN4TH or CEN2ND wind schemes)
\item 'RKC4' Runge-Kutta centred 4th order (recommended for CEN4TH)
\item 'RK53' Runge-Kutta 5 steps 3th order  (recommended for WENO5 and WENO3)
\item 'RK33' Runge-Kutta 3 steps 3th order 
\item 'RK21' Runge-Kutta 2 steps 1st order 
\end{itemize}


\item
\index{NWENO\_ORDER!\innam{NAM\_ADVn}}
NWENO\_ORDER: Order of WENO scheme for CUVW\_ADV\_SCHEME. For the moment, 
the 3rd order and the 5th order are available.

\item
\index{LSPLIT\_CFL!\innam{NAM\_ADVn}}
LSPLIT\_CFL: Flag to split PPM advection as a function of CFL

\item
\index{XSPLIT\_CFL!\innam{NAM\_ADVn}}
XSPLIT\_CFL: Allowed CFL maximum value for LSPLIT\_CFL=T.  

\item
\index{LSPLIT\_WRITE!\innam{NAM\_ADVn}}
LSPLIT\_WRITE: Flag to store CFL fields on every output synchronous file.

\item
\index{LSPLIT\_WENO!\innam{NAM\_ADVn}}
LSPLIT\_WENO: Flag to split WENO momentum advection


\end{itemize}
%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_BLANK (available variables)}
See section \ref{s:namblank} page \pageref{s:namblank} for details.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_BLOWSNOW }
\index{NAM\_BLOWSNOW!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline

LBLOWSNOW    & logical & FALSE     \\
NBLOWSNOW3D  & integer & 2         \\
NBLOWSNOW\_2D& integer & 3       \\
XALPHA\_SNOW & real    &3 \\
XRSNOW       & real    & 4\\
\hline
\end{tabular}
\end{center}
It contains the variables and types for the BLOWSNOW scheme.

\begin{itemize}
\item LBLOWSNOW : flag to active pronostic blowing snow 
\index{LBLOWSNOW!\innam{NAM\_BLOWSNOW}}
\item NBLOWSNOW3D : Number of blowing snow variables as scalar in Meso-NH. The curent version of the model use two scalars:
number concentration and mass concentration (kg/kg)
\index{NBLOWSNOW3D!\innam{NAM\_BLOWSNOW}}
\item NBLOWSNOW\_2D :  Number of 2D blowing snow variables advected in Meso-NH. The curent version of the model advectes three variables: total number concentration in Canopy, total mass concentration in Canopy and equivalent concentration in the saltation layer

\index{NBLOWSNOW\_2D!\innam{NAM\_BLOWSNOW}}
\item XALPHA\_SNOW : Gamma distribution shape factor
\index{XALPHA\_SNOW!\innam{NAM\_BLOWSNOW}}
\item XRSNOW :Ratio between diffusion coefficient for scalar variables and blowing snow variables
\begin{itemize}
	\item RSNOW = KSCA/KSNOW = 4. (if Redelsperger-Sommeria (1981) used in ini\_cturb)
	\item RSNOW = KSCA/KSNOW = 2.5 ( if Cheng-Canuto-Howard (2002) used in ini\_cturb)
\end{itemize}
\index{XRSNOW!\innam{NAM\_BLOWSNOW}}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_BLOWSNOWn }
\index{NAM\_BLOWSNOWn!namelist description}
\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline

LSNOWSUBL  & logical & FALSE     \\
\hline
\end{tabular}
\end{center}
It contains the variables and types for the BLOWSNOW scheme.

\begin{itemize}
\item  LSNOWSUBL : flag to activate blowing snow sublimation
	\index{LSNOWSUBL!\innam{NAM\_BLOWSNOW}}
\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_BUDGET (budget box description)}
\label{ss:budget}
\index{NAM\_BUDGET!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
CBUTYPE   &  4 characters   & 'NONE'     \\
NBUMOD    & integer & 1        \\
XBULEN    & real    & 43200.   \\
NBUKL     & integer & 1        \\
NBUKH     & integer & 0        \\
LBU\_KCP  & logical & TRUE     \\
XBUWRI    & real    & 43200.   \\
NBUIL     & integer & 1        \\
NBUIH     & integer & 0        \\
NBUJL     & integer & 1        \\
NBUJH     & integer & 0        \\
LBU\_ICP  & logical & TRUE     \\
LBU\_JCP  & logical & TRUE     \\
NBU\_MASK & integer & 1 \\
\hline
\end{tabular}
\end{center}

It contains the description of the box in which the budget are performed. 


\begin{itemize}

\item
\index{CBUTYPE!\innam{NAM\_BUDGET}}
CBUTYPE: type of box used to compute the budget:
\begin{itemize}
\item
'CART' a cartesian box defined by the lowest and highest values of the indices
 in the 3 directions in the MESONH grid, defined in the following.
\item
'MASK' several areas, described by horizontal masks, are selected according to
 criteria evaluated at each model timestep. 
The budget computations are realized at the selected verticals for each
criteria. The criteria must be defined in the routine {\it set\_mask.f90}
\end{itemize}

\item
NBUMOD: \index{NBUMOD!\innam{NAM\_BUDGET}} number of the model in which the
budget are performed. Only one model must be selected even if the grid-nesting
is active.

\item
NBUMASK: \index{NBUMASK!\innam{NAM\_BUDGET}}
Number of masks used to select the budgets' areas, in the case CBUTYPE= 'MASK'. 

\item
XBULEN: \index{XBULEN!\innam{NAM\_BUDGET}}
Timestep  in seconds, on which the different source terms of all the
budget are temporally averaged.

\item
XBUWRI: \index{XBUWRI!\innam{NAM\_BUDGET}}
Duration in seconds, between successive writings in the diachronic file
of the budget storage arrays.

\item
\index{NBUKL!\innam{NAM\_BUDGET}}
NBUKL: value of the model level K for the bottom of the budget box in physical domain, in the case
of a cartesian box (CBUTYPE='CART') (NBUKL=1 corresponds to the first vertical physical level).

\item
\index{NBUKH!\innam{NAM\_BUDGET}}
NBUKH: Same as NBUKL but for the top of the budget box in physical domain. Inside the budget box:
$$ NBUKL \leq K \leq NBUKH $$

\item
\index{NBUJL!\innam{NAM\_BUDGET}}
NBUJL: value of the model level J for the left side of the budget box, in the case
of a cartesian box (CBUTYPE='CART') in physical domain.

\item
\index{NBUJH!\innam{NAM\_BUDGET}}
NBUJH: Same as NBUJL but for the right side of the budget box in physical domain.
 Inside the budget box:
$$ NBUJL \leq J \leq NBUJH $$

\item
\index{NBUIL!\innam{NAM\_BUDGET}}
NBUIL: value of the model level I for the left side of the budget box in physical domain, in the case
of a cartesian box (CBUTYPE='CART').

\item
\index{NBUIH!\innam{NAM\_BUDGET}}
NBUIH: Same as NBUIL but for the right side of the budget box in physical domain. Inside the budget box:
$$ NBUIL \leq J \leq NBUIH $$

\item
\index{LBU\_KCP!\innam{NAM\_BUDGET}}
LBU\_KCP: Flag to average or not in the K direction all the budget
terms, for any CBUTYPE value.

\item
\index{LBU\_JCP!\innam{NAM\_BUDGET}}
LBU\_JCP: Flag to average or not in the J direction all the budget
terms, for CBUTYPE='CART'.


\item
\index{LBU\_ICP!\innam{NAM\_BUDGET}}
LBU\_ICP: Flag to average or not in the I direction all the budget
terms, for CBUTYPE='CART'.

\end{itemize}

The description of the budgets for every prognostic variable is given below. Because all the budgets are performed in the same way, 
 we give here some details on the way to select or cumulate the different 
source terms.

Firstly, there is a flag to activate or not the budget of a given prognostic
variable. It should be noted that the budget terms for the variable $\Psi$ 
have the dimension of  
$$ {\partial \left[ \tilde{ \rho} \Psi \right] \over \partial t }$$   
Then, all the source terms computed in the model for this prognostic variable
can be selected according to the following rules:
\begin{itemize}
\item
NSOURCE\_TERM= 0 if you do not want to take into account  this source term( if you are only interested in some terms of a budget and not to the
whole budget).
\item
NSOURCE\_TERM= 1 if you select this source term as the first element of a
set of source terms, which will be  accumulated.
\item
NSOURCE\_TERM= 2 if you select this source term and it is not the first element of a
set of source terms, which are cumulated. Note that the source terms which come
just after the last of this set of source term, must be discarded (NSOURCE\_TERM= 0)
or be the first element of a new cumul (NSOURCE\_TERM= 1).
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Namelist NAM\_BU\_RRC (budget for cloud water)}
\index{NAM\_BU\_RRC!namelist description}

\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline \hline
LBU\_RRC & budget flag & logical & FALSE\index{LBU\_RRC!\innam{NAM\_BU\_RRC}} \\\hline
NASSERC  & time filter (Asselin)   & integer  &  0 \index{NASSERC!\innam{NAM\_BU\_RRC}} \\\hline
NNESTRC (if NMODEL$>1$) & nesting           & integer  &  0 \index{NNESTRC!\innam{NAM\_BU\_RRC}} \\\hline
NADVRC   & total advection   & integer  &  0 \index{NADVRC!\innam{NAM\_BU\_RTH}}\\\hline
NFRCRC   & forcing           & integer  &  0 \index{NFRCRC!\innam{NAM\_BU\_RRC}} \\
(if LFORCING=T) &  &   &   \\\hline
NDIFRC   & numerical diffusion & integer  &  0 \index{NDIFRC!\innam{NAM\_BU\_RRC}}\\
(if LNUMDIFTH=T) &  &   &   \\\hline
NRELRC   & relaxation        & integer  &  0 \index{NRELRC!\innam{NAM\_BU\_RRC}}\\
(if LHORELAX\_RC=T or LVE\_RELAX=T) &  &   &   \\\hline
%\end{tabular}
%\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
%\hline
NDCONVRC & KAFR convection   & integer  &  0 \index{NDCONVRC!\innam{NAM\_BU\_RRC}} \\
(if CDCONV='KAFR' or CSCONV='KAFR') &  &   &   \\\hline
NHTURBRC & horizontam turbulent  & integer  &  0 \index{NHTURBRC!\innam{NAM\_BU\_RRC}}\\
(if CTURB='TKEL' and CTURBDIM='3DIM') &diffusion &   &  \\\hline
NVTURBRC & vertical turbulent  & integer  &  0 \index{NVTURBRC!\innam{NAM\_BU\_RRC}}\\
(if CTURB='TKEL') &diffusion &   &  \\\hline
NNEGARC   & negative correction & integer  &  0 \index{NREVARC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD $\neq$ 'NONE') & &   &  \\\hline
NACCRRC  & accretion & integer  &  0 \index{NACCRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD$ \neq$ 'NONE' or 'REVE') & &   &  \\\hline
NAUTORC  & autoconversion into rain & integer  &  0 \index{NAUTORC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD$ \neq$ 'NONE' or 'REVE') & &   &  \\\hline
NSEDIRC  & sedimentation of cloud   & integer  &  0 \index{NSEDIRC!\innam{NAM\_BU\_RRC}}\\
(if (CCLOUD='C2R2' or 'KHKO' and LSEDC=T) or if (CCLOUD='ICEx' and LSEDIC=T )) &  &   &   \\\hline
NDEPORC  & surface droplet deposition   & integer  &  0 \index{NDEPORC!\innam{NAM\_BU\_RRC}}\\
(if (CCLOUD='C2R2' or 'KHKO' and LDEPOC=T) or if (CCLOUD='ICEx' and LDEPOSC=T )) &  &   &   \\\hline
NDEPOTRRC  & tree droplet deposition   & integer  &  0 \index{NDEPOTRRC!\innam{NAM\_BU\_RRC}}\\
(if ( LDRAGTREE and LDEPOTREE) ) &  &   &   \\\hline
\end{tabular}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
NCONDRC  &vapor condensation or & integer  &  0 \index{NCONDRC!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD $\neq$ 'NONE' and 'ICEx') &cloud water evaporation &   &  \\\hline
NHONRC   & homogeneous   & integer  &  0 \index{NHONRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='ICEx') &nucleation &   &  \\\hline
NRIMRC   & riming of cloud water   & integer  &  0 \index{NRIMRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NWETGRC   & wet growth of graupel  & integer  &  0 \index{NWETGRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NDRYGRC   & dry growth of graupel & integer  &  0 \index{NDRYGRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
%\end{tabular}
%\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
%\hline
NIMLTRC   & ice melting & integer  &  0 \index{NIMLTRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NBERFIRC  & Bergeron-Findeisen gth. & integer  &  0 \index{NBERFIRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NCDEPIRC  & condensation/deposition & integer  &  0 \index{NDEPIRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='ICEx') &on ice &   &  \\\hline
NHENURC  & CCN activation  & integer  &  0 \index{NHENURC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='C2R2' or 'KHKO') & &   &  \\\hline
NSEDIRC  & sedimentation & integer  &  0 \index{NHENURC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='C2R2' or 'KHKO') & &   &  \\\hline
NWETHRC  & wet growth of hail & integer  &  0 \index{NWETHRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='ICE4') & &   &  \\\hline
NNETURRC  &negative correction   & integer  &  0 \index{NNETURRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='C2R2' or 'KHKO') & induced by the turbulence&   &  \\\hline
NNEADVRC  & negative correction  & integer  &  0 \index{NNEADVRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='C2R2' or 'KHKO') & induced by the advection&   &  \\\hline
NNECONRC  &negative correction    & integer  &  0 \index{NNECONRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='C2R2' or 'KHKO') &induced by the condensation &   &  \\\hline
NHINCRC  & Heterogeneous  & integer  &  0 \index{NHINCRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='LIMA') &Nucleation by Contact &   &  \\\hline
NHONCRC  & droplet homogeneous   & integer  &  0 \index{NHONCRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='LIMA') & nucleation&   &  \\\hline
NCEDSRC  & adjustment  & integer  &  0 \index{NCEDSRC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='LIMA') & &   &  \\\hline
NREVARC  & evaporation   & integer  &  0 \index{NREVARC!\innam{NAM\_BU\_RRC}}\\
(if CCLOUD='LIMA') & of rain drops &   &  \\\hline
\hline
\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\subsection{Namelist NAM\_BU\_RRI (budget for non-precipitating ice)}
\index{NAM\_BU\_RRI!namelist description}

\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline\hline
LBU\_RRI & budget flag & logical & FALSE\index{LBU\_RRI!\innam{NAM\_BU\_RRI}} \\\hline
NASSERI  & time filter (Asselin)   & integer  &  0 \index{NASSERI!\innam{NAM\_BU\_RRI}} \\\hline
NNESTRI (if NMODEL$>1$) & nesting           & integer  &  0 \index{NNESTRI!\innam{NAM\_BU\_RRI}} \\\hline
NADVRI   & total advection   & integer  &  0 \index{NADVRI!\innam{NAM\_BU\_RTH}}\\\hline
NFRCRI   & forcing           & integer  &  0 \index{NFRCRI!\innam{NAM\_BU\_RRI}} \\
(if LFORCING=T) &  &   &   \\\hline
NDIFRI   & numerical diffusion & integer  &  0 \index{NDIFRI!\innam{NAM\_BU\_RRI}} \\
(if LNUMDIFTH=T) &  &   &   \\\hline
NRELRI   & relaxation        & integer  &  0 \index{NRELRI!\innam{NAM\_BU\_RRI}}\\
(if LHORELAX\_RI=T or LVE\_RELAX=T) &  &   &   \\\hline
NDCONVRI & KAFR convection   & integer  &  0 \index{NDCONVRI!\innam{NAM\_BU\_RRI}} \\
(if CDCONV='KAFR' or CSCONV='KAFR') &  &   &   \\\hline
NHTURBRI & horizontal turbulent  & integer  &  0 \index{NHTURBRI!\innam{NAM\_BU\_RRI}}\\
(if CTURB='TKEL' and CTURBDIM='3DIM') &diffusion &   &  \\\hline
NVTURBRI & vertical turbulent  & integer  &  0 \index{NVTURBRI!\innam{NAM\_BU\_RRI}}\\
(if CTURB='TKEL') &diffusion &   &  \\\hline
NNEGARI  & negative correction & integer  &  0 \index{NNEGARI!\innam{NAM\_BU\_RRI}}\\\hline
NSEDIRI  & sedimentation  & integer  &  0 \index{NSEDIRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NHENURI  & heterogenous   & integer  &  0 \index{NHENURI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') &nucleation &   &  \\\hline
NHONRI  & homogeneous   & integer  &  0 \index{NHONRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') &nucleation &   &  \\\hline
NAGGSRI & aggregation of snow & integer  &  0 \index{NAGGSRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NAUTSRI & autoconversion of ice & integer  &  0 \index{NAUTSRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NCFRZRI &   conversion freezing  & integer  &  0 \index{NCFRZRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NWETGRI &   wet growth of graupel & integer  &  0 \index{NWETGRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NDRYGRI &   dry growth of graupel & integer  &  0 \index{NDRYGRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
\end{tabular}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
NIMLTRI &   ice melting & integer  &  0 \index{NIMLRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NBERFIRI&   Bergeron-Findeisen gth. & integer  &  0 \index{NBERFIRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NCDEPIRI&   condensation/deposition & integer  &  0 \index{NCDEPIRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICEx') &  on ice&   &  \\\hline
NWETHRI &   wet growth  & integer  &  0 \index{NWETHRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='ICE4') &of hail &   &  \\\hline
NHINDRI &  heterogeneous     & integer  &  0 \index{NHINDRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='LIMA') &nucleation by deposition &   &  \\\hline
NHINCRI & heterogeneous     & integer  &  0 \index{NHINCRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='LIMA') &nucleation by contact &   &  \\\hline
NHONHRI & haze homogeneous     & integer  &  0 \index{NHONHRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='LIMA') &  nucleation source&   &  \\\hline
NHONCRI & droplet homogeneous     & integer  &  0 \index{NHONCRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='LIMA') &nucleation &   &  \\\hline
NCNVIRI & Conversion of snow     & integer  &  0 \index{NCNVIRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='LIMA') &to r\_i &   &  \\\hline
NCNVSRI &  Conversion of pristine    & integer  &  0 \index{NCNVSRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='LIMA') &ice to r\_s &   &  \\\hline
NHMSRI &Hallett-Mossop ice multiplication process      & integer  &  0 \index{NHMSRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='LIMA') &due to snow riming &   &  \\\hline
NHMGRI &  Hallett-Mossop ice multiplication process due     & integer  &  0 \index{NHMGRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='LIMA') &to graupel riming &   &  \\\hline
NCEDSRI & adjustement    & integer  &  0 \index{NCEDSRI!\innam{NAM\_BU\_RRI}}\\
(if CCLOUD='LIMA') & &   &  \\\hline
\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_BU\_RRG (budget for graupel)}
\index{NAM\_BU\_RRG!namelist description}

\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline\hline
LBU\_RRG & budget flag & logical & FALSE\index{LBU\_RRG!\innam{NAM\_BU\_RRG}} \\\hline
NASSERG  & time filter (Asselin)   & integer  &  0 \index{NASSERG!\innam{NAM\_BU\_RRG}} \\\hline
NNESTRG  & nesting           & integer  &  0 \index{NNESTRG!\innam{NAM\_BU\_RRG}} \\\hline
NADVRG   & total advection   & integer  &  0 \index{NADVRG!\innam{NAM\_BU\_RRG}}\\\hline
NFRCRG   & forcing           & integer  &  0 \index{NFRCRG!\innam{NAM\_BU\_RRG}} \\
(if LFORCING=T) &  &   &   \\\hline
NDIFRG   & numerical diffusion & integer  &  0 \index{NDIFRG!\innam{NAM\_BU\_RRG}} \\
(if LNUMDIFTH=T) &  &   &   \\\hline
NRELRG   & relaxation        & integer  &  0 \index{NRELRG!\innam{NAM\_BU\_RRG}}\\
(if LHORELAX\_RG=T or LVE\_RELAX=T) &  &   &   \\\hline
NNEGARG  & negative correction & integer  &  0 \index{NNEGARG!\innam{NAM\_BU\_RRG}}\\\hline
NSEDIRG  & sedimentation     & integer  &  0 \index{NSEDIRG!\innam{NAM\_BU\_RRG}}\\\hline
NSFRRG  & spontaneous freezing & integer  &  0 \index{NSFRRG!\innam{NAM\_BU\_RRS}}\\\hline
NDEPGRG  & deposition on snow & integer  &  0 \index{NDEPGRG!\innam{NAM\_BU\_RRG}}\\\hline
NRIMRG   & riming of cloud water & integer  &  0 \index{NRIMRG!\innam{NAM\_BU\_RRG}}\\\hline
NCMELRG  & conversion melting  & integer  &  0 \index{NCMELRG!\innam{NAM\_BU\_RRG}}\\\hline
NCFRZRG  & conversion freezing & integer  &  0 \index{NCFRZRG!\innam{NAM\_BU\_RRG}}\\\hline
NWETGRG  & wet growth of graupel  & integer  &  0 \index{NWETGRG!\innam{NAM\_BU\_RRG}}\\\hline
NDRYGRG  & dry growth of graupel  & integer  &  0 \index{NDRYGRG!\innam{NAM\_BU\_RRG}}\\\hline
NGMLTRG  & graupel melting  & integer  &  0 \index{NGMLTRG!\innam{NAM\_BU\_RRG}}\\\hline
NWETHRG  & wet growth of hail & integer  &  0 \index{NWETHRG!\innam{NAM\_BU\_RRG}}\\\hline
NCOHGRG  & reconversion hail & integer  &  0 \index{NCOHGRG!\innam{NAM\_BU\_RRG}}\\
(if CCLOUD='ICE4') & to graupel  &   &  \\\hline
NACCRG  & accretion of graupel & integer  &  0 \index{NACCRG!\innam{NAM\_BU\_RRG}}\\\hline
NHONRRG  & drop homogeneous  & integer  &  0 \index{NHONRRG!\innam{NAM\_BU\_RRG}}\\
(if CCLOUD='LIMA') &nucleation  &   &  \\\hline
NHMGRG  & Hallett-Mossop ice  & integer  &  0 \index{NHMGRG!\innam{NAM\_BU\_RRG}}\\
(if CCLOUD='LIMA') & multiplication process due to graupel riming  &   &  \\\hline
\end{tabular}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\subsection{Namelist NAM\_BU\_RRH (budget for hail)}
\index{NAM\_BU\_RRH!namelist description}

\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline \hline
LBU\_RRH & budget flag & logical & FALSE\index{LBU\_RRH!\innam{NAM\_BU\_RRH}} \\\hline
NASSERH  & time filter (Asselin)   & integer  &  0 \index{NASSERH!\innam{NAM\_BU\_RRH}} \\\hline
NNESTRH  & nesting           & integer  &  0 \index{NNESTRH!\innam{NAM\_BU\_RRH}} \\\hline
NADVRH   & total advection   & integer  &  0 \index{NADVRH!\innam{NAM\_BU\_RTH}}\\\hline
NFRCRH   & forcing           & integer  &  0 \index{NFRCRH!\innam{NAM\_BU\_RRH}} \\
(if LFORCING=T) &  &   &   \\\hline
NDIFRH   & numerical diffusion & integer  &  0 \index{NDIFRH!\innam{NAM\_BU\_RRH}} \\
(if LNUMDIFTH=T) &  &   &   \\\hline
NRELRH   & relaxation        & integer  &  0 \index{NRELRH!\innam{NAM\_BU\_RRH}}\\
(if LHORELAX\_RH=T or LVE\_RELAX=T) &  &   &   \\\hline
NNEGARH  & negative correction & integer  &  0 \index{NNEGARH!\innam{NAM\_BU\_RRH}}\\\hline
NSEDIRH  & sedimentation    & integer  &  0 \index{NSEDIRH!\innam{NAM\_BU\_RRH}}\\\hline
NWETGRH  & wet growth of graupel  & integer  &  0 \index{NWETGRH!\innam{NAM\_BU\_RRH}}\\\hline
NWETHRH  & wet growth of hail  & integer  &  0 \index{NWETHRH!\innam{NAM\_BU\_RRH}}\\\hline
NHMLTRH  & hail melting  & integer  &  0 \index{NHMLTRH!\innam{NAM\_BU\_RRH}}\\\hline
NCOHGRH  & reconversion hail to graupel & integer  &  0 \index{NCOHGRH!\innam{NAM\_BU\_RRH}}\\\hline
\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\subsection{Namelist NAM\_BU\_RRR (budget for rain water)}
\index{NAM\_BU\_RRR!namelist description}

\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline \hline
LBU\_RRR & budget flag & logical & FALSE\index{LBU\_RRR!\innam{NAM\_BU\_RRR}} \\\hline
NASSERR  & time filter (Asselin)   & integer  &  0 \index{NASSERR!\innam{NAM\_BU\_RRR}} \\\hline
NNESTRR (if NMODEL$>1$) & nesting           & integer  &  0 \index{NNESTRR!\innam{NAM\_BU\_RRR}} \\\hline
NADVRR   & total advection   & integer  &  0 \index{NADVRR!\innam{NAM\_BU\_RRR}}\\\hline
NFRCRR   & forcing           & integer  &  0 \index{NFRCRR!\innam{NAM\_BU\_RRR}} \\
(if LFORCING=T) &  &   &   \\\hline
NDIFRR   & numerical diffusion & integer  &  0 \index{NDIFRR!\innam{NAM\_BU\_RRR}}\\
(if LNUMDIFTH=T) &  &   &   \\\hline
NRELRR   & relaxation        & integer  &  0 \index{NRELRR!\innam{NAM\_BU\_RRR}}\\
(if LHORELAX\_RR=T or LVE\_RELAX=T) &  &   &   \\\hline
NACCRRR  & accretion of rain droplets & integer  &  0 \index{NACCRRR!\innam{NAM\_BU\_RRR}}\\\hline
NAUTORR   & autoconversion into rain droplets& integer  &  0 \index{NAUTORR!\innam{NAM\_BU\_RRR}}\\\hline
NREVARR   & rain evaporation  & integer  &  0 \index{NREVARR!\innam{NAM\_BU\_RRR}}\\\hline
NSEDIRR   & sedimentation of rain droplets& integer  &  0 \index{NSEDIRR!\innam{NAM\_BU\_RRR}}\\\hline
NSFRRR   & spontaneous freezing & integer  &  0 \index{NSFRRR!\innam{NAM\_BU\_RRR}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NACCRR   & accretion of rain water & integer  &  0 \index{NACCRR!\innam{NAM\_BU\_RRR}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NCFRZRR  & conversion freezing & integer  &  0 \index{NCFRZRR!\innam{NAM\_BU\_RRR}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NWETGRR  & wet growth of graupel & integer  &  0 \index{NWETGRR!\innam{NAM\_BU\_RRR}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NDRYGRR  & dry growth of graupel & integer  &  0 \index{NDRYGRR!\innam{NAM\_BU\_RRR}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NGMLTRR  & graupel melting& integer  &  0 \index{NGMLTRR!\innam{NAM\_BU\_RRR}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NWETHRR  & wet growth of hail & integer  &  0 \index{NWETHRR!\innam{NAM\_BU\_RRR}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NHMLTRR  & melting of hail& integer  &  0 \index{NHMLTRR!\innam{NAM\_BU\_RRR}}\\
(if CCLOUD='ICE4') & &   &  \\\hline
NHONRRR  & drop homogeneous  & integer  &  0 \index{NHONRRR!\innam{NAM\_BU\_RRR}}\\
(if CCLOUD='LIMA') &nucleation &   &  \\\hline\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%
%\newpage
\subsection{Namelist NAM\_BU\_RRS (budget for snow)}
\index{NAM\_BU\_RRS!namelist description}

\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline\hline
LBU\_RRS & budget flag & logical & FALSE\index{LBU\_RRS!\innam{NAM\_BU\_RRS}} \\\hline
NASSERS  & time filter (Asselin)   & integer  &  0 \index{NASSERS!\innam{NAM\_BU\_RRS}} \\\hline
NNESTRS (if NMODEL$>1$) & nesting           & integer  &  0 \index{NNESTRS!\innam{NAM\_BU\_RRS}} \\\hline
NADVRS   & total advection   & integer  &  0 \index{NADVRS!\innam{NAM\_BU\_RTH}}\\\hline
NFRCRS   & forcing           & integer  &  0 \index{NFRCRS!\innam{NAM\_BU\_RRS}} \\
(if LFORCING=T) &  &   &   \\\hline
NDIFRS   & numerical diffusion & integer  &  0 \index{NDIFRS!\innam{NAM\_BU\_RRS}} \\
(if LNUMDIFTH=T) &  &   &   \\\hline
NRELRS   & relaxation        & integer  &  0 \index{NRELRS!\innam{NAM\_BU\_RRS}}\\
(if LHORELAX\_RS=T or LVE\_RELAX=T) &  &   &   \\\hline
NNEGARS  & negative correction & integer  &  0 \index{NNEGARS!\innam{NAM\_BU\_RRS}}\\\hline
NSEDIRS  & sedimentation & integer  &  0 \index{NSEDIRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NDEPSRS  & deposition on snow & integer  &  0 \index{NDEPSRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NAGGSRS  & aggregation of snow    & integer  &  0 \index{NAGGSRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NAUTSRS  & autoconversion of ice   & integer  &  0 \index{NAUTSRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NRIMRS   & riming of cloudwater    & integer  &  0 \index{NRIMRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NACCRS   & accretion of rainwater  & integer  &  0 \index{NACCRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NCMELRS  & conversion melting     & integer  &  0 \index{NCMELRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NWETGRS  & wet growth of graupel   & integer  &  0 \index{NWETGRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NDRYGRS  & dry growth of graupel   & integer  &  0 \index{NDRYGRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='ICEx') & &   &  \\\hline
NWETHRS  & wet growth of hail  & integer  &  0 \index{NWETHRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='ICE4') & &   &  \\\hline
NCNVIRS  &Conversion of    & integer  &  0 \index{NCNVIRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='LIMA') & snow to r\_i&   &  \\\hline
NCNVSRS  & Conversion of pristine  & integer  &  0 \index{NCNVSRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='LIMA') & ice to r\_s &   &  \\\hline
NHMSRS  &Hallett-Mossop ice  & integer  &  0 \index{NHMSRS!\innam{NAM\_BU\_RRS}}\\
(if CCLOUD='LIMA') & multiplication process due to snow riming &   &  \\\hline
\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%
%\newpage
\subsection{Namelist NAM\_BU\_RRV (budget for  vapor)}
\index{NAM\_BU\_RRV!namelist description}

\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline\hline
LBU\_RRV & budget flag & logical & FALSE\index{LBU\_RRV!\innam{NAM\_BU\_RRV}} \\\hline
NASSERV  & time filter (Asselin)   & integer  &  0 \index{NASSERV!\innam{NAM\_BU\_RRV}} \\\hline
NNESTRV (if NMODEL$>1$) & nesting           & integer  &  0 \index{NNESTRV!\innam{NAM\_BU\_RRV}} \\\hline
NADVRV   & total advection   & integer  &  0 \index{NADVRV!\innam{NAM\_BU\_RTH}}\\\hline
NFRCRV   & forcing           & integer  &  0 \index{NFRCRV!\innam{NAM\_BU\_RRV}} \\
(if LFORCING=T) &  &   &   \\\hline
N2DADVRV   &advective forcing           & integer  &  0 \index{N2DADVRV!\innam{NAM\_BU\_RRV}} \\
(if L2D\_ADV\_FRC=T) &  &   &   \\\hline
N2DRELRV   & relaxation forcing           & integer  &  0 \index{N2DRLERV!\innam{NAM\_BU\_RRV}} \\
(if L2D\_REL\_FRC=T) &  &   &   \\\hline
NNUDRV   & nudging           & integer  &  0 \index{NNUDRV!\innam{NAM\_BU\_RRV}} \\
(if LNUDGING=T) &  &   &   \\\hline
NDIFRV   & numerical diffusion & integer  &  0 \index{NDIFRV!\innam{NAM\_BU\_RRV}}\\
(if LNUMDIFTH=T) &  &   &   \\\hline
NRELRV   & relaxation        & integer  &  0 \index{NRELRV!\innam{NAM\_BU\_RRV}}\\
(if LHORELAX\_RV=T or LVE\_RELAX=T) &  &   &   \\\hline
NDCONVRV  & KAFR convection   & integer  &  0 \index{NDCONVRV!\innam{NAM\_BU\_RRV}}\\
(if CDCONV='KAFR' or CSCONV='KAFR') &  &   &   \\\hline
NMAFLRV (if CSCONV='EDKF') & Mass flux & integer  &  0 \index{NMAFLRV!\innam{NAM\_BU\_RRV}} \\\hline
NHTURBRV & horizontal turbulent & integer  &  0 \index{NHTURBRV!\innam{NAM\_BU\_RRV}}\\
(if CTURB='TKEL' and CTURBDIM='3DIM') &diffusion &   &  \\\hline
NVTURBRV & vertical turbulent& integer  &  0 \index{NVTURBRV!\innam{NAM\_BU\_RRV}}\\
(if CTURB='TKEL') &diffusion &   &  \\\hline
NNEGARV   & negative  & integer  &  0 \index{NREVARV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD $\neq$ 'NONE') & &   &  \\\hline
NREVARV   & rain evaporation & integer  &  0 \index{NREVARV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD$ \neq$ 'NONE' or 'REVE') & &   &  \\\hline
NCONDRV   & vapor condensation & integer  &  0 \index{NCONDRV!\innam{NAM\_BU\_RRV}}\\
          & or cloud water evaporation& &   \\\hline
NHENURV   & heterogenous nucleation & integer  &  0 \index{NHENURV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD='ICE3','ICE4','KHKO','C2R2') & &   &  \\\hline
NDEPSRV   & deposition on snow & integer  &  0 \index{NDEPSRV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NDEPGRV   & deposition on graupel & integer  &  0 \index{NDEPGRV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NCDEPIRV   & condensation/deposition & integer  &  0 \index{NCDEPIRV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD='ICE3' or 'ICE4' ) &on ice &   &  \\\hline
\end{tabular}
\end{center}
\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline\hline
NHINDRV   & Heterogeneous Nucleation by Deposition & integer  &  0 \index{NHINDRV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD='LIMA'  ) & &   &  \\\hline
NHONHRV   &Haze Homogeneous Nucleation  & integer  &  0 \index{NHONHRV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD='LIMA'  ) & &   &  \\\hline
NCEDSRV   & adjustement & integer  &  0 \index{NCEDSRV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD='LIMA'  ) & &   &  \\\hline
NNETURRV   & negative correction induced by turbulence & integer  &  0 \index{NNETURRV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD='C2R2' or 'KHKO'  ) & &   &  \\\hline
 NNECONRV  & negative correction induced by condensation & integer  &  0 \index{NNECONRV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD='C2R2' or 'KHKO'  ) & &   &  \\\hline
NNEADVRV&negative correction induced by advection  & integer  &  0 \index{NNEADVRV!\innam{NAM\_BU\_RRV}}\\
(if CCLOUD='C2R2' or 'KHKO'  ) & &   &  \\\hline
\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_BU\_RSV (budget for a Scalar Variable)}
\index{NAM\_BU\_RSV!namelist description}

\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|} 
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline\hline
LBU\_RSV & budget flag & logical & FALSE\index{LBU\_RSV!\innam{NAM\_BU\_RSV}}\\\hline
NASSESV  & time filter (Asselin)   & integer  &  0 \index{NASSESV!\innam{NAM\_BU\_RSV}} \\\hline
NNESTSV  & nesting       & integer  &  0 \index{NNESTSV!\innam{NAM\_BU\_RSV}} \\\hline
NADVSV   & total advection   & integer  &  0 \index{NADVSV!\innam{NAM\_BU\_RSV}}\\\hline
NFRCSV   & forcing           & integer  &  0 \index{NFRCSV!\innam{NAM\_BU\_RSV}} \\
(if LFORCING=T) &  &   &   \\\hline
NDIFSV   & numerical diffusion & integer &  0 \index{NDIFSV!\innam{NAM\_BU\_RSV}}\\
(if LNUMDIFSV=T) &  &   &   \\\hline
NRELSV   & relaxation        & integer  &  0 \index{NRELSV!\innam{NAM\_BU\_RSV}}\\
(if LHORELAX\_SV=T or LVE\_RELAX=T) &  &   &   \\\hline
NDCONVSV & KAFR convection   & integer  &  0 \index{NDCONVSV!\innam{NAM\_BU\_RSV}} \\
(if CDCONV='KAFR' or CSCONV='KAFR') &  &   &   \\\hline
NMAFLSV (if CSCONV='EDKF') & Mass flux & integer  &  0 \index{NMAFLSV!\innam{NAM\_BU\_RSV}} \\\hline
NHTURBSV & horizontal turbulent  & integer  &  0 \index{NHTURBSV!\innam{NAM\_BU\_RSV}} \\
(if CTURB='TKEL' and CTURBDIM='3DIM') &diffusion &   &  \\\hline
NVTURBSV & vertical turbulent  & integer  &  0 \index{NVTURBSV!\innam{NAM\_BU\_RSV}}\\
(if CTURB='TKEL') &diffusion &   &  \\\hline
NCHEMSV & chemistry activity & integer  &  0 \index{NCHEMSV!\innam{NAM\_BU\_RSV}} \\
NDEPOSV  & surface droplet deposition   & integer  &  0 \index{NDEPOSV!\innam{NAM\_BU\_RRC}}\\
(if (CCLOUD='C2R2' or 'KHKO' and LDEPOC=T) ) &  &   &   \\\hline
NDEPOTRSV  & tree droplet deposition   & integer  &  0 \index{NDEPOTRSV!\innam{NAM\_BU\_RRC}}\\
(if (CCLOUD='C2R2' or 'KHKO') and ( LDRAGTREE and LDEPOTREE)  ) &  &   &   \\\hline
\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\subsection{Namelist NAM\_BU\_RTKE (budget for TKE)}
\index{NAM\_BU\_RTKE!namelist description}

\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline\hline
LBU\_RTKE & budget flag & logical & FALSE\index{LBU\_RTKE!\innam{NAM\_BU\_RTKE}} \\\hline
NASSETKE  & time filter (Asselin)   & integer  &  0 \index{NASSETKE!\innam{NAM\_BU\_RTKE}} \\\hline
NADVTKE   & total advection   & integer  &  0 \index{NADVTKE!\innam{NAM\_BU\_RTKE}}\\\hline
NFRCTKE   & forcing           & integer  &  0 \index{NFRCTKE!\innam{NAM\_BU\_RTKE}} \\
(if LFORCING=T) &  &   &   \\\hline
NDIFTKE   & numerical diffusion & integer  &  0 \index{NDIFTKE!\innam{NAM\_BU\_RTKE}}\\
(if LNUMDIFTH=T) &  &   &   \\\hline
NRELTKE   & relaxation        & integer  &  0 \index{NRELTKE!\innam{NAM\_BU\_RTKE}}\\
(if LHORELAX\_TKE=T or LVE\_RELAX=T) &  &   &   \\\hline
NDPTKE    & dynamic production & integer  &  0 \index{NDPTKE!\innam{NAM\_BU\_RTKE}}\\\hline
NTPTKE    & thermal production & integer  &  0 \index{NTPTKE!\innam{NAM\_BU\_RTKE}}\\\hline
NDISSTKE  & dissipation of TKE & integer  &  0 \index{NDISSTKE!\innam{NAM\_BU\_RTKE}}\\\hline
NTRTKE    & turbulent transport &  integer  &  0 \index{NTRTKE!\innam{NAM\_BU\_RTKE}} \\\hline
\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_BU\_RTH (budget for TH)}
\index{NAM\_BU\_RTH!namelist description}
\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
Fortran name & Meaning & Fortran type & default value \\
\hline\hline
LBU\_RTH & budget flag & logical & FALSE\index{LBU\_RTH!\innam{NAM\_BU\_RTH}} \\\hline
NASSETH  & time filter (Asselin)   & integer  &  0 \index{NASSETH!\innam{NAM\_BU\_RTH}} \\\hline
NNESTTH (if NMODEL$>1$) & nesting           & integer  &  0 \index{NNESTTH!\innam{NAM\_BU\_RTH}} \\\hline
NADVTH   & total advection   & integer  &  0 \index{NADVTH!\innam{NAM\_BU\_RTH}}\\\hline
NFRCTH (if LFORCING=T)   & forcing           & integer  &  0 \index{NFRCTH!\innam{NAM\_BU\_RTH}} \\\hline
N2DADVTH   &advective forcing           & integer  &  0 \index{N2DADVTH!\innam{NAM\_BU\_RTH}} \\
(if L2D\_ADV\_FRC=T) &  &   &   \\\hline
\end{tabular}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
N2DRELTH   & relaxation forcing           & integer  &  0 \index{N2DRLETH!\innam{NAM\_BU\_RTH}} \\
(if L2D\_REL\_FRC=T) &  &   &   \\\hline
NNUDTH (if LNUDGING=T)  & nudging           & integer  &  0 \index{NNUDTH!\innam{NAM\_BU\_RTH}} \\\hline
%\end{tabular}
%\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
%\hline
NPREFTH  & reference pressure term  & integer  &  0 \index{NPREFTH!\innam{NAM\_BU\_RTH}} \\ 
(if LHORELAX\_UVWTH=T or LVE\_RELAX=T) &  &   &   \\\hline
%\end{tabular}
%\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
%\hline
NDIFTH (if LNUMDIFTH=T)   & numerical diffusion & integer  &  0 \index{NDIFTH!\innam{NAM\_BU\_RTH}}\\\hline
NRELTH   & relaxation        & integer  &  0 \index{NRELTH!\innam{NAM\_BU\_RTH}}\\
(if LHORELAX\_UVWTH=T or LVE\_RELAX=T) &  &   &   \\\hline
NRADTH (if CRAD $\neq$ 'NONE')  & radiation           & integer  &  0 \index{NRADTH!\innam{NAM\_BU\_RTH}}\\\hline
NDCONVTH & KAFR convection          & integer  &  0 \index{NDCONVTH!\innam{NAM\_BU\_RTH}}\\
(if CDCONV='KAFR' ou CSCONV='KAFR') &  &   &   \\\hline
NMAFLTH (if CSCONV='EDKF') & Mass flux & integer  &  0 \index{NMAFLTH!\innam{NAM\_BU\_RTH}} \\\hline
NHTURBTH & horizontal turbulent & integer  &  0 \index{NHTURBTH!\innam{NAM\_BU\_RTH}}\\
(if CTURB='TKEL' and CTURBDIM='3DIM') & diffusion&   &  \\\hline
NVTURBTH (if CTURB='TKEL') & vertical turbulent diffusion & integer  &  0 \index{NVTURBTH!\innam{NAM\_BU\_RTH}}\\\hline
NDISSHTH (if CTURB='TKEL') & dissipation         & integer  &  0 \index{NDISSHTH!\innam{NAM\_BU\_RTH}}\\\hline
NNEGATH  (if CCLOUD $\neq$ 'NONE') & negative            & integer  &  0 \index{NNEGATH!\innam{NAM\_BU\_RTH}}\\\hline
NREVATH (if rain is activated)  & rain evaporation    & integer  &  0 \index{NREVATH!\innam{NAM\_BU\_RTH}}\\\hline
NCONDTH (if CCLOUD='C2R2'  & vapor condensation  or     & integer  &  0 \index{NCONDTH!\innam{NAM\_BU\_RTH}}\\
'KHKO','KESS' or 'REVE')& cloud water  evaporation  &          &    \\\hline
NHENUTH   & heterogeneous  & integer  &  0 \index{NHENUTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3','ICE4','KHKO','C2R2') &nucleation &   &  \\\hline
NHONTH   & homogeneous  & integer  &  0 \index{NHONTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & nucleation&   &  \\\hline
NSFRTH   & spontaneous freezing& integer  &  0 \index{NSFRTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NDEPSTH  & deposition of snow  & integer  &  0 \index{NDEPSTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NDEPGTH  & deposition of graupel & integer  &  0 \index{NDEPGTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NRIMTH   & riming of cloud     & integer  &  0 \index{NRIMTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NACCTH   & accretion of rain   & integer  &  0 \index{NACCTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NCFRZTH  & conversion freezing & integer  &  0 \index{NCFRZTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NWETGTH  & wet growth of graupel& integer  &  0 \index{NWETGTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NDRYGTH  & dry growth of graupel& integer  &  0 \index{NDRYGTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NGMLTTH  & graupel melting      & integer  &  0 \index{NGMLTTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NIMLTTH  & ice melting          & integer  &  0 \index{NIMLTTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
\end{tabular}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
NBERFITH  & bergeron-findeisen   & integer  &  0 \index{NBERFITH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & &   &  \\\hline
NCDEPITH  & condensation/deposition  & integer  &  0 \index{NCDEPITH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE3' or 'ICE4' ) & on ice   &  \\\hline
NWETHTH   & wet growth of hail   & integer  &  0 \index{NWETHTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE4')   &  &        &   \\\hline
NHMLTTH   & melting of hail      & integer  &  0 \index{NHMLTTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='ICE4')   &   &       &   \\\hline
 NNETURTH  &  negative correction induced by turbulence     & integer  &  0 \index{NNETURTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='KHKO' or 'C2R2')   &   &       &   \\\hline
 NNEADVTH  & negative correction induced by advection      & integer  &  0 \index{NNEADVTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='KHKO' or 'C2R2')   &   &       &   \\\hline
 NNECONTH  & negative correction induced by condensation      & integer  &  0 \index{NNECONTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='KHKO' or 'C2R2')   &   &       &   \\\hline
NHINDTH   & Heterogeneous Nucleation by Deposition      & integer  &  0 \index{NHINDTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='LIMA')   &   &       &   \\\hline
NHINCTH   & Heterogeneous Nucleation by Contact      & integer  &  0 \index{NHINCTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='LIMA')   &   &       &   \\\hline
NHONHTH   & Haze Homogeneous       & integer  &  0 \index{NHONHTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='LIMA')   &   Nucleation&       &   \\\hline
NHONCTH   &  droplet homogeneous      & integer  &  0 \index{NHONCTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='LIMA')   &nucleation   &       &   \\\hline
NHONRTH   & drop homogeneous       & integer  &  0 \index{NHONRTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='LIMA')   & nucleation  &       &   \\\hline
NCEDSTH   & adjustment      & integer  &  0 \index{NCEDSTH!\innam{NAM\_BU\_RTH}}\\
(if CCLOUD='LIMA')   &   &       &   \\\hline

\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_BU\_RU (budget for U)}
\index{NAM\_BU\_RU!namelist description}

\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
%Fortran name & Meaning & Fortran type & default value \\
%\hline\hline
LBU\_RU  & budget flag & logical & FALSE  \index{LBU\_RU!\innam{NAM\_BU\_RU}}\\\hline
NASSEU   & time filter (Asselin) & integer  &  0  \index{NASSEU!\innam{NAM\_BU\_RU}} \\\hline
NNESTU (if NMODEL$>1$)   & nesting           & integer  &  0 \index{NNESTU!\innam{NAM\_BU\_RU}} \\\hline
NADVU   & advection  & integer  &  0 \index{NADVU!\innam{NAM\_BU\_RU}} \\\hline
NFRCU (if LFORCING=T)   & forcing           & integer  &  0 \index{NFRCU!\innam{NAM\_BU\_RU}} \\\hline
NNUDU  (if LNUDGING=T)  & nudging           & integer  &  0 \index{NNUDU!\innam{NAM\_BU\_RU}} \\\hline
NCURVU (if LCARTESIAN=F) & curvature terms   & integer  &  0 \index{NCURVU!\innam{NAM\_BU\_RU}} \\\hline
NCORU (if LCORIO=T ) & Coriolis  term    & integer  &  0 \index{NCORU!\innam{NAM\_BU\_RU}}\\\hline
NDIFU (if LNUMDIFU=T) & numerical diffusion & integer  &  0 \index{NDIFU!\innam{NAM\_BU\_RU}} \\\hline
NRELU (if LHORELAX\_UVWTH=T & relaxation  & integer  &  0 \index{NRELU!\innam{NAM\_BU\_RU}} \\
 or LVE\_RELAX=T) &  &   &   \\\hline
NVTURBU (if CTURB='TKEL' ) & vertical turbulent diffusion & integer  &  0 \index{NVTURBU!\innam{NAM\_BU\_RU}}\\\hline
NHTURBU & horizontal turbulent  & integer  &  0 \index{NHTURBU!\innam{NAM\_BU\_RU}}\\
(if CTURB='TKEL' and CTURBDIM='3DIM') &diffusion &   &  \\\hline
NPRESU   & pressure term       & integer  &  0    \index{NPRESU!\innam{NAM\_BU\_RU}} \\\hline
NMAFLU (if CSCONV='EDKF')  & mass flux        & integer  &  0 \index{NMAFLU!\innam{NAM\_BU\_RU}}\\
\hline
\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_BU\_RV (budget for V)}
\index{NAM\_BU\_RV!namelist description}
\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
%Fortran name & Meaning & Fortran type & default value \\
%\hline\hline
LBU\_RV  & budget flag & logical & FALSE \index{LBU\_RV!\innam{NAM\_BU\_RV}}\\\hline
NASSEV   & time filter (Asselin)   & integer  &  0 \index{NASSEV!\innam{NAM\_BU\_RV}} \\\hline
NNESTV (if NMODEL$>1$)  & nesting           & integer  &  0 \index{NNESTV!\innam{NAM\_BU\_RV}} \\\hline
NADVV   & advection  & integer  &  0  \index{NADVV!\innam{NAM\_BU\_RV}}\\\hline
NFRCV (if LFORCING=T)  & forcing           & integer  &  0 \index{NFRCV!\innam{NAM\_BU\_RV}} \\\hline
NNUDV (if LNUDGING=T)   & nudging           & integer  &  0 \index{NNUDV!\innam{NAM\_BU\_RV}} \\\hline
NCURVV (if LCARTESIAN=F)  & curvature terms   & integer  &  0 \index{NCURVV!\innam{NAM\_BU\_RV}}\\\hline
NCORV (if LCORIO=T )   & Coriolis  term    & integer  &  0 \index{NCORV!\innam{NAM\_BU\_RV}}\\\hline
NDIFV (if LNUMDIFU=T)   & numerical diffusion & integer  &  0 \index{NDIFV!\innam{NAM\_BU\_RV}}\\\hline
NRELV  (if LHORELAX\_UVWTH=T  & relaxation & integer  &  0 \index{NRELV!\innam{NAM\_BU\_RV}}\\
or LVE\_RELAX=T) &  &   &   \\\hline
NHTURBV  & horizontal turbulent & integer  &  0 \index{NHTURBV!\innam{NAM\_BU\_RV}}\\
(if CTURB='TKEL' and CTURBDIM='3DIM') &diffusion &   &  \\\hline
NVTURBV (if CTURB='TKEL' ) & vertical turbulent diffusion & integer  &  0 \index{NVTURBV!\innam{NAM\_BU\_RV}}\\\hline
NPRESV   & pressure term       & integer  &  0 \index{NPRESV!\innam{NAM\_BU\_RV}}    \\\hline
NMAFLV (if CSCONV='EDKF')   & mass flux        & integer  &  0 \index{NMAFLV!\innam{NAM\_BU\_RV}}\\
\hline
\end{tabular}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_BU\_RW (budget for W)}
\index{NAM\_BU\_RW!namelist description}


\begin{center}
\begin{tabular} {|p{8cm}|p{4cm}|>{\centering}p{1.5cm}|p{1.5cm}<{\centering}|}
\hline
%Fortran name & Meaning & Fortran type & default value \\
%\hline\hline
LBU\_RW  & budget flag & logical & FALSE\index{LBU\_RW!\innam{NAM\_BU\_RW}} \\\hline
NASSEW   & time filter (Asselin)   & integer  &  0 \index{NASSEW!\innam{NAM\_BU\_RW}} \\\hline
NNESTW (if NMODEL$>1$) & nesting           & integer  &  0 \index{NNESTW!\innam{NAM\_BU\_RW}} \\\hline
NADVW   & advection & integer  &  0 \index{NADVW!\innam{NAM\_BU\_RW}}\\\hline
NFRCW (if LFORCING=T)   & forcing           & integer  &  0 \index{NFRCW!\innam{NAM\_BU\_RW}} \\\hline
NNUDW (if LNUDGING=T)   & nudging           & integer  &  0 \index{NNUDW!\innam{NAM\_BU\_RW}} \\\hline
NCURVW (if LCARTESIAN=F)  & curvature terms   & integer  &  0 \index{NCURVW!\innam{NAM\_BU\_RW}}\\\hline
NCORW (if LCORIO=T )   & Coriolis  term    & integer  &  0 \index{NCORW!\innam{NAM\_BU\_RW}}\\\hline
NGRAVW   & gravity  term     & integer  &  0 \index{NGRAVW!\innam{NAM\_BU\_RW}}\\\hline
NDIFW (if LNUMDIFU=T)   & numerical diffusion & integer  &  0 \index{NDIFW!\innam{NAM\_BU\_RW}}\\\hline
NRELW    & relaxation        & integer  &  0 \index{NRELW!\innam{NAM\_BU\_RW}}\\
(if LHORELAX\_UVWTH=T or LVE\_RELAX=T) &  &   &   \\\hline
NHTURBW  & horizontal turbulent & integer  &  0 \index{NHTURBW!\innam{NAM\_BU\_RW}}\\
(if CTURB='TKEL' and CTURBDIM='3DIM') &diffusion &   &  \\\hline
NVTURBW (if CTURB='TKEL' )  & vertical turbulent diffusion & integer  &  0 \index{NVTURBW!\innam{NAM\_BU\_RW}}\\\hline
NPRESW   & pressure term       & integer  &  0 \index{NPRESW!\innam{NAM\_BU\_RW}}  \\
\hline
\end{tabular}
\end{center}
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_CH\_MNHCn (control of MNHC)}
\label{ss:chem}
\index{NAM\_CH\_MNHCn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LUSECHEM                & logical       & FALSE      \\
LUSECHAQ 		&logical 	&FALSE\\
LUSECHIC 		&logical 	&FALSE\\
LCH\_INIT\_FIELD 		&logical 	&FALSE\\
LCH\_CONV\_SCAV 		&logical 	&FALSE\\
LCH\_CONV\_LINOX 		&logical 	&FALSE\\
LCH\_PH			&logical	&FALSE\\
LCH\_RET\_ICE		&logical	&FLASE\\
XCH\_PHINIT		&real		&5.2\\
XRTMIN\_AQ		&real		&5.e-8\\
CCHEM\_INPUT\_FILE 	&80 characters 	&'EXSEG1.nam'\\
CCH\_TDISCRETIZATION 	&10 characters 	&'SPLIT'\\
NCH\_SUBSTEPS 		&integer 	&1\\
LCH\_TUV\_ONLINE 		&logical 	&TRUE\\
CCH\_TUV\_LOOKUP 		&80 characters 	&'PHOTO.TUV39'\\
CCH\_TUV\_CLOUDS 		&4 characters 	&'NONE'\\
XCH\_TUV\_ALBNEW 		&real 		&-1.\\
XCH\_TUV\_DOBNEW 		&real 		&-1.\\
XCH\_TUV\_TUPDATE 	&real 		&600.\\
CCH\_VEC\_METHOD 		&3 characters 	&'MAX'\\
NCH\_VEC\_LENGTH 		&integer 	&1000\\
XCH\_TS1D\_TSTEP 		&real 		&600.\\
CCH\_TS1D\_COMMENT 	&80 characters 	&'no comment'\\
CCH\_TS1D\_FILENAME 	&80 characters 	&'IO1D'\\
\hline
\end{tabular}
\end{center}

\begin{itemize}

\index{LUSECHEM!\innam{NAM\_CH\_MNHCn}}
\item LUSECHEM: switch to activate chemistry.

\index{LUSECHAQ!\innam{NAM\_CH\_MNHCn}}
\item  LUSECHAQ: switch to activate aqueous phase chemistry.

\index{LUSECHIC!\innam{NAM\_CH\_MNHCn}}
\item  LUSECHIC: switch to activate ice phase chemistry. This means that several pronostics variables are added equal to the number of solubles gases. These variables represent the mixing ratio of the soluble gases inside the precipitating iced hydrometeors.

\index{LCH\_INIT\_FIELD!\innam{NAM\_CH\_MNHCn}}
\item  LCH\_INIT\_FIELD: switch to activate initialization subroutine CH\_INIT\_FIELD\_n. If .TRUE. initialized with ASCII file, if .FALSE. initialized with MOCAGE.

\index{LCH\_CONV\_SCAV!\innam{NAM\_CH\_MNHCn}}
\item  LCH\_CONV\_SCAV: switch to activate scavenging of chemical species (gazeous or aerosol) and dusts by convective precipitations.

\index{LCH\_CONV\_LINOX!\innam{NAM\_CH\_MNHCn}}
\item  LCH\_CONV\_LINOX: switch to activate the production of NOx by LIghtning flashes inside deep convective clouds and its transport (LCHTRANS must be set to TRUE).
\begin{itemize}
          \item  LUSECHEM=.F. : a scalar variable named LINOX are written in the LFI file
          \item  LUSECHEM=.T. : the convective source is added to the NO chemical variable.
\end{itemize}

\index{LCH\_PH!\innam{NAM\_CH\_MNHCn}}
\item  LCH\_PH: switch to activate the computing of pH in cloud water and rainwater as diagnostic variables. XPHC and XPHR are added in LFI output files.

\index{LCH\_RET\_ICE!\innam{NAM\_CH\_MNHCn}}
\item  LCH\_RET\_ICE: switch to activate the retention of solubles gase in iced hydrometeors without considering additional pronostics variables. LUSECHIC is set to FALSE. Be carefull this option leads to a loss of mass.

\index{XCH\_PHINIT!\innam{NAM\_CH\_MNHCn}}
\item  XCH\_PHINIT: pH value when aqueous phase chemistry is activated (LUSECHAQ is set to TRUE). 
\begin{itemize}
          \item  LCH\_PH=.T. : XCH\_PHINIT is the initial pH value,
          \item  LCH\_PH=.F. : XCH\_PHINIT is the constant pH value during the whole simulation.
\end{itemize}

\index{XRTMIN\_AQ!\innam{NAM\_CH\_MNHCn}}
\item  XRTMIN\_AQ: when aqueous phase chemistry is activated (LUSECHAQ is set to TRUE), XRTMIN\_AQ is the threshold value for cloud water (or rainwater) content from which aqueous phase chemistry and exchange between gas and liquid phases are computed.

\index{CCHEM\_INPUT\_FILE!\innam{NAM\_CH\_MNHCn}}
\item  CCHEM\_INPUT\_FILE: name of the general purpose input file.

\index{CCH\_TDISCRETIZATION!\innam{NAM\_CH\_MNHCn}}
\item  CCH\_TDISCRETIZATION: temporal discretization
\begin{itemize}
           \item CCH\_TDISCRETIZATION='SPLIT': use time-splitting, input fields for solver are scalar variables at t+dt (derived from XRSVS)
           \item CCH\_TDISCRETIZATION='CENTER': use centered tendencies, input fields for solver are scalar variables at t (XSVT)
           \item CCH \_TDISCRETIZATION='LAGGED': use lagged tendencies, input fields for solver are scalar variables at t-dt (XSVM)
\end{itemize}

\index{NCH\_SUBSTEPS!\innam{NAM\_CH\_MNHCn}}
\item  NCH\_SUBSTEPS: number of steps to be taken by the solver during two time steps of MesoNH; the time step of the solver is thus equal to 2*XTSTEP/NCH\_SUBSTEPS

\index{LCH\_TUV\_ONLINE!\innam{NAM\_CH\_MNHCn}}
\item  LCH\_TUV\_ONLINE: switch to activate online photolysis rates calculations (only for 1D simulation). If false, photolysis rates are pre-calculated as a function of solar zenith angle and surface albedo and interpolated on the model grid.

\index{CCH\_TUV\_LOOKUP!\innam{NAM\_CH\_MNHCn}}
\item  CCH\_TUV\_LOOKUP: name of the lookup table file.

\index{CCH\_TUV\_CLOUDS!\innam{NAM\_CH\_MNHCn}}
\item  CCH\_TUV\_CLOUDS: method for calculating the impact of clouds on UV radiations (only for 3-D version)
\begin{itemize}

           \item CCH\_TUV\_CLOUDS='NONE' : No cloud correction on UV radiations
           \item CCH\_TUV\_CLOUDS='CHAN' : Cloud correction on UV radiations following Chang et al., [1987]
\end{itemize}

\index{XCH\_TUV\_ALBNEW!\innam{NAM\_CH\_MNHCn}}
\item  XCH\_TUV\_ALBNEW: surface albedo for photolysis rates calculations (only for 1-D version. For 3-D version, albedos are prescribed as a function of the surface characteristics).

\index{XCH\_TUV\_DOBNEW!\innam{NAM\_CH\_MNHCn}}
\item  XCH\_TUV\_DOBNEW: scaling factor for ozone column dobson.

\index{XCH\_TUV\_TUPDATE!\innam{NAM\_CH\_MNHCn}}
\item  XCH\_TUV\_TUPDATE: update frequency to refresh photolysis rates.

\index{CCH\_VEC\_METHOD!\innam{NAM\_CH\_MNHCn}}
\item  CCH\_VEC\_METHOD: type of vectorization mask
\begin{itemize}
          \item 'MAX' take NCH\_VEC\_LENGTH points
          \item 'TOT' take all grid points
          \item 'HOR' take horizontal layers
          \item 'VER' take vertical columns
\end{itemize}

\index{NCH\_VEC\_LENGTH!\innam{NAM\_CH\_MNHCn}}
\item  NCH\_VEC\_LENGTH: number of points for 'MAX' option.

\index{XCH\_TS1D\_TSTEP!\innam{NAM\_CH\_MNHCn}}
 \item  XCH\_TS1D\_TSTEP: time between two call to write\_ts1d.

\index{CCH\_TS1D\_COMMENT!\innam{NAM\_CH\_MNHCn}}
\item  CCH\_TS1D\_COMMENT: comment for write\_ts1d.

\index{CCH\_TS1D\_FILENAM!\innam{NAM\_CH\_MNHCn}}
\item  CCH\_TS1D\_FILENAME: filename for write\_ts1d files.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Namelist NAM\_CH\_ORILAM }
\index{NAM\_CH\_ORILAM!namelist description}
 
This namelist is used to activate ORILAM chemical aerosols (lognormal distribution for Aitken and accumulation mode).
This parameterization include coagulation (intra and inter modal), nucleation,  sedimentation, condensation/adsorption of gas phase.
 This parameterization need to be run together with gas chemical phase (namelist NAM\_CH\_MNHCn). 
For correct representation, it is recommended to have severals compounds as HNO3 (nitric acid), H2SO4 (or SULF; sulphates), NH3 (ammonium) and CO (carbon monoxyde) in the chemical scheme. 

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LORILAM     & logical  & FALSE  \\
LVARSIGI    & logical  & FALSE  \\
LVARSIGJ    & logical  & FALSE  \\
LSEDIMAERO  & logical  & FALSE  \\
%LAERINIT    & logical  & FALSE  \\
XINIRADIUSI & real     & 0.01  \\
XINIRADIUSJ & real     & 0.5  \\
CRGUNIT     & character (len=4)  & 'MASS'   \\
XINISIGI    & real     & 1.60  \\
XINISIGJ    & real     & 1.60  \\
XN0IMIN     & real     &  10.  \\
XN0JMIN     & real     &  1.   \\
XCOEFRADIMAX& real     &  10.  \\
XCOEFRADJMAX& real     &  10.  \\
XCOEFRADIMIN& real     &  .1  \\
XCOEFRADJMIN& real     &  .1  \\
CMINERAL    & character (len=5)  & 'NONE'   \\
CORGANIC    & character (len=5)  & 'NONE'   \\
CNUCLEATION & character (len=80) & 'NONE'   \\
\hline
\end{tabular}
\end{center}

\begin{itemize}

\index{LORILAM!\innam{NAM\_CH\_ORILAM}}
\item LORILAM: flag to activate chemical aerosol (only if LUSECHEM = .TRUE.).
\index{LVARSIGI!\innam{NAM\_CH\_ORILAM}}
\item LVARSIGI: flag to activate variable standard deviation for mode I (Aitken).
\index{LVARSIGJ!\innam{NAM\_CH\_ORILAM}}
\item LVARSIGJ: flag to activate variable standard deviation for mode J (accumulation).
\index{LSEDIMAERO!\innam{NAM\_CH\_ORILAM}}
\item LSEDIMAERO: flag to activate aerosol sedimentation.
%\index{LAERINIT!\innam{NAM\_CH\_ORILAM}}
%\item LAERINIT: flag to initialize aerosols in AROME.
\index{XINIRADIUSI!\innam{NAM\_CH\_ORILAM}}
\item  XINIRADIUSI: flag for  the initialization of mean radius mode I (Aitken mode) of the distribution (in micrometers). 
\index{XINIRADIUSJ!\innam{NAM\_CH\_ORILAM}}
\item  XINIRADIUSJ: flag for the initialization of mean radius mode J (accumulation mode) of the distribution (in micrometers). 
\index{CRGUNIT!\innam{NAM\_CH\_ORILAM}}
\item  CRGUNIT: type of mean radius given in namelist. Default is for a mass spectral distribution; XINIRADIUSI and XINIRADIUSJ have been converted into a  mean radius in number. \\ 
 IF CRGUNIT $\neq$ 'MASS' then the mean radius need to be given for a number spectral distribution (no conversion).  
\index{XINISIGI!\innam{NAM\_CH\_ORILAM}}
\item  XINISIGI: value of standard deviation for mode I (Aitken mode).  
\index{XINISIGJ!\innam{NAM\_CH\_ORILAM}}
\item  XINISIGJ: value of standard deviation for mode J (accumulation mode).  

\index{XCOEFRADIMAX!\innam{NAM\_CH\_ORILAM}}
\item  XCOEFRADIMAX: factor to compute maximum value of mean radius mode I (Aitken mode). $R_i^{max} =  XCOEFRADIMAX . XINIRADIUSI $ 

\index{XCOEFRADJMAX!\innam{NAM\_CH\_ORILAM}}
\item  XCOEFRADJMAX: factor to compute maximum value of mean radius mode J (accumulation mode). $R_j^{max} =  XCOEFRADJMAX . XINIRADIUSJ $ 
\index{XCOEFRADIMIN!\innam{NAM\_CH\_ORILAM}}
\item  XCOEFRADIMIN: same as XCOEFRADIMAX but for the minimum value.

\index{XCOEFRADJMIN!\innam{NAM\_CH\_ORILAM}}
\item  XCOEFRADJMIN: same as XCOEFRADIMAX but for the minimum value.\index{CMINERAL!\innam{NAM\_CH\_ORILAM}}
\item  CMINERAL: type of parameterization for mineral gas/particle balance. Possible values are:\\
CMINERAL = 'ARES' : ARES parameterization (non vectorized) \\
CMINERAL = 'NARES': neuronal network of ARES (vectorized) \\
CMINERAL = 'ISPIA': ISORROPIA parameterization (non vectorized) \\
CMINERAL = 'TABUL': tabulation of ISORROPIA  (vectorized) \\
CMINERAL = 'EQSAM': EQSAM parameterization (vectorized) 

\index{CORGANIC!\innam{NAM\_CH\_ORILAM}}
\item  CORGANIC: type of parameterization for organic gas/particle balance. To activate organic parameterization it is necessary to use a chemical scheme capable forming secondary organic aerosol (i.e. RELACS2 or CACM). Possible values are:\\
CORGANIC = 'PUN' : PUN parameterization  \\
CORGANIC = 'MPMPO': MPMPO (non vectorized) 

\index{CNUCLEATION!\innam{NAM\_CH\_ORILAM}}
\item  CNUCLEATION: type of parameterization for nucleation (formation of new particle from sulphates). Possible values are:\\
CNUCLEATION = 'KULMALA' : KULMALA parameterization \\  
CNUCLEATION = 'KERMINEN': KERMINEN parameterization  

\item Convective scavenging is activated with LCH\_CONV\_SCAV in NAM\_CH\_MNHCn.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Namelist NAM\_CH\_SOLVERn (control stiff solvers for modeln)}
\index{NAM\_CH\_SOLVERn!namelist description}
 
\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
CSOLVER 	&32 characters 	&'EXQSSA'\\
NSSA 		&integer 	&0\\
NSSAINDEX 	&array integers &1000*0\\
XRTOL 		&real 		&0.001\\
XATOL 		&real 		&0.1\\
NRELAB 		&integer 	&2\\
NPED 		&integer 	&1\\
NMAXORD 	&integer 	&5\\
LPETZLD 	&logical 	&TRUE\\
CMETHOD 	&1 character 	&N\\
CNORM 		&1 character 	&A\\
NTRACE 		&integer 	&0\\
XALPHA 		&real 		&0.5\\
XSLOW 		&real 		&100.0\\
XFAST 		&real 		&0.1\\
NQSSAITER 	&integer 	&1\\
XDTMIN 		&real	 	&0.1\\
XDTMAX 		&real	 	&600.\\
XDTFIRST 	&real 		&10.\\
\hline
\end{tabular}
\end{center}
\begin{itemize}

\index{CSOLVER!\innam{NAM\_CH\_SOLVERn}}
\item CSOLVER: type of numerical method used to resolve the ode system of coupling differential equations for chemistry (chemistry solver). for the description of each method, see the associated  ch\_routine. rosenbrock'method are gouped in mode\_RBK90\_Integrator routine. possible values are: 
\begin{itemize}
         \item CSOLVER='SIS'
         \item CSOLVER='LINSSA'
         \item CSOLVER='CRANCK'
         \item CSOLVER='QSSA'
         \item CSOLVER='EXQSSA'
         \item CSOLVER='ROS1'
         \item CSOLVER='ROS2'
         \item CSOLVER='ROS3'
         \item CSOLVER='ROS4'
         \item CSOLVER='RODAS3'
         \item CSOLVER='RODAS4'
         \item CSOLVER='ROSENBROCK': default method ROS1 with ROSENBROCK
\end{itemize}

\index{NSSA!\innam{NAM\_CH\_SOLVERn}}
\item NSSA: number of variables to be treated as "steady state".

\index{NSSAINDEX!\innam{NAM\_CH\_SOLVERn}}
\item NSSAINDEX: index set of steady state variables.

\index{XRTOL!\innam{NAM\_CH\_SOLVERn}}
\item XRTOL: relative tolerance for SVODE and D02EAF, D02EBF, D02NBF methods.

\index{XATOL!\innam{NAM\_CH\_SOLVERn}}
\item XATOL: absolute tolerance for SVODE and D02NBF.

\index{NRELAB!\innam{NAM\_CH\_SOLVERn}}
\item NRELAB: choose relative error for NAG's D02EBF solver:
\begin{itemize}
          \item NRELAB=1 : for correct decimal places
          \item NRELAB=2 : for correct significant digits
          \item NRELAB=0 : for a mixture
\end{itemize}

\index{NPED!\innam{NAM\_CH\_SOLVERn}}
\item NPED: calculation parameter of the Jacobian matric for SVODE and NAG's D02EBF/D02NBF solvers:
\begin{itemize}
          \item NPED=1 : for analytical Jacobian (using subroutine CH\_JAC)
          \item NPED=0 : for numerical Jacobian
\end{itemize}

\index{NMAXORD!\innam{NAM\_CH\_SOLVERn}}
\item NMAXORD: maximum order for the BDF method (0<NMAXORD<=5) for NAG's D02NBF solver.

\index{LPETZLD!\innam{NAM\_CH\_SOLVERn}}
\item LPETZLD: switch to activate Petzold local error test (recommended) for NAG's D02NBF solver.

\index{CMETHOD!\innam{NAM\_CH\_SOLVERn}}
\item CMETHOD: method to use non-linear system for NAG's D02NBF solver.
\begin{itemize}
          \item CMETHOD='N' or 'D' : modified Newton iteration
          \item CMETHOD='F' : functional iteration
\end{itemize}

\index{CNORM!\innam{NAM\_CH\_SOLVERn}}
\item CNORM: type of norm to be used for NAG's D02NBF solver.
\begin{itemize}
          \item CNORM='A' or 'D' : averaged L2 norm
          \item CNORM='M' : maximum norm
\end{itemize}

\index{NTRACE!\innam{NAM\_CH\_SOLVERn}}
\item NTRACE: level of output from D02NBF solver:
\begin{itemize}
          \item NTRACE=-1 : no output
          \item NTRACE=0 : only warnings are printed
          \item NTRACE$\ge$1 : details on Jacobian entries, nonlinear iteration and time integration are given 
\end{itemize}

\index{XALPHA!\innam{NAM\_CH\_SOLVERn}}
\item XALPHA: the Cranck-Nicholson parameter (0,1).

\index{XSLOW!\innam{NAM\_CH\_SOLVERn}}
\item XSLOW: slow species, lifetime > XSLOW * timestep for EXQSSA and QSSA methods.

\index{XFAST!\innam{NAM\_CH\_SOLVERn}}
\item XFAST: fast species, lifetime < XFAST * timestep for EXQSSA and QSSA methods.

\index{NQSSAITER!\innam{NAM\_CH\_SOLVERn}}
\item NQSSAITER: number of iterations in QSSA method.

\index{XDTMIN!\innam{NAM\_CH\_SOLVERn}}
\item XDTMIN: minimal allowed timestep for EXQSSA.

\index{XDTMAX!\innam{NAM\_CH\_SOLVERn}}
\item XDTMAX: maximal allowed timestep for EXQSSA.

\index{XDTFIRST!\innam{NAM\_CH\_SOLVERn}}
\item XDTFIRST: timestep for first integration step of EXQSSA.

\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_CONDSAMP (Conditional sampling)}
\index{NAM\_CONDSAMP!namelist description}
\begin{center}
\begin{tabular}{|l|l|l| }
\hline 
 Fortran name  & Fortran type  & default value \\
\hline
 LCONDSAMP     & logical       & FALSE         \\
 NCONDSAMP     & integer       & 3             \\
 XRADIO        & array(real)   & 3*900.     \\
 XSCAL         & array(real)   & 3*1.       \\
 XHEIGHT\_BASE & real          & 100.       \\
 XDEPTH\_BASE  & real          & 100.       \\
 XHEIGHT\_TOP  & real          & 100.       \\
 XDEPTH\_TOP   & real          & 100.       \\
\hline
\end{tabular}
\end{center}

It contains the parameters to activate conditional sampling (Couvreux et al., 2010).   
The first tracer is released at the surface,
the second one is released XHEIGHT\_BASE below the cloud base on XDEPTH\_BASE depth
the third one is released XHEIGHT\_TOP above the cloud top on XDEPTH\_TOP depth.
\begin{itemize}
\item LCONDSAMP \index{LCONDSAMP!\innam{NAM\_CONDSAMP}}:
Flag to activate conditional sampling                                          
\item NCONDSAMP \index{NCONDSAMP!\innam{NAM\_CONDSAMP}}:
Number of conditional samplings                                                                                                              
\item XRADIO  \index{XRADIO !\innam{NAM\_CONDSAMP}}:
Period of radioactive decay                                    
\item XSCAL  \index{XSCAL !\innam{NAM\_CONDSAMP}}:
Scaling factor                               
\item XHEIGHT\_BASE  \index{XHEIGHT\_BASE !\innam{NAM\_CONDSAMP}}:
Height below the cloud base where the 2nd tracer is released
\item XDEPTH\_BASE  \index{XDEPTH\_BASE !\innam{NAM\_CONDSAMP}}:
Depth  on which the 2nd tracer is released
\item XHEIGHT\_TOP  \index{XHEIGHT\_TOP !\innam{NAM\_CONDSAMP}}:
Height above the cloud top where the 3rd tracer is released
\item XDEPTH\_TOP  \index{XDEPTH\_TOP !\innam{NAM\_CONDSAMP}}:
Depth on which the 3rd tracer is released
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_CONF (global configuration parameters)}
\index{NAM\_CONF!namelist description}
It contains the model configuration parameters common to all the models. They
are included in the module MODD\_CONF. 


\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
CCONF      &  5 characters  & 'START'  \\
LFLAT      & logical        & FALSE  \\
CEQNSYS    & 3 characters   & 'DUR'    \\
LFORCING   & logical        & FALSE  \\
NMODEL     & integer        & 1      \\
NVERB      & integer        & 5      \\
NHALO      & integer        & 1      \\
JPHEXT     & integer        & 1      \\
CSPLIT     & 10 characters  & 'YSPLITTING' \\
LLG        & logical        & FALSE  \\
LINIT\_LG  & logical        & FALSE  \\
CINIT\_LG  & 5 characters   & 'FMOUT'   \\
LNOMIXLG   & logical        & FALSE  \\
CEXP       & 5 characters   & 'EXP01'  \\
CSEG       & 5 characters   & 'SEG01'  \\
LCHECK     & logical        & FALSE  \\
\hline
\end{tabular}
\end{center}



\begin{itemize}

\item
CCONF:  configuration of all  models
\index{CCONF!\innam{NAM\_CONF}}

\begin{itemize}
\item                       'START  ' for start configuration
\item                       'RESTA'   for restart configuration
\end{itemize}

\item
CEQNSYS: Equation system resolved by the MESONH model
\index{CEQNSYS!\innam{NAM\_CONF}}

\begin{itemize}
\item 'LHE' Lipps and HEmler anelastic system
\item 'DUR' approximated form of the DURran version of the anelastic sytem
\item 'MAE' classical Modified Anelastic Equations but with not any approximation
in the momentum equation
\end{itemize}

\item
LFLAT:   Flag for zero ororography
\index{LFLAT!\innam{NAM\_CONF}}

\begin{itemize}
\item   .TRUE.  = no orography (zs=0.)
\item  .FALSE.  = the orography is not zero everywhere
\end{itemize}

\item
LFORCING: Flag to use forcing sources
\index{LFORCING!\innam{NAM\_CONF}}

\begin{itemize}
\item .TRUE. add forcing sources
\item .FALSE. no forcing sources
\end{itemize}


\item
NMODEL:  Number of nested models
\index{NMODEL!\innam{NAM\_CONF}}

\item
NVERB:  Level of informations on output-listing
\index{NVERB!\innam{NAM\_CONF}}

\begin{itemize}
\item   0 for minimum of prints
\item   5 for intermediate level of prints
\item    10 for maximum of prints 
\end{itemize}

\item
NHALO: Size of the halo for parallel distribution.
This variable is related to computer performance but has no
impact on simulation results.\\
NHALO must be equal to 3 for WENO5 cases in parallel runs
\index{NHALO!\innam{NAM\_CONF}}

\item
JPHEXT:  Horizontal External points number\\
JPHEXT must be equal to 3 for cyclic cases with WENO5.
\index{JPHEXT!\innam{NAM\_CONF}}

\item
CSPLIT: Kind of domain splitting for parallel distribution.
This variable is related to computer performance but has no
impact on simulation results
\index{CSPLIT!\innam{NAM\_CONF}}

\begin{itemize}
\item 'BSPLITTING' domain is decomposed in Box along X and Y
\item 'XSPLITTING' the X direction is splitted in stripes along Y
\item 'YSPLITTING' the Y direction is splitted in stripes along X
\end{itemize}

\item
LLG: Flag to use Lagrangian variables
\index{LLG!\innam{NAM\_CONF}}

\item
LINIT\_LG: Flag to reinitialize  Lagrangian variables (with LLG=.T.)
\index{LINIT\_LG!\innam{NAM\_CONF}}

\item
CINIT\_LG:  with LINIT\_LG=T :
\index{CINIT\_LG!\innam{NAM\_CONF}}
\begin{itemize}
\item 'FMOUT' each time an output file is written
\item other string: only when starting a new segment (CCONF='RESTA')
\end{itemize}

\item
LNOMIXLG: Flag to unset the turbulence for LG variables.\\
 You must have LNOMIXLG=.TRUE. with CSCONV='EDKF'
\index{LNOMIXLG!\innam{NAM\_CONF}}

\item
CEXP: Experiment name (this is the name of the set of run, you have performed
or you want to perform on the same physical subject) 
\index{CEXP!\innam{NAM\_CONF}}
{\bf Please do not leave any blank character in this name!}

\item
CSEG:  Name of segment (this is the name of the future run, you want to perform)
\index{CSEG!\innam{NAM\_CONF}}
{\bf Please do not leave any blank character in this name!}

\item
LCHECK:   Flag for testing reproducibility
\index{LCHECK!\innam{NAM\_CONF}}


\end{itemize}

From these last two informations, we built the names of the different MESONH
output files: 

CEXP.\$n.CSEG.nbr

where \$n represents the number of the model which generates this output and nbr
is the number of the outfile. For instance, if $CEXP='HYDRO'$ and $CSEG='INIT1'$
and we use only  one model (no gridnesting) the different output will be called:

$HYDRO.1.INIT1.001 , \ \ HYDRO.1.INIT1.002, \ \ ....$
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_CONFIO}\label{s:namconfio}
\index{NAM\_CONFIO!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LCDF4      & logical  & FALSE  \\
LLFIOUT    & logical  & FALSE  \\
LLFIREAD   & logical  & FALSE  \\
\hline
\end{tabular}
\end{center}

\begin{itemize}

\item
LCDF4 : to enable the creation of netcdf file in INPUT/OUTPUT (netcdf 4)
\index{LCDF4!\innam{NAM\_CONFIO}}

\begin{itemize}
\item   .TRUE.  : netcdf4 files will be created
\item   .FALSE. : no netcdf4  files only LFI files
\end{itemize}

\item
LLFIOUT : to add LFI output when  LCDF4 = T 
\index{LLFIOUT!\innam{NAM\_CONFIO}}

\begin{itemize}
\item   .TRUE.  : LFI files AND  netcdf files will be created
\item   .FALSE. : ONLY netcdf files will be created
\end{itemize}

\item
LLFIREAD : to enable LFI reading when LCDF4 = T and LLFIOUT=T  
\index{LLFIREAD!\innam{NAM\_CONFIO}}

\begin{itemize}
\item   .TRUE.  : lfi files will be read
\item   .FALSE. : netcdf files will be read
\end{itemize}


\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_CONFn (configuration of model n)}
\index{NAM\_CONFn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LUSERV   & logical & TRUE  \\
LUSECI   & logical  & FALSE  \\
LUSERC   & logical  & FALSE  \\
LUSERR   & logical  & FALSE  \\
LUSERI   & logical  & FALSE  \\
LUSERS   & logical  & FALSE  \\
LUSERG   & logical  & FALSE  \\
LUSERH   & logical  & FALSE  \\
NSV\_USER & integer  & 0\\
\hline
\end{tabular}
\end{center}


It contains the model configuration parameters specific for the  model n. They
are included in the module MODD\_CONFn. 
\begin{itemize}
\item
\index{LUSERV!\innam{NAM\_CONFn}}
LUSERV : Flag to use vapor mixing ratio (prognostic variable $r_v$)
\begin{itemize}
\item   .TRUE. $r_v$ is present
\item   .FALSE. $r_v$ is not allocated
\end{itemize}
\item
LUSECI : Flag to use Pristine Ice (diagnostic variable $C_i$)
\index{LUSECI!\innam{NAM\_CONFn}}
\begin{itemize}
\item   .TRUE. $C_i$ is present
\item   .FALSE. $C_i$ is not allocated
\end{itemize}
\item LUSERC (Same as LUSERV but for the cloud mixing ratio $r_c$), LUSERR (for rain mixing ratio $r_r$), LUSERI (for ice mixing ratio $r_i$), LUSERS (for snow mixing ratio $r_s$), LUSERG (for graupel mixing ratio $r_g$) and LUSERH (for hail mixing ratio $r_h$) : {\bf You don't need to fill this records : they are directly managed by CCLOUD.}
\index{LUSERC!\innam{NAM\_CONFn}}
\index{LUSERR!\innam{NAM\_CONFn}}
\index{LUSERI!\innam{NAM\_CONFn}}
\index{LUSERS!\innam{NAM\_CONFn}}
\index{LUSERG!\innam{NAM\_CONFn}}
\index{LUSERH!\innam{NAM\_CONFn}}
\item
NSV\_USER  : Number of user passive scalar variables \\
{\bf Caution! Scalar variables needed for the 2-moment microphysical schemes,
lagrangian trajectory, passive pollutants or the chemistry options are treated automatically by the model and
should not be counted here. }
\index{NSV\_USER!\innam{NAM\_CONFn}}
\end{itemize}

\subsection{Namelist NAM\_CONFZ}
See section \ref{s:namconfz} page \pageref{s:namconfz} for details.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_CONVECTn}
The namelist NAM\_CONVECTn does not exist any more since masdev48 : it is replaced by NAM\_PARAM\_KAFRn.
The logicals LSHAL and LDEEP are deleted.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_DRAGTREE}
\index{NAM\_DRAGTREE!namelist description}
This namelist allows to take into account drag of trees in the atmospheric model instead of SURFEX according
to Aumond et al. (2011) in the case of very fine vertical resolution. 
The Z0 vegetation is therefore reduced to the roughness of grassland in SURFEX
 (z0v\_from\_lai.F90). LTREE\_DRAG in NAM\_TREEDRAG of SURFEX must also be activated.

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LDRAGTREE   & logical  & FALSE  \\
LDEPOTREE   & logical  & FALSE  \\
XVDEPOTREE   & real  & 0.02  \\
\hline
\end{tabular}
\end{center}

\begin{itemize}

\index{LDRAGTREE!\innam{NAM\_DRAGTREE}}
\item LDRAGTREE: flag to activate drag of trees
\item LDEPOTREE: flag for droplet deposition on trees
\item XVDEPOTREE: Droplet deposition velocity on trees
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_DUST }
\index{NAM\_DUST!namelist description}
This namelist is use to activate explicit aerosol dusts. 
It is not necessary to use chemistry to activate dusts but it is recommended to activate on-line dust emissions (see surface namelists).
Radiative direct effects are automatically deduced from an interpolation table of SHDOM radiative code (Mie). 

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LDUST       & logical  & FALSE  \\
LVARSIG     & logical  & FALSE  \\
LSEDIMDUST  & logical  & FALSE  \\
NMODE\_DST & integer  &  3  \\
LRGFIX\_DST  & logical  & FALSE  \\
LDEPOS\_DST  & logical  & FALSE  \\
\hline
\end{tabular}
\end{center}

\begin{itemize}

\index{LDUST!\innam{NAM\_DUST}}
\item LDUST: flag to activate passive dust aerosol.
\index{LVARSIG!\innam{NAM\_DUST}}
\item LVARSIG: flag to activate variable standard deviation for each dust mode.
\index{LSEDIMDUST!\innam{NAM\_DUST}}
\item LSEDIMDUST: flag to activate dust sedimentation.
\index{NMODE\_DST!\innam{NAM\_DUST}}
\item  NMODE\_DST: number of lognormal dust modes (maximum of 3 modes).
\index{LRGFIX\_DST!\innam{NAM\_DUST}}
\item LRGFIX\_DST : flag to use only 1 moment for each dust mode (LRGFIX\_DST='TRUE' associated to LVARSIG='FALSE)
\index{LDEPOS\_DST!\innam{NAM\_DUST}}
\item LDEPOS\_DST (new in masdev48) flag to activate wet dust deposition  
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_DYN (global parameters for the dynamics)}
\index{NAM\_DYN!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
XSEGLEN     &  real   & 43200.   \\
XASSELIN    & real    & 0.2      \\
XASSELIN\_SV & real    & 0.02     \\
LCORIO      & logical & TRUE     \\
LNUMDIFU    & logical & FALSE    \\
LNUMDIFTH   & logical & FALSE    \\
LNUMDIFSV   & logical & FALSE    \\
LZDIFFU     & logical & FALSE    \\
XALKTOP     & real    & 0.01     \\
XALZBOT     & real    & 4000.    \\
XALKGRD     & real    & 0.01     \\
XALZBAS     & real    & 0.01     \\
\hline 
\end{tabular}
\end{center}



It contains the dynamics parameters common to all models. They
are included in the module MODD\_DYN. 
\begin{itemize}

\item
XSEGLEN : Segment length  in seconds, corresponding to the duration of the segment simulation.
\index{XSEGLEN!\innam{NAM\_DYN}}


\item
XASSELIN : Amplitude of the Asselin temporal  filter for meteorological variables
\index{XASSELIN!\innam{NAM\_DYN}}

\item
XASSELIN\_SV : Same as XASSELIN but for scalar variables
\index{XASSELIN\_SV!\innam{NAM\_DYN}}


\item
LCORIO : Flag to set the Coriolis parameters $f$ and $f^*$ to zero
\index{LCORIO!\innam{NAM\_DYN}}

\begin{itemize}
\item .TRUE.  the Earth rotation is taken into account
\item  .FALSE. the Earth rotation effects are neglected  
\end{itemize} 

\item
LNUMDIFU (formerly in masdev47 LNUMDIFF) :  Flag to activate the numerical diffusion for momentum : advised to activate if CUVW\_ADV\_SCHEME='CEN4TH' or 'CEN2ND', and to not activate if CUVW\_ADV\_SCHEME='WENO\_K'
(XT4DIFU in NAM\_DYNn defines the intensity of this diffusion).
\index{LNUMDIFU!\innam{NAM\_DYN}}

\item
LNUMDIFTH (formerly in masdev47 LNUMDIFF)  :  Flag to activate the numerical diffusion for meteorological scalar variables (temperature, water substances and TKE)
(XT4DIFTH in NAM\_DYNn defines the intensity of this diffusion). If CMET\_ADV\_SCHEME is PPM\_01, it is not necessary to activate numerical diffusion.
\index{LNUMDIFTH!\innam{NAM\_DYN}}

\item
LNUMDIFSV (formerly in masdev47 LNUMDIFF)  :  Same as LNUMDIFTH but for scalar variables

\index{LNUMDIFSV!\innam{NAM\_DYN}}

\item
\index{LZDIFFU!\innam{NAM\_DYN}}
LZDIFFU: Flag to apply the horizontal diffusion to potential temperature and vapor mixing ratio according to Zangl (2002)
adapted to mountainous topography. No amplitude is applied for this type of diffusion.
\begin{itemize}
\item   .TRUE. This horizontal diffusion is applied 
\item   .FALSE. This horizontal diffusion is not applied           
\end{itemize}
This flag is independant from LNUMDIFU and LNUMDIFSV, applied to the dynamical variables and the scalar variables respectively.
\item
XALKTOP : Maximum value of the Rayleigh damping (in  $s^{-1}$ )at the top of the upper absorbing 
layer. The shape of the absorbing layer is a $\sin ^2$ of $\hat{z}$ (see the
scientific documentation for more details).
\index{XALKTOP!\innam{NAM\_DYN}}

\item
XALZBOT :  Height (in meters) in the physical space of the upper absorbing layer base. 
\index{XALZBOT!\innam{NAM\_DYN}}

\item
XALKGRD : Maximum value of the Rayleigh damping (in  $s^{-1}$ )at the top of the lower absorbing 
layer. \index{XALKGRD!\innam{NAM\_DYN}}

\item
XALZBAS :  Height (in meters) in the physical space of the lower absorbing layer base. 
\index{XALZBAS!\innam{NAM\_DYN}}

\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_DYNn (parameters for the dynamics of model n)}
\index{NAM\_DYNn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
XTSTEP    & real   & 60.  \\
CPRESOPT  & 4 characters  & 'CRESI'  \\
NITR      & integer   & 4   \\
LITRADJ   & logical   & TRUE  \\
XRELAX    & real     & 1.   \\
LHORELAX\_UVWTH &  logical  & FALSE  \\
LHORELAX\_RV &  logical  & FALSE  \\
LHORELAX\_RC &  logical  & FALSE  \\
LHORELAX\_RR &  logical  & FALSE  \\
LHORELAX\_RI &  logical  & FALSE  \\
LHORELAX\_RS &  logical  & FALSE  \\
LHORELAX\_RG &  logical  & FALSE  \\
LHORELAX\_RH &  logical  & FALSE  \\
LHORELAX\_TKE &  logical  & FALSE  \\
LHORELAX\_SV & array logical & FALSE  \\
LHORELAX\_SVC2R2 &   logical & FALSE  \\
LHORELAX\_SVC1R3 &   logical & FALSE  \\
LHORELAX\_SVLG   &   logical & FALSE  \\
LHORELAX\_SVCHEM &   logical & FALSE  \\
LHORELAX\_SVDST  &   logical & FALSE  \\
LHORELAX\_SVPP   &   logical & FALSE  \\
LHORELAX\_SVAER  &   logical & FALSE  \\
LVE\_RELAX&  logical  & FALSE  \\
LVE\_RELAX\_GRD&  logical  & FALSE  \\
NRIMX     & integer   & 1   \\
NRIMY     & integer   & 1   \\
XRIMKMAX  &  real     & $1 / (100*60.) $ \\
XT4DIFU   &  real     & 1800.  \\
XT4DIFTH  &  real     & 1800.  \\
XT4DIFSV  &  real     & 1800.  \\
\hline
\end{tabular}
\end{center}


It contains the specific dynamic parameters  for the modesimulation.texl n. They
are included in the module MODD\_DYNn. 
\begin{itemize}

\item
XTSTEP : Time step in seconds. If the model is not the DAD model,
XTSTEP is not taken into account but NDTRATIO in NAM\_NESTING.
\index{XTSTEP!\innam{NAM\_DYNn}}

\item
CPRESOPT :\index{CPRESOPT!\innam{NAM\_DYNn}}
 Pressure solver option. 3 choices are implemented in MESONH for the
moment (see the Scientific documentation for more details) : 

\begin{itemize}
\item 'RICHA' Richardson method preconditionned by the flat cartesian operator   
\item 'CGRAD' Generalized pre-conditioned gradient for non-symmetric problems
 with the same preconditioner
\item 'CRESI' Conjugate Residual method
\item 'ZRESI' Parallelized version of Conjugate Residual method
\end{itemize}
{\bf If the problem is flat and cartesian, then the resolution
becomes exact and no iteration is performed.}

\item
NITR : Number of iterations for the  pressure solver. The value of this
parameter depends on the maximum slope of the orography  in the model.  
\index{NITR!\innam{NAM\_DYNn}}

\item
LITRADJ : Logical to adjust the number of iterations for the  pressure solver according to the range of the residual divergence. 
\index{LITRADJ!\innam{NAM\_DYNn}}

\item
\index{XRELAX!\innam{NAM\_DYNn}}
XRELAX : Relaxation coefficient in the Richardson method ( CPRESOPT = 'RICHA' ).
This value can be less than 1 only for very steep orography, in general, the
optimal value is equal to 1.


\item
\index{LHORELAX\_UVWTH!\innam{NAM\_DYNn}}
LHORELAX\_UVWTH : Flag for the horizontal relaxation applied on the
outermost verticals of the model for U,V,W TH variables. 
\begin{itemize}
\item   .TRUE. The horizontal  relaxation is applied 
\item   .FALSE. The horizontal  relaxation is not applied 
\end{itemize}

\item
\index{LHORELAX\_RV!\innam{NAM\_DYNn}}
\index{LHORELAX\_RC!\innam{NAM\_DYNn}}
\index{LHORELAX\_RR!\innam{NAM\_DYNn}}
\index{LHORELAX\_RI!\innam{NAM\_DYNn}}
\index{LHORELAX\_RS!\innam{NAM\_DYNn}}
\index{LHORELAX\_RG!\innam{NAM\_DYNn}}
\index{LHORELAX\_RH!\innam{NAM\_DYNn}}
\index{LHORELAX\_TKE!\innam{NAM\_DYNn}}
\index{LHORELAX\_SV!\innam{NAM\_DYNn}}
\index{LHORELAX\_SVCHEM!\innam{NAM\_DYNn}}
\index{LHORELAX\_SVC2R2!\innam{NAM\_DYNn}}
\index{LHORELAX\_SVC1R3!\innam{NAM\_DYNn}}
\index{LHORELAX\_SVLG!\innam{NAM\_DYNn}}
\index{LHORELAX\_SVDST!\innam{NAM\_DYNn}}
\index{LHORELAX\_SVPP!\innam{NAM\_DYNn}}
\index{LHORELAX\_SVAER!\innam{NAM\_DYNn}}
\index{LHORELAX\_SVELEC!\innam{NAM\_DYNn}}
LHORELAX\_RV, LHORELAX\_RC, LHORELAX\_RR, LHORELAX\_RI,


LHORELAX\_RS, LHORELAX\_RG, LHORELAX\_RH, LHORELAX\_TKE,


LHORELAX\_SV, LHORELAX\_SVCHEM, LHORELAX\_SVC2R2,


LHORELAX\_SVC1R3, LHOREAX\_SVLG, LHORELAX\_SVDST,


LHORELAX\_SVPP, LHORELAX\_SVAER, LHORELAX\_SVELEC : same as for other variables

It is safer to set all the LHORELAX\_ values rather than
use their default values which can be modified by the desfm file.

\item
\index{LVE\_RELAX!\innam{NAM\_DYNn}}
LVE\_RELAX : Flag for the vertical relaxation applied to the outermost
verticals of the model. 
\begin{itemize}
\item   .TRUE. The vertical  relaxation is applied 
\item   .FALSE. The vertical    relaxation is not applied 
\end{itemize}

\item
\index{LVE\_RELAX\_GRD!\innam{NAM\_DYNn}}
LVE\_RELAX\_GRD : Flag for the vertical relaxation applied to the lowest
verticals of the model. 
\begin{itemize}
\item   .TRUE. The vertical  relaxation is applied 
\item   .FALSE. The vertical    relaxation is not applied 
\end{itemize}


\item
\index{NRIMX!\innam{NAM\_DYNn}}
NRIMX : number of points  in the lateral relaxation  in the x axis. 

\item
\index{NRIMY!\innam{NAM\_DYNn}}
NRIMY : number of points in the lateral relaxation  in the Y axis.
\item
\index{XRIMKMAX!\innam{NAM\_DYNn}}
XRIMKMAX : maximum value (in $s^{-1}$)  of the relaxation coefficient
for the lateral relaxation area. This value is applied to all the
outermost verticals of the domain if LHO\_RELAX. 

\item
\index{XT4DIFU!\innam{NAM\_DYNn}}
XT4DIFU (formerly in masdev47 XT4DIFF) : characteristic time (e-folding time)  
of the fourth order numerical diffusion for momentum ( in seconds). Associated to LNUMDIFU in NAM\_DYN.

\item
\index{XT4DIFTH!\innam{NAM\_DYNn}}
XT4DIFTH (formerly in masdev47 XT4DIFF) : characteristic time (e-folding time)  of the numerical diffusion
of fourth order for meteorological variables ( in seconds). Associated to LNUMDIFTH in NAM\_DYN.

\item
\index{XT4DIFSV!\innam{NAM\_DYNn}}
XT4DIFSV (formerly in masdev47 XT4DIFF) : characteristic time (e-folding time)  of the numerical diffusion
of fourth order for scalar variables ( in seconds). Associated to LNUMDIFSV in NAM\_DYN.

\end{itemize}
%\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_LATZ\_EDFLX}
\index{NAM\_LATZ\_EDFLX!namelist description}
  \begin{center}
  \begin{tabular}{|l|l|l|}
    \hline
    Fortran name & Fortran type & default value \\
    \hline
     LUV\_FLX  & logical   & .FALSE. \\
     XUV\_FLX1 & real      &  3.E+14 \\
     XUV\_FLX2 & real      &  0      \\
     LTH\_FLX  & logical   & .FALSE. \\
     XTH\_FLX  & real      &  0.75   \\

    \hline
  \end{tabular}
  \end{center}
\begin{itemize}
  \item LUV\_FLX  \index{LUV\_FLX!\innam{NAM\_LATZ\_EDFLX}}: to activate eddy flux for the UV flux
  \item XUV\_FLX1 \index{XUV\_FLX1!\innam{NAM\_LATZ\_EDFLX}}: Coefficient in the formulation of the UV flux (m3 )
                                                  It gives the magnitude of u'v' the eddy flux.
                                                If 0, there is no UV flux
                                                The UV flux mimics the meridional transports of momentum associated with eddies
                                                    not taken into account in a 2D  merdional vertical model
  \item XUV\_FLX2 \index{XUV\_FLX2!\innam{NAM\_LATZ\_EDFLX}}: Coefficient in the formulation of the UV flux. 
                                                Add an miminum constant value to the u'v' flux. 

  \item LTH\_FLX \index{LTH\_FLX!\innam{NAM\_LATZ\_EDFLX}}:to activate eddy flux for the theta flux
  \item XTH\_FLX \index{XTH\_FLX!\innam{NAM\_LATZ\_EDFLX}}:Coefficient in the formulation of the theta flux 
                                                It gives the magnitude of the v'T' and W'T' eddy flux.
                                                If 0, there is no theta flux
                                                The theta flux mimics the meridional transports of potential temperature 
                                                    associated with eddies not taken into account in a 2D model 

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_ELEC}
\index{NAM\_ELEC!namelist description}
  \begin{center}
  \begin{tabular}{|l|l|l|}
    \hline
    Fortran name & Fortran type & default value \\
    \hline
    LOCG            & logical      & .FALSE. \\
    LELEC\_FIELD    & logical      & .TRUE.  \\
    LFLASH\_GEOM    & logical      & .TRUE.  \\
    LFW\_HELFA      & logical      & .FALSE. \\
    LCOSMIC\_APPROX & logical      & .FALSE. \\
    LION\_ATTACH    & logical      & .TRUE.  \\
    CDRIFT          & 3 characters & 'PPM'   \\
    LRELAX2FW\_ION  & logical      & .FALSE. \\
    LINDUCTIVE      & logical      & .FALSE. \\
    LSAVE\_COORD    & logical      & .FALSE. \\
    LLNOX\_EXPLICIT & logical      & .FALSE. \\
    LSERIES\_ELEC   & logical      & .FALSE. \\
    NTSAVE\_SERIES  & integer      & 60      \\
    NFLASH\_WRITE   & integer      & 100     \\
    CNI\_CHARGING   & 5 characters & 'TAKAH' \\
    XQTC            & real         & 263.    \\
    XLIM\_NI\_IS    & real         & 10.E-15 \\
    XLIM\_NI\_IG    & real         & 30.E-15 \\
    XLIM\_NI\_SG    & real         & 100.E-15\\
    CLSOL           & 5 characters & 'RICHA' \\
    NLAPITR\_ELEC   & integer      & 4       \\
    XRELAX\_ELEC    & real         & 1       \\
    XETRIG          & real         & 200.E3  \\
    XEBALANCE       & real         & 0.1     \\
    XEPROP          & real         & 15.E3   \\
    XQEXCES         & real         & 2.E-10  \\
    XQNEUT          & real         & 1.E-10  \\
    XDFRAC\_ECLAIR  & real         & 2.3     \\
    XDFRAC\_L       & real         & 1500.   \\
    XWANG\_A        & real         & 0.34E21 \\
    XWANG\_B        & real         & 1.3E16  \\
    \hline
  \end{tabular}
  \end{center}


It contains the different parameters used by the electrical scheme. 
They are included in the declarative module MODD\_ELEC\_DESCRn.

\begin{itemize}
  \item LOCG \index{LOCG!\innam{NAM\_ELEC}}: when this logical swith is set to .TRUE., only the cloud electrification is computed. When set to .FALSE., lightning flashes can be produced.
  \item LELEC\_FIELD \index{LELEC\_FIELD!\innam{NAM\_ELEC}} : when this logical switch is set to .TRUE., the electric field is computed.
  \item LFLASH\_GEOM \index{LFLASH\_GEOM!\innam{NAM\_ELEC}}: when this logical switch is set to .TRUE., the lightning flash branches are produced randomly. (only one lightning scheme implemented, then must be set to .TRUE.)
  \item LFW\_HELFA \index{LFW\_HELFA!\innam{NAM\_ELEC}}: when .T. Helsdon-Farley Fair Weather field
  \item LCOSMIC\_APPROX \index{LCOSMIC\_APPROX !\innam{NAM\_ELEC}} : .T.: Neglecting height variations of fair ion weather ion current in calculating ion source from cosmic rays
  \item LION\_ATTACH \index{LION\_ATTACH!\innam{NAM\_ELEC}}: when .T. ion attachment to hydrometeors is considered
  \item CDRIFT \index{CDRIFT!\innam{NAM\_ELEC}}: ion drift
    \begin{itemize}
     \item 'PPM' : PPM advection scheme
     \item 'DIV' : divergence form
    \end{itemize}
  \item LRELAX2FW\_ION\index{LRELAX2FW\_ION!\innam{NAM\_ELEC}} : when .T. relaxation to fair weather concentration in rim zone and top absorbing layer
  \item LINDUCTIVE\index{LINDUCTIVE!\innam{NAM\_ELEC}} : when this logical swith is set to .TRUE., the inductive charging mechanism is taken into account.
  \item LSAVE\_COORD \index{LSAVE\_COORD!\innam{NAM\_ELEC}}: when this logical switch is set to .TRUE., the flash coordinates are written in an ascii file.
  \item LSERIES\_ELEC\index{LSERIES\_ELEC!\innam{NAM\_ELEC}} : when this logical switch is set to .TRUE., some dynamical and microphysical parameters are computed and saved in an ascii file
  \item NTSAVE\_SERIES\index{NTSAVE\_SERIES!\innam{NAM\_ELEC}} : time interval (s) at which data from series\_cloud\_elec are written in an ascii file
  \item NFLASH\_WRITE \index{NFLASH\_WRITE!\innam{NAM\_ELEC}}: number of flashes to be saved before writing the diag and/or coordinates in ascii files
  \item LLNOX\_EXPLICIT \index{LLNOX\_EXPLICIT!\innam{NAM\_ELEC}}: when this logical switch is set to .TRUE., nitrogen oxides are produced along the lightning path (not yet implemented)
  \item CNI\_CHARGING\index{CNI\_CHARGING!\innam{NAM\_ELEC}} : non-inductive charging parameterization
    \begin{itemize}
      \item 'HELFA' : based on Helsdon and Farley (1987)
      \item 'TAKAH' : based on Takahashi (1978)
      \item 'SAUN1' : based on Saunders et al. (1991), but does not take into account the marginal positive and negative regions at low liquid water content
      \item 'SAUN2' : based on Saunders et al. (1991)
      \item 'SAP98' : based on Saunders and Peck (1998)
      \item 'GARDI' : based on Gardiner et al. (1985)
    \end{itemize}
  \item XQTC \index{XQTC!\innam{NAM\_ELEC}}: temperature charge reversal (K), only if CNI\_CHARGING = 'HELFA'
  \item XLIM\_NI\_IS = 2.E-15\index{XLIM\_NI\_IS!\innam{NAM\_ELEC}} max magnitude of dq for I-S non-inductive charging (C)
  \item XLIM\_NI\_IG = 2.E-14\index{XLIM\_NI\_IG!\innam{NAM\_ELEC}} max magnitude of dq for I-G non-inductive charging (C)
  \item XLIM\_NI\_SG = 5.E-14\index{XLIM\_NI\_SG!\innam{NAM\_ELEC}} max magnitude of dq for S-G non-inductive charging (C)
  \item CLSOL\index{CLSOL!\innam{NAM\_ELEC}} : Laplace equation solver for the electric field
  \item NLAPITR\_ELEC\index{NLAPITR\_ELEC!\innam{NAM\_ELEC}} : number of iterations for the electric field solver
  \item XRELAX\_ELEC\index{XRELAX\_ELEC!\innam{NAM\_ELEC}} : relaxation factor for the electric field solver
  \item XETRIG\index{XETRIG!\innam{NAM\_ELEC}} : electric field threshold (V m$^{-1}$) for lightning flash triggering
  \item XEBALANCE\index{XEBALANCE!\innam{NAM\_ELEC}} : (1-XEBALANCE) is the proportion of XETRIG over which a lightning can be triggerred to take into account the subgrid scale variability
  \item XEPROP\index{XEPROP!\innam{NAM\_ELEC}} : electric field threshold (V m$^{-1}$) for the bidirectional leader propagation
  \item XQEXCES\index{XQEXCES!\innam{NAM\_ELEC}} : charge density threshold (C m$^{-3}$) for neutralization
  \item XDFRAC\_ECLAIR\index{XDFRAC\_ECLAIR!\innam{NAM\_ELEC}} : fractal dimension of lightning flashes
  \item XDFRAC\_L\index{XDFRAC\_L!\innam{NAM\_ELEC}} : linear coefficient for the branch number
  \item XWANG\_A\index{XWANG\_A!\innam{NAM\_ELEC}} : a parameter of the Wang et al. (1998) formula for LNOx production (not yet implemented)
  \item XWANG\_B\index{XWANG\_B!\innam{NAM\_ELEC}} : b parameter of the Wang et al. (1998) formula for LNOx production (not yet implemented)
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_FMOUT (output instants)}
\index{NAM\_FMOUT!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
XFMOUT  &  array (real) &  8*192* 999.   \\
XTSTEP\_OUTPUT & real & XUNDEF \\
\hline
\end{tabular}
\end{center}

\begin{itemize}
\item
\index{XFMOUT!\innam{NAM\_FMOUT}} 
XFMOUT(m,i) is an array of increments in seconds from the beginning
of the segment to the instant where the i-th fields output on FM-files
is realized by model "m"
\index{XTSTEP\_OUTPUT!\innam{NAM\_FMOUT}} 
XTSTEP\_OUTPUT is a constant timestep (in second)  between the output files. 
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_FRC (forcing control)}
\index{NAM\_FRC!namelist description}

Application of a specific forcing is enabled by a dedicated flag. When a
Newtonian relaxation is requested, the damping time XRELAX\_TIME\_FRC and the
height (fixed or physically based) above which the forcing is applied,
XRELAX\_HEIGHT\_FRC and CRELAX\_HEIGHT\_TYPE, must be set.

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LGEOST\_UV\_FRC      & logical      & FALSE \\
LGEOST\_TH\_FRC      & logical      & FALSE \\
LTEND\_THRV\_FRC     & logical      & FALSE \\
LTEND\_UV\_FRC     & logical      & FALSE \\
LVERT\_MOTION\_FRC   & logical      & FALSE \\
LRELAX\_THRV\_FRC    & logical      & FALSE \\
LRELAX\_UV\_FRC      & logical      & FALSE \\
XRELAX\_TIME\_FRC    & real         & 10800. \\
XRELAX\_HEIGHT\_FRC  & real         & 0. \\
CRELAX\_HEIGHT\_TYPE &  character*4 & 'FIXE' \\
LTRANS               & logical      & FALSE \\
XUTRANS              & real         & 0. \\
XVTRANS              & real         & 0. \\
%LPGROUND\_FRC        & logical      & FALSE \\
\hline
\end{tabular}
\end{center}

\begin{itemize}
\item LGEOST\_UV\_FRC : flag to use a prescribed geostrophic wind.
\begin{itemize}
\item .TRUE.  to integrate a geostrophic wind with a constant Coriolis
parameter
$f=2 \times \Omega \times $SIN(XLAT0). The LCORIO flag of module MODD\_DYN
must be .TRUE.
\item .FALSE. not active
\end{itemize}
\index{LGEOST\_UV\_FRC!\innam{NAM\_FRC}}

\item LGEOST\_TH\_FRC : flag to apply a large scale horizontal advection
on the potential temperature field. The gradients result from the thermal wind
balance.
\begin{itemize}
\item .TRUE.  to integrate an horizontal advection of $\theta$.
\item .FALSE. not active
\end{itemize}
\index{LGEOST\_TH\_FRC!\innam{NAM\_FRC}}

\item LTEND\_THRV\_FRC : flag to simulate a large scale $\theta$ and
humidity tendency.
\begin{itemize}
\item .TRUE.  to integrate a tendency for $\theta$ and $r_v$.
\item .FALSE. not active
\end{itemize}
\index{LTEND\_THRV\_FRC!\innam{NAM\_FRC}}

\item LTEND\_UV\_FRC : flag to simulate a large scale wind tendency.
\begin{itemize}
\item .TRUE.  to integrate a tendency for $u$ and $v$.
\item .FALSE. not active
\end{itemize}
\index{LTEND\_UV\_FRC!\innam{NAM\_FRC}}

\item LVERT\_MOTION\_FRC : flag to simulate a large scale vertical transport
of all the prognostic fields.
\begin{itemize}
\item .TRUE.  to integrate a vertical transport with an upstream scheme.
\item .FALSE. not active
\end{itemize}
\index{LVERT\_MOTION\_FRC!\innam{NAM\_FRC}}

\item LRELAX\_THRV\_FRC : flag to apply a Newtonian relaxation on the
potential temperature and humidity fields.
\begin{itemize}
\item .TRUE.  to relax $\theta$ and $r_v$ towards large scale values.
\item .FALSE. not active
\end{itemize}
\index{LRELAX\_THRV\_FRC!\innam{NAM\_FRC}}

\item LRELAX\_UV\_FRC : flag to apply a Newtonian relaxation on each
horizontal wind component.
\begin{itemize}
\item .TRUE.  to relax the horizontal wind towards large scale values.
\item .FALSE. not active
\end{itemize}
\index{LRELAX\_UV\_FRC!\innam{NAM\_FRC}}

\item XRELAX\_TIME\_FRC : constant damping time for the forced relaxation.
\index{XRELAX\_TIME\_FRC!\innam{NAM\_FRC}}

\item XRELAX\_HEIGHT\_FRC : height above which a forced relaxation is enabled
when CRELAX\_HEIGHT\_TYPE='FIXE' or minimal height if 'THGR' is used.
\index{XRELAX\_HEIGHT\_FRC!\innam{NAM\_FRC}}

\item CRELAX\_HEIGHT\_TYPE : definition of the height above which a forced
relaxation is enabled.
\begin{itemize}
\item 'FIXE' means that a forced relaxation is never applied below
XRELAX\_HEIGHT\_FRC.
\item 'THGR' means that a forced relaxation is never applied below the maximal
height between XRELAX\_HEIGHT\_FRC and the height above which $\partial \theta
/ \partial z$ is the highest for each column.
\end{itemize}
\index{CRELAX\_HEIGHT\_TYPE!\innam{NAM\_FRC}}

\item LTRANS : flag to apply a Galilean translation of the domain 
of simulation
\begin{itemize}
\item  .TRUE. The translation speed of the domain of simulation will be 
XUTRANS,XVTRANS
\item .FALSE. : not active
\end{itemize}
\index{XVTRANS!\innam{NAM\_FRC}}
\index{XUTRANS!\innam{NAM\_FRC}}

%\item LPGROUND\_FRC : flag to simulate a time varying ground pressure.
%( WARNING: THIS FLAG CAN NOT YET BE ACTIVATED ! )
%\begin{itemize}
%\item .TRUE.  means that the ground pressure is updated if it
%varies with time in the "Free Format Forcing Part" of the  PRE\_IDEA1.nam file.
%\item .FALSE. not active
%\end{itemize}
%\index{LPGROUND\_FRC!\innam{NAM\_FRC}}
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_LBCn (boundary conditions of model n)}
\index{NAM\_LBCn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
CLBCX        &  array(2 characters) & 2*"CYCL" \\
CLBCY        &  array(2 characters) & 2*"CYCL" \\
XCPHASE      & real                 &  20.     \\
XCPHASE\_PBL & real                 &  0.      \\
XCARPKMAX    & real                 &  XUNDEF  \\
\hline
\end{tabular}
\end{center}

It contains the parameters needed to specify the lateral boundary conditions for
the model n. They are
included in the declarative module MODD\_LBCn
\begin{itemize}
\item
\index{CLBCX!\innam{NAM\_LBCn}}
CLBCX : represent the type of lateral boundary
condition at the left and right boundaries along x (CLBCX(1) and CLBCX(2)
respectively). The possible values are : 
\begin{itemize}
\item 
'CYCL' for cyclic boundary  conditions (in this case CLBCX(1)=CLBCX(2)='CYCL')
\item 
'OPEN' for open boundary condition (Sommerfeld equation for the normal velocity)
\item 
'WALL' for wall boundary   condition ( zero normal velocity )
\end{itemize}
 
\item
\index{CLBCY!\innam{NAM\_LBCn}}
CLBCY : array containing 2 elements: they represent the type of lateral boundary
condition at the left and right boundaries along y (CLBCY(1) and CLBCY(2)
respectively). The possible values are identical to those for CLBCX. 

\item
\index{XCPHASE!\innam{NAM\_LBCn}}
XCPHASE : imposed phase velocity of the outgoing gravity waves. This phase
velocity can be  used in the Sommerfeld equation which gives the temporal
evolution of the normal velosity at the open lateral boundary.  

\item
\index{XCPHASE\_PBL!\innam{NAM\_LBCn}}
XCPHASE\_PBL : imposed phase velocity of the outgoing gravity waves in the PBL. 

\item
\index{XCARPKMAX!\innam{NAM\_LBCn}}
XCARPKMAX : maximum value (in $s^{-1}$)  of the relaxation coefficient used to
relaxe the normal wind in the Carpenter equation for open lbc conditions.
If not specified,  $XCARPKMAX=1/(10.* XTSTEP)$, that is the advised value, is imposed.

\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\subsection{Namelist NAM\_LES (LES budgets)}                                          
\label{ss:LESbudget}
\index{NAM\_LES!namelist description}

This namelist controls the diagnostics of turbulence, especially
for Large Eddy Simulations. The diagnostics are saved in the
diachronic file (.000). The list of the diagnostics is given in annexe \ref{s:LESdiag} page  \pageref{s:LESdiag}.

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LLES\_MEAN                    &  logical          & .FALSE.  \\
LLES\_RESOLVED                &  logical          & .FALSE.  \\
LLES\_SUBGRID                 &  logical          & .FALSE.  \\
LLES\_UPDRAFT                 &  logical          & .FALSE.  \\
LLES\_DOWNDRAFT               &  logical          & .FALSE.  \\
LLES\_SPECTRA                 &  logical          & .FALSE.  \\
LLES\_CS\_MASK                &  logical          & .FALSE.  \\
NLES\_LEVELS                  & integer (:)       & all levels\\
XLES\_HEIGHTS                 & real (:)          & none \\
NSPECTRA\_LEVELS              & integer (:)   & none \\
XSPECTRA\_HEIGHTS             & real (:)   & none \\
%NLES\_TEMP\_SERIE\_I          & integer(:) & none \\
%NLES\_TEMP\_SERIE\_J          & integer(:) & none \\
%NLES\_TEMP\_SERIE\_Z          & real(:)    & none \\
CLES\_NORM\_TYPE              & character (len=4) & 'NONE' \\
CBL\_HEIGHT\_DEF              & character (len=3) & 'KE ' \\
XLES\_TEMP\_SAMPLING          & real              & 60 s if CTURB='3DIM' \\
                              &                   & 300 s if CTURB='1DIM' \\
XLES\_TEMP\_MEAN\_START       & real              & none \\
XLES\_TEMP\_MEAN\_END         & real              & none \\
XLES\_TEMP\_MEAN\_STEP        & real              & 3600 s \\
LLES\_CART\_MASK              & logical           & .FALSE. \\
NLES\_IINF                    & integer           & physical domain boundary (JPHEXT+1) \\
NLES\_ISUP                    & integer           & physical domain boundary (NIMAX+JPHEXT) \\
NLES\_JINF                    & integer           & physical domain boundary (JPHEXT+1) \\
NLES\_JSUP                    & integer           & physical domain boundary (NJMAX+JPHEXT) \\
LLES\_NEB\_MASK               & logical           & .FALSE. \\
LLES\_CORE\_MASK              & logical           & .FALSE. \\
LLES\_MY\_MASK                & logical           & .FALSE. \\
NLES\_MASKS\_USER             & integer           & NUNDEF \\
\hline
\end{tabular}
\end{center}

\begin{itemize}
\item
LLES\_MEAN \index{LLES\_MEAN!\innam{NAM\_LES}} : flag for computation of the
mean vertical profiles of the model variables

\item
LLES\_RESOLVED \index{LLES\_RESOLVED!\innam{NAM\_LES}}: flag for computation of the
mean vertical profiles of the resolved fluxes, variances and covariances

\item
LLES\_SUBGRID \index{LLES\_SUBGRID!\innam{NAM\_LES}}: flag for computation of the
mean vertical profiles of the subgrid fluxes, variances and covariances

\item
LLES\_UPDRAFT \index{LLES\_UPDRAFT!\innam{NAM\_LES}}: flag for computation of the
updraft vertical profiles of some resolved and subgrid fluxes,
variances and covariances

\item
LLES\_DOWNDRAFT \index{LLES\_DOWNDRAFT!\innam{NAM\_LES}} : Same as LLES\_UPDRAFT but for downdrafts.
\item
LLES\_SPECTRA \index{LLES\_SPECTRA!\innam{NAM\_LES}} : flag for computation of the
non-local diagnostics (2 points correlations and spectra)

\item
LLES\_CS\_MASK \index{LLES\_CS\_MASK!\innam{NAM\_LES}} : flag for computation of the
conditional sampling diagnostics                           
\item
NLES\_LEVELS \index{NLES\_LEVELS!\innam{NAM\_LES}}: list of model levels where the local quantities
are computed. Default is: all model levels (by default, the vertical profiles
are computed on the MESO-NH grid).

\item
XLES\_HEIGHTS \index{XLES\_HEIGHTS!\innam{NAM\_LES}}: list of constant altitude levels where
the local quantities are computed. Not used by default.

\item
NSPECTRA\_LEVELS  \index{NSPECTRA\_LEVELS!\innam{NAM\_LES}}: list of model levels where the non-local quantities
are computed. Any number is allowed, but too many will be costly
in CPU time and memory.

\item
XSPECTRA\_HEIGHTS  \index{XSPECTRA\_HEIGHTS!\innam{NAM\_LES}}: list of constant altitude levels where
the non-local quantities are computed. Any number is allowed,
but too many will be costly in CPU time and memory.

%\item
%NLES\_TEMP\_SERIE\_I  \index{NLES\_TEMP\_SERIE\_I!\innam{NAM\_LES}} : list of the I coordinates (model index) of the points where
%temporal series are extracted. Not yet implemented.
%
%\item
%NLES\_TEMP\_SERIE\_J  \index{NLES\_TEMP\_SERIE\_J!\innam{NAM\_LES}} : list of the J coordinates (model index) of the points where
%temporal series are extracted. Not yet implemented.
%
%\item
%NLES\_TEMP\_SERIE\_Z  \index{NLES\_TEMP\_SERIE\_Z!\innam{NAM\_LES}} : list of the altitudes of the points where
%temporal series are extracted. Not yet implemented.

\item
CLES\_NORM\_TYPE  \index{CLES\_NORM\_TYPE!\innam{NAM\_LES}}  : type of normalization for the fluxes and variances:
\begin{itemize}
\item 'NONE': no normalization is computed (however, the quantities necessary
to perform these are computed, and stored in the file)
\item 'CONV': convective normalization, using $Q_0$, $w_*$, $h$,
$<\overline{w'r'_v}>_{surf}$.
\item 'EKMA': Ekman normalization, using $u_*$ and $L_{Ekman}$.
\item 'MOBU': Monin-Obukhov normalization, using $L_{MO}$, $u_*$, $Q_0$,
$<\overline{w'r'_v}>_{surf}$.
\end{itemize}

\item
CBL\_HEIGHT\_DEF  \index{CBL\_HEIGHT\_DEF!\innam{NAM\_LES}}  : definition of the Boundary Layer height $h$:
\begin{itemize}
\item 'KE ': test on total   kinetic energy: $E(h) + e(h) = 
0.05 \frac{1}{h} \int_0^h{(E(z)+e(z))dz}$
\item 'WTV': test on $<w'\theta'_v + \overline{w'\theta'_v }>$: height
h where this flux is most negative.
\item 'DTH' : test on $\theta$ profile.
\end{itemize}

\item
XLES\_TEMP\_SAMPLING  \index{XLES\_TEMP\_SAMPLING!\innam{NAM\_LES}}: time (seconds) between two samplings of the
LES profiles and non-local quantities

\item
XLES\_TEMP\_MEAN\_START  \index{XLES\_TEMP\_MEAN\_START!\innam{NAM\_LES}} : time (seconds from the beginning of the simulation)
at which the averaging begins. If not defined, no averaging is performed.

\item
XLES\_TEMP\_MEAN\_END  \index{XLES\_TEMP\_MEAN\_END!\innam{NAM\_LES}}: time (seconds from the beginning of the simulation)
at which the averaging ends. If not defined, no averaging is performed.

\item
XLES\_TEMP\_MEAN\_STEP  \index{XLES\_TEMP\_MEAN\_STEP!\innam{NAM\_LES}}: time step (seconds) for averaging.                     

\item
LLES\_CART\_MASK  \index{LLES\_CART\_MASK!\innam{NAM\_LES}} : flag to compute the LES diagnostics
only inside a cartesian subdomain defined with the indexes of the model 1. Both local and non-local
quantities can be computed.

\item
NLES\_IINF \index{NLES\_IINF!\innam{NAM\_LES}} : lower i index of the cartesian subdomain. The default value is the 
physical domain left boundary.

\item
NLES\_ISUP \index{NLES\_ISUP!\innam{NAM\_LES}} : upper i index of the cartesian subdomain. The default value is the 
physical domain right  boundary.

\item
NLES\_JINF \index{NLES\_JINF!\innam{NAM\_LES}} : lower j index of the cartesian subdomain. The default value is the
physical domain bottom boundary.

\item
NLES\_JSUP\index{NLES\_JSUP!\innam{NAM\_LES}} : upper j index of the cartesian subdomain. The default value is the
physical domain top boundary.

\item
LLES\_NEB\_MASK \index{LLES\_NEB\_MASK!\innam{NAM\_LES}} : Flag to compute the LES diagnostics
separately inside and outside  the model columns where clouds
are present. Only local
quantities can be computed.

\item
LLES\_CORE\_MASK \index{NLES\_CORE\_MASK!\innam{NAM\_LES}} : Flag to compute the LES diagnostics
separately inside and outside  the model columns where cloud core is present.
Only local quantities can be computed.

\item
LLES\_MY\_MASK\index{NLES\_MY\_MASK!\innam{NAM\_LES}}: Flag to compute the LES diagnostics
on a mask defined by the user as a 2D horizontal mask.
It must be coded at the
beginning of the LES monitor routine. Only local quantities can be computed
with this mask.
\item
NLES\_MASKS\_USER \index{NLES\_MASKS\_USER!\innam{NAM\_LES}} : number of user's masks

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_LUNITn (file names)}
\index{NAM\_LUNITn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
CINIFILE   &  28 characters  &  'INIFILE'  \\
CINIFILEPGD   &  28 characters  &  ''  \\
CCPLFILE   & array (28 characters)  &  JPCPLFILEMAX*"NONE"  \\
\hline
\end{tabular}
\end{center}

It contains the names  of the different files used for the initialization of
 the model n. They are
included in the declarative module MODD\_LUNITn
\begin{itemize}
\item
\index{CINIFILE!\innam{NAM\_LUNITn}}
CINIFILE : name of the initial FM-file which contains the field values
  used as initial state in the present MESONH numerical simulation
\item
\index{CINIFILEPGD!\innam{NAM\_LUNITn}}
CINIFILEPGD : name of the PGD file  associated to the initial FM-file
\item
\index{CCPLFILE!\innam{NAM\_LUNITn}}
CCPLFILE : name of the FM-files which contains the field values used for the
coupling of the outermost MESONH model. No more than JPCPLFILEMAX=24 (for the
present version) files can be
used in a simulation. These CCPLFILE file names are only meaningful for the
outermost model which finds its boundary conditions from a previously executed 
run of Meso-NH or another model.

 {\bf No constraint are imposed on the coupling file names only that they must
be temporally ordered }

If the coupling files are given  by

\begin{tabular}{ccc}
CCPLFILE(1)= 'F\_1' & $--->$ & $t_1$ \\
CCPLFILE(2)= 'F\_2'  & $--->$ & $t_2$ \\
CCPLFILE(3)= 'A\_2'  & $--->$ & $t_3$ \\
CCPLFILE(4)= 'A\_5'  & $--->$ & $t_4$ \\
CCPLFILE(5)= 'NONE' & $--->$ &  \\
...                 & .... &  \\
CCPLFILE(8)= 'NONE' & $--->$ &  
\end{tabular} 

then, the instants must satisfy :
$$ t_{segment} \leq t_1 < t_2  < t_3  < t_4  $$

If it is not the case, the program stops. If the coupling fields are 
not time dependant, no coupling files are required because the coupling fields 
are read from the inital MESONH file of model 1 as the Larger
scale fields ( LSUM, LSVM, LSWM, LSTHM, LSRVM ). More details can be found in
the scientific documentation of the model.
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_NCOUT (netcdf output)\label{s:namncout}}
\index{NAM\_NCOUT!namelist description}

Namelist to control the generation of netcdf output files.
This namelist can only be used if the comiplation was done with the key MNH\_NCWRIT. To do so, go to src directory and do the followings:
\begin{verbatim}
export MNH_NCWRIT=MNH_NCWRIT
./configure
. ../conf/profile_mesonh
make cleanmaster (only if you have already compiled MesoNH)
make
\end{verbatim}

The netcdf files will have the same name as the lfi files but with the extension .nc
Note that additionnal netcdf files will be generated:
\begin{itemize}
\item       *sf1.nc and *sf2.nc which contain all the surface variables
\item       *ser.nc  which contains all the series variables
\item       *phy.nc which contains all the variables written in phys\_param.f90
\end{itemize}
Finally, for NCL users, you can find examples on the MesoNH website
 (http://mesonh.aero.obs-mip.fr/mesonh/, "Use
NCL" tab,  in section "9. NCL scrtips for MNH-V4-9-1-0-NETCDF-branch" )
Get the file ncl\_for\_netcdf\_branch.tar . It contains several examples.


\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
 LNETCDF & logical  &  FALSE  \\
 LLFIFM&  logical & TRUE \\
\hline
\end{tabular}
\end{center}


\begin{itemize}
\item
\index{LNETCDF!\innam{NAM\_NCOUT}} 
LNETCDF : TRUE  netcdf output files will be generated
\item
\index{LLFIFM!\innam{NAM\_NCOUT}} 
LLFIFM      : FALSE  no lfi output files will be generated. Works only in DIAG1.nam 
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_NESTING (grid nesting configuration)}

\index{NAM\_NESTING!namelist description}
\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
NDAD  &  array (8 real) &  m-1   \\
NDTRATIO & array (8 integer) & 1 \\
XWAY & array (8 real) & 2 \\
\hline
\end{tabular}
\end{center}

\begin{itemize}
\item
\index{NDAD!\innam{NAM\_NESTING}}  
NDAD(m) : is the model number of the father of each model "m"
\item
\index{NDTRATIO!\innam{NAM\_NESTING}}
NDTRATIO(m) : is the ratio between time step of model m and its father NDAD(m)
\item
\index{XWAY!\innam{NAM\_NESTING}} 
XWAY(m) : is the interactive nesting level for model m and its father NDAD(m)
\begin{itemize}
\item 1 one-way interactions
\item 2 two-way interactions : upward information are given to the father (also for 2D fields (Surface precipitation and
shirt wave radiative fluxes) that are used by the surface (corresponding previously to $XWAY=3$ in masdev4\_7)). 
\end{itemize}
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_NUDGINGn (nudging of model n)}
\index{NAM\_NUDGINGn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LNUDGING   &  logical & .FALSE. \\
XTNUDGING  &  real    &  21600. \\
\hline
\end{tabular}
\end{center}

It contains the parameters needed for nudging of U,V,W,TH,Rv fields of model n
towards large scale values. They are
included in the declarative module MODD\_NUDGINGn
\begin{itemize}
\item
\index{LNUDGING!\innam{NAM\_NUDGINGn}}
LNUDGING : flag to activate nudging for model n.
\item
\index{XTNUDGING!\innam{NAM\_NUDGINGn}}
XTNUDGING : time scale for nudging towards Large Scale values.
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_PARAMn (parameterizations' names of model n)}
\index{NAM\_PARAMn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
CTURB   &  4 characters  & 'NONE'   \\
CRAD    &  4 characters  & 'NONE'   \\
CCLOUD  &  4 characters  & 'NONE'   \\
CDCONV  &  4 characters  & 'NONE'   \\
CSCONV  &  4 characters  & 'NONE'   \\
CACTCCN &  4 characters  & 'NONE'   \\
\hline
\end{tabular}
\end{center}

It contains the different types of parameterizations used by the model n. They are
included in the declarative module MODD\_PARAMn. 
\begin{itemize}
\item
\index{CTURB!\innam{NAM\_PARAMn}}
CTURB :  type of turbulence scheme used to parameterize the transfers from
unresolved scales to resolved scales.
\begin{itemize}
\item
CTURB = 'NONE' : no turbulence scheme.
\item
CTURB = 'TKEL' : turbulence scheme with a one and a half  order closure
 (i.e.
 prognostic turbulent kinetic energy (TKE) and diagnostic mixing length).
\end{itemize}
 
\item
\index{CRAD!\innam{NAM\_PARAMn}}
CRAD  :  type of radiative transfer scheme used to parameterize the
effects of the solar and infrared radiations.
\begin{itemize}
\item
CRAD = 'NONE' then the downward surface fluxes are set to zero
\item
CRAD = 'TOPA' : the solar flux is equal to the one at TOP of Atmosphere. The infra-red flux is equal to 300 $Wm^{-2}$.
\item
CRAD = 'FIXE' then the daily evolutions of the downward surface
fluxes are prescribed. The temporal evolution is done in the routine
PHYS\_PARAMn by fixing the hourly value of the infrared and solar
fluxes and can be modified for personnal application.
\item
CRAD = 'ECMW' the ECMWF radiation scheme code is used.
\item 
CRAD = 'ECRA' the ECRAD radiation scheme code is used.
\end{itemize} 

\item
\index{CCLOUD!\innam{NAM\_PARAMn}}
CCLOUD : type of the microphysical scheme used to parameterize the different 
water phases' transformations.
\begin{itemize}
\item
CCLOUD = 'NONE' no microphysical scheme is used. You can still use water vapor if
you want (LUSERV= TRUE or FALSE)
\item
CCLOUD = 'REVE' only the saturation adjustment is used to create
cloud water. This liquid water is never transformed 
in rain water. 
\item
CCLOUD = 'KESS' a warm Kessler microphysical scheme is used. It allows 
transformations between the  3 classes of water: vapor, cloud water and rain.
\item
CCLOUD = 'C2R2' a 2-moment warm microphysical scheme according to Cohard and Pinty (2000).
\item 
CCLOUD =  'KHKO' a 2-moment warm microphysical scheme for LES of Stratocumulus
according to Khairoudinov and Kogan (2000).
\item 
CCLOUD =  'ICE3' a mixed microphysical scheme including ice, 
snow, and graupel (6 classes of hydrometeors).
\item 
CCLOUD =  'LIMA' a mixed  2-moment microphysical scheme  (6 classes of hydrometeors ).
\item 
CCLOUD =  'ICE4' same as ICE3 but with hail (7 classes of hydrometeors).                     
\end{itemize}

\item
\index{CDCONV!\innam{NAM\_PARAMn}}
CDCONV :  type of deep convection scheme used to parameterize
the effects of unresolved convective clouds.
\begin{itemize}
\item
CDCONV = 'NONE'  : no convection scheme.                            
\item
CDCONV = 'KAFR'  : Kain-Fritsch-Bechtold scheme.
\end{itemize}

\item
\index{CSCONV!\innam{NAM\_PARAMn}}
CSCONV : type of shallow convection scheme used to parameterize
the effects of unresolved shallow convective clouds.
\begin{itemize}
\item
CSCONV = 'NONE'  : no convection scheme.                            
\item
CSCONV = 'KAFR'  : Kain-Fritsch-Bechtold scheme.
\item
CSCONV = 'EDKF'  : Eddy-Diffusivity-Kain-Fritsch scheme (according to Pergaud et al., 2008).
Can only be used with $CTURB='TKEL'$.
\end{itemize}

\item
\index{CACTCCN!\innam{NAM\_PARAMn}}
CACTCCN :  type of CCN activation scheme 
\begin{itemize}
\item
CACTCCN = 'NONE'  : no CCN activation scheme.                            
\end{itemize}

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{ Namelist NAM\_PARAM\_C2R2 (control variable of the 2-moment 
warm microphysical schemes C2R2 and KHKO)}
\index{NAM\_PARAM\_C2R2!namelist description}

\begin{center}
\begin{tabular}{|l|l|l| }
\hline 
 Fortran name & Fortran type  & default value \\
\hline
HPARAM\_CCN\ & character (LEN=3) & 'XXX' \\
HINI\_CCN\   & character (LEN=3) & 'XXX' \\
HTYPE\_CCN\  & character (LEN=1) &  'X'  \\
XCHEN\ & real & 0.0 \\
XKHEN\ & real & 0.0 \\
XMUHEN\ & real & 0.0 \\
XBETAHEN\ & real & 0.0 \\
XCONC\_CCN\ & real & 0.0 \\
XR\_MEAN\_CCN\ & real & 0.0 \\
XLOGSIG\_CCN\ & real & 0.0 \\
XFSOLUB\_CCN\ & real & 1.0 \\
XACTEMP\_CCN\ & real & 280.0 \\
XALPHAC\ & real & 3.0 \\
XNUC\ & real & 1.0 \\
XALPHAR\ & real & 1.0 \\
XNUR\ & real & 2.0 \\
LRAIN\ & boolean & TRUE \\
LSEDC\ & boolean & TRUE \\
LACTIT\ & boolean & FALSE \\
LSUPSAT\ & boolean & FALSE \\
LDEPOC\ & boolean & FALSE \\
XVDEPOC& real & 0.02 \\
LACTTKE\ & boolean & TRUE \\
\hline
\end{tabular}
\end{center}

It contains the control parameters for the C2R2 warm microphysical
scheme. They are in the declarative module MODD\_PARAM\_C2R2.
\begin{itemize}
\item HPARAM\_CCN: Acronym of the CCN activation parameterization to use ('CPB',
'TFH' or 'TWO'). The 'TFH' and 'TWO' need only to prescribe the XCHEN and XKHEN
 parameters.
\begin{itemize}
\item 'TWO' refers to the classical activation spectrum of Twomey
in the form $N_{CCN}(s)= C s^k$
\item 'TFH' includes some improvements brought by Feingold and Heymsfield
(JAS, 1992) to the original activation spectrum of Twomey.
\item 'CPB' refers to an activation spectrum in the form defined in Cohard et 
al. (JAS, 1998) with 
$N_{CCN}(s)= C s^k F(\mu,\frac{\displaystyle{k}}{\displaystyle{2}},
                  \frac{\displaystyle{k}}{\displaystyle{2}}+1;-\beta s^2)$,
where F is the hypergeometric function and $[C, k, \mu, \beta]$, four adjustable
 coefficients,
\end{itemize}
\item HINI\_CCN: If HPARAM\_CCN='CPB' then the initial CCN characteristics are
given in the 'CCN' or 'AER' format. In the 'CCN' case, the parameters XCHEN,
XKHEN, XMUHEN and XBETAHEN must be given while it is the case for XCONC\_CCN,
XR\_MEAN\_CCN, XLOGSIG\_CCN, XFSOLUB\_CCN and XACTEMP\_CCN if the 'AER' option is 
chosen. 
\begin{itemize}
\item 'CCN' The aerosols are directly characterized by their activation spectrum $N_{CCN}(s)$ in the form $C s^k$ or $C s^k F(\mu,\frac{\displaystyle{k}}{\displaystyle{2}},
                  \frac{\displaystyle{k}}{\displaystyle{2}}+1;-\beta s^2)$.
\item 'AER' The aerosols are particles which are characterized by a lognormal 
distribution law in the form: 
${\displaystyle N}/{\displaystyle {\sqrt {2 \pi}} {\rm ln}(\sigma)}
      exp \Big ( - {\displaystyle {\rm ln} (r/\overline{r})^2}/
                   {\displaystyle 2 {\rm ln}(\sigma)^2} \Big )$, with
distribution parameters ($\overline{r}$ is the geometric mean radius, $\sigma$
the geometric standard deviation and $N$ the total particle number), by their
solubility ($\epsilon_m$) and by their activation temperature ($T$) as 
described by Cohard et al. (JGR, 2000).
\end{itemize}
\item HTYPE\_CCN: Aerosol type ('M' or 'C') if HPARAM\_CCN=='CPB' and 
HINI\_CCN=='AER' is chosen.
\begin{itemize}
\item 'M': NaCl composition (large size maritime aerosols)
\item 'C': (NH$_4)_2$SO$_4$ composition (small size continental aerosols)
\end{itemize}
\item XCHEN:$C$ parameter  in the generic activation spectrum $N_{CCN}(s)$
\item XKHEN:  $k$ parameter in the generic activation spectrum $N_{CCN}(s)$
\item XMUHEN:  $\mu$ parameter in the hypergeometric function of the CPB form
of the activation spectrum $N_{CCN}(s)$
\item XBETAHEN:  $\beta$ parameter in the hypergeometric function of the CPB form
of the activation spectrum $N_{CCN}(s)$
\item XCONC\_CCN: aerosol concentration number ($N$)
\item XR\_MEAN\_CCN: geometric mean radius of the aerosol distribution ($\overline{r}$)
\item XLOGSIG\_CCN: natural logarithm of the geometric standard deviation of 
the aerosol distribution (${\rm ln}(\sigma)$)
\item XFSOLUB\_CCN: Mean solubility of the aerosols ($\epsilon_m$)
\item XACTEMP\_CCN: Mean air temperature at which activation will occur.
\item XALPHAC: First dispersion parameter ($\alpha_c$) of the 
$\gamma$-distribution law of the cloud droplets
($\gamma_c (D)=\frac{\displaystyle{\alpha_c}}{\displaystyle{\Gamma(\nu_c)}}
\lambda_c^{\alpha_c \nu_c} D ^{\alpha_c \nu_c -1} exp\big(-(\lambda_c D)^{\alpha_c}\big)$)
\item XNUC: Second dispersion parameter ($\nu_c$) of the $\gamma$-distribution
law of the cloud droplets
\item XALPHAR: First dispersion parameter ($\alpha_r$) of the 
$\gamma$-distribution law of the rain drops
($\gamma_r (D)=\frac{\displaystyle{\alpha_r}}{\displaystyle{\Gamma(\nu_r)}}
\lambda_r^{\alpha_r \nu_r} D ^{\alpha_r \nu_r -1} exp\big(-(\lambda_r D)^{\alpha_r}\big)$)
\item XNUR: Second dispersion parameter ($\nu_r$) of the $\gamma$-distribution
law of the rain drops
\item LRAIN: Enables the rain formation (by cloud droplet autoconversion) if set to TRUE
\item LSEDC: Cloud droplets are allowed to sediment if set to TRUE
\item LACTIT: Activation by radiative cooling is taken into account if set to  TRUE
\item LSUPSAT : Pseudo-prognostic supersaturation according to Thouron et al.(2012) taken into account if set to  TRUE
\item LDEPOC : TRUE to enable cloud droplet deposition
\item XVDEPOC : Droplet deposition velocity
\item LACTTKE : TRUE to take into account TKE in the calculation of vertical velocity for activation
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_PARAM\_ECRADn} 
\index{NAM\_PARAM\_ECRADn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
NSWSOLVER & integer& 0\\
NLWSOLVER & integer& 0\\
NGAS & integer& \\
NLIQOPT & integer&3\\
NICEOPT & integer&3 \\
NOVLP & integer& 1\\
NRADLP & integer& 1\\
NRADIP & integer&1 \\
NREG & integer& 3\\
XCLOUD\_FRAC\_STD & real &1.0\\
NLWSCATTERING & integer&2 \\
NAREMACC& integer&0 \\
\hline
\end{tabular}
\end{center}
It contains the options for the ECRAD radiative scheme.
\begin{itemize}
\item NSWSOLVER : SW solver. The possible values are 0 for 'McICA' , 1 for 'SPARTACUS' and 2 for 'SPARTACUS' with 3D effects
 \index{NSWSOLVER!\innam{NAM\_PARAM\_ECRADn}}
\item NLWSOLVER : LW solver. The possible values are 0 for 'McICA' , 1 for 'SPARTACUS' and 2 for 'SPARTACUS' with 3D effects
 \index{NLWSOLVER!\innam{NAM\_PARAM\_ECRADn}}
\item NGAS : gas model 1 = 'Monochromatic', 2 = 'RRTMG-IFS', 3 = 'RRTMG-PSRAD'
 \index{NGAS!\innam{NAM\_PARAM\_ECRADn}}
\item NLIQOPT: optical properties of liquid particles ; 2 = Slingo ; 3 = SOCRATES
 \index{NLIQOPT!\innam{NAM\_PARAM\_ECRADn}}
\item NICEOPT: optical properties of liquid particles ; 3 = Fu ; 4 = Baran
 \index{NICEOPT!\innam{NAM\_PARAM\_ECRADn}}
\item NOVLP :  overlap assumption ; 0= 'Max-Ran' ; 1= 'Exp-Ran'; 2 = 'Exp-Exp'
 \index{NOVLP!\innam{NAM\_PARAM\_ECRADn}}
\item NRADLP: 0: ERA-15, 1: Zhang and Rossow, 2: Martin (1994), 3: Martin (1994) and Woods (2000)

 \index{NRADLP!\innam{NAM\_PARAM\_ECRADn}}
\item NRADIP: 0: 40 mum, 1: Liou and Ou (1994), 2: Liou and Ou (1994) improved, 3: Sun and Rikus (1999)
 \index{NRADIP!\innam{NAM\_PARAM\_ECRADn}}
\item NREG : Number of regions for Triple Clouds
 \index{NREG!\innam{NAM\_PARAM\_ECRADn}}
\item XCLOUD\_FRAC\_STD :  Cloud water content horizontal fractional standard deviation in a gridbox
 \index{XCLOUD\_FRAC\_STD!\innam{NAM\_PARAM\_ECRADn}}
\item NLWSCATTERING:longwave scattering
\begin{itemize}
\item 0: No longwave scattering
\item 1: Longwave scattering by clouds only
\item 2: Longwave scattering by clouds and aerosols
\end{itemize}

 \index{NLWSCATTERING!\innam{NAM\_PARAM\_ECRADn}}
\item NAREMACC :  Use of Tegen (0) or MACC (1) aerosol classification(that is over 6 or 12 aerosols species)

 \index{NAREMACC!\innam{NAM\_PARAM\_ECRADn}}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Namelist NAM\_PARAM\_ICE (option for the mixed phase cloud 
parameterization ICE3 and ICE4)}
\index{NAM\_PARAM\_ICE!namelist description}
%
\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LWARM         &  logical     & .TRUE. \\
CPRISTINE\_ICE & 4 characters & 'PLAT' \\
LSEDIC & logical & FALSE \\
CSEDIM & 4 characters & 'SPLI' \\
LCONVHG       &  logical     & .FALSE. \\
LDEPOSC& logical & FALSE \\
XVDEPOSC& real & 0.02 \\
\hline
\end{tabular}
\end{center}

It contains the options for the mixed phase cloud parameterizations
used  by the model (ICE3 or ICE4). They are included in the declarative module
MODD\_PARAM\_ICE

\begin{itemize}
\item
LWARM \index{LWARM!\innam{NAM\_PARAM\_ICE}}: When .TRUE. activates the
formation of rain by the warm microphysical processes

\item
CPRISTINE\_ICE \index{CPRISTINE\_ICE!\innam{NAM\_PARAM\_ICE}}:
Pristine ice crystal type
\begin{itemize}
\item{'PLAT'} : plates 
\item{'COLU'} : columns
\item{'BURO'} : bullet rosettes
\end{itemize}

\item
LSEDIC \index{LSEDIC!\innam{NAM\_PARAM\_ICE}}:
Cloud droplets are allowed to sediment if set to TRUE
\item
CSEDIM (new in masdev48) \index{CSEDIM!\innam{NAM\_PARAM\_ICE}}:
Sedimentation algorithm type
\begin{itemize}
\item{'SPLI'} : Splitting method (original one)
\item{'STAT'} : Statistic method (accordingly to Bouteloup and Seity in AROME) 
\end{itemize}

\item
LCONVHG \index{LCONVHG!\innam{NAM\_PARAM\_ICE}}: For ICE4, .TRUE. activates the
reconversion of hail to graupel for low values of supercooled cloud water or hail contents.

\item
LDEPOSC \index{LDEPOSC!\innam{NAM\_PARAM\_ICE}}: TRUE to enable cloud droplet deposition

\item
XVDEPOSC \index{XVDEPOSC!\innam{NAM\_PARAM\_ICE}}: Droplet deposition velocity

\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_PARAM\_KAFRn (options for the Kain-Fritsch-Bechtold convective
scheme of model n)}

\index{NAM\_PARAM\_KAFRn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
XDTCONV      &  real         & MAX(300.0,XTSTEP) \\
NICE         &  integer      &   1               \\
LREFRESH\_ALL&  logical      &   TRUE            \\
LCHTRANS     &  logical      &   FALSE           \\
LDOWN        &  logical      &   TRUE            \\
LSETTADJ     &  logical      &   FALSE           \\
XTADJD       &  real         &   3600            \\
XTADJS       &  real         &  10800            \\
LDIAGCONV    &  logical      &   FALSE           \\
NENSM        &  integer      &     0             \\
\hline
\end{tabular}
\end{center}

It contains the options  for the Kain-Fritsch-Bechtold convection scheme (deep or shallow), used
by the  model n. They are included in the declarative module
MODD\_PARAM\_KAFRn.
\begin{itemize}
\item
\index{XDTCONV!\innam{NAM\_PARAM\_KAFRn}}
XDTCONV : timestep for the call of the convective scheme. Maximum value is 300s. 
\item
\index{NICE!\innam{NAM\_PARAM\_KAFRn}}
NICE : flag to include ice proceses in convection scheme
( 1 = yes, 0 = no ice )
\item
\index{LREFRESH\_ALL!\innam{NAM\_PARAM\_KAFRn}}
LREFRESH\_ALL : flag to refresh convective columns at every call of the
convection scheme.
\item
\index{LCHTRANS!\innam{NAM\_PARAM\_KAFRn}}
LCHTRANS: flag to take into account the convective transport for
scalar variables (chemical variables, passive pollutants ...).
Can only be used with the options CDCONV='KAFR'.
\item
\index{LDOWN!\innam{NAM\_PARAM\_KAFRn}}
LDOWN : flag to use downdrafts in deep convection.
\item
\index{LSETTADJ!\innam{NAM\_PARAM\_KAFRn}}
LSETTADJ : flag to allow user to define adjustment time.
\item
\index{XTADJD!\innam{NAM\_PARAM\_KAFRn}}
XTADJD : deep convective adjustment time (if LSETTADJ=TRUE).
\item
\index{XTADJS!\innam{NAM\_PARAM\_KAFRn}}
XTADJS : shallow convective adjustment time (if LSETTADJ=TRUE).
\item
\index{LDIAGCONV!\innam{NAM\_PARAM\_KAFRn}}
LDIAGCONV : flag to store diagnostic variables in module MODD\_DEEP\_CONVECTIONn:
(CAPE, deep and shallow convective cloud top and base levels, up-and downdraft mass fluxes)
\item
\index{NENSM!\innam{NAM\_PARAM\_KAFRn}}
NENSM : number of additional convective ensemble members for deep convection
(for the moment limited to 3)
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_PARAM\_LIMA (option for the 2 moment cloud 
parameterization LIMA)}
\index{NAM\_PARAM\_LIMA!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LCOLD         &  logical     & .TRUE. \\
LNUCL & logical	  &  .TRUE. \\
LSEDI &  logical&  .FALSE. \\
LSNOW & logical  &  .TRUE.\\
LHAIL &  logical& .FALSE. \\
LHHONI & logical &  .TRUE.\\
LMEYERS & logical   & .FALSE. \\
NMOD\_IFN & integer   & 1  \\
XIFN\_CONC & real & 100.  \\
LIFN\_HOM & logical & .TRUE.  \\
CIFN\_SPECIES & 8 characters   & 'PHILLIPS' \\
CINT\_MIXING &8 characters  & 'DM2     ' \\
NMOD\_IMM & integer &0  \\
NIND\_SPECIE & integer & 1 \\
CPRISTINE\_ICE\_LIMA & 4 characters &  'PLAT' \\
XFACTNUC\_DEP & real  & 1. \\
XFACTNUC\_CON & real & 1. \\
NPHILLIPS & integer  & 8 \\
LWARM & logical  & .TRUE. \\
LACTI& logical  & .TRUE. \\
LRAIN& logical  & .TRUE. \\
LSEDC& logical  & .FALSE. \\
LACTIT& logical  & .FALSE. \\
NMOD\_CCN & integer   & 1  \\
XCCN\_CONC & real & 300.  \\
LCCN\_HOM & logical & .TRUE.  \\
CCCN\_MODES &  8 characters & 'COPT    '  \\
HINI\_CCN & 3 characters  & 'AER' \\
HTYPE\_CCN & character & 'M'  \\
XALPHAC & real & 3.  \\
XNUC & real  & 1.  \\
XALPHAR &  real& 1. \\
XNUR & real  & 2. \\
XFSOLUB\_CCN & real & 1.  \\
XACTEMP\_CCN & real  & 280. \\
LSCAV & logical  & .FALSE.  \\
LAERO\_MASS & logical  & .FALSE.  \\
LACTTKE & logical  & .TRUE.  \\
LPTSPLIT & logical  & .FALSE.  \\
LFEEDBACKT & logical  & .TRUE.  \\
NMAXITER & integer & 1 \\
XMRSTEP&real& 0. \\
XTSTEP\_TS&real&0.\\
\hline
\end{tabular}
\end{center}
It contains the options for the 2 moment mixed phase cloud parameterizations
used  by the model (LIMA). They are included in the declarative module
MODD\_PARAM\_LIMA
\begin{itemize}
\item
\index{LCOLD!\innam{NAM\_PARAM\_LIMA}}
LCOLD : Switch to activate the cold phase representation
\item
\index{LNUCL!\innam{NAM\_PARAM\_LIMA}}
LNUCL : Switch to activate pristine ice crystals nucleation (both from IFN and homogeneous freezing)
\item
\index{LSEDI!\innam{NAM\_PARAM\_LIMA}}
LSEDI : Switch to activate the sedimentation of pristine ice crystals
\item
\index{LSNOW!\innam{NAM\_PARAM\_LIMA}}
LSNOW : Switch to activate the representation of rimed and aggregated ice particles
\item
\index{LHAIL!\innam{NAM\_PARAM\_LIMA}}
LHAIL : Switch to activate the representation of hail
\item
\index{LHHONI!\innam{NAM\_PARAM\_LIMA}}
LHHONI : Switch to activate CCN homogeneous freezing
\item
\index{LMEYERS!\innam{NAM\_PARAM\_LIMA}}
LMEYERS : Switch to activate the ice nucleation parameterization by Meyers (1992) instead of using the IFN
\item
\index{NMOD\_IFN!\innam{NAM\_PARAM\_LIMA}}
NMOD\_IFN : Number of IFN modes
\item
\index{XIFN\_CONC!\innam{NAM\_PARAM\_LIMA}}
XIFN\_CONC : Initial reference number concentration for each IFN mode (\verb?#/L?)
\item
\index{LIFN\_HOM!\innam{NAM\_PARAM\_LIMA}}
LIFN\_HOM : If set to true, the initial concentration of IFN is homogeneous on the vertical. If set to false, the IFN concentration is equal to the reference value XIFN\_CONC below 1000m and exponentially decreasing above.
\item
\index{CIFN\_SPECIES!\innam{NAM\_PARAM\_LIMA}}
CIFN\_SPECIES : String to select the proportion of each IFN type in each IFN mode.Possible values :
\begin{itemize}
\item 'DM1' pure small dust particles
\item 'DM2' pure large dust particles
\item 'BC'  pure black carbon
\item 'O'   pure organics
\item 'DEFAULT' mix as in Phillips et al 2008 or 2013
\end{itemize}
\item
\index{NMOD\_IMM!\innam{NAM\_PARAM\_LIMA}}
NMOD\_IMM :Number of coated IFN modes
\item
\index{NIND\_SPECIE!\innam{NAM\_PARAM\_LIMA}}
NIND\_SPECIE : Type of the coated IFN mode
\item
\index{CPRISTINE\_ICE\_LIMA!\innam{NAM\_PARAM\_LIMA}}
CPRISTINE\_ICE\_LIMA : Select the shape of pristine ice ('PLAT', 'COLU' or 'BURO' )
\item
\index{XFACTNUC\_DEP!\innam{NAM\_PARAM\_LIMA}}
XFACTNUC\_DEP : Amplification factor for IN nucleation by deposition (only used if LMEYERS=T)
\item
\index{XFACTNUC\_CON!\innam{NAM\_PARAM\_LIMA}}
XFACTNUC\_CON : Amplification factor for IN  nucleation by contact (only used if LMEYERS=T)
\item
\index{NPHILLIPS!\innam{NAM\_PARAM\_LIMA}}
NPHILLIPS : Version of the Phillips parameterization : 8 for the 2008 paper ; 13 for the 2013 paper
\item
\index{LWARM!\innam{NAM\_PARAM\_LIMA}}
LWARM : Switch to activate the representation of warm phase
\item
\index{LACTI!\innam{NAM\_PARAM\_LIMA}}
LACTI : Switch to activate the CCN activation 
\item
\index{LRAIN!\innam{NAM\_PARAM\_LIMA}}
LRAIN : Switch to activate the rain formation

\item
\index{LSEDC!\innam{NAM\_PARAM\_LIMA}}
Switch to activate the cloud droplets sedimentation
LSEDC : 
\item
\index{LACTIT!\innam{NAM\_PARAM\_LIMA}}
LACTIT : Switch to activate the representation of radiative cooling in the diagnostic maximum supersaturation computation
\item
\index{NMOD\_CCN!\innam{NAM\_PARAM\_LIMA}}
NMOD\_CCN : Number of CCN modes
\item
\index{XCCN\_CONC!\innam{NAM\_PARAM\_LIMA}}
XCCN\_CONC : Reference concentration for each CCN mode (\verb?#/cm3?)
\item
\index{LCCN\_HOM!\innam{NAM\_PARAM\_LIMA}}
LCCN\_HOM : If set to true, the initial concentration of CCN is homogeneous on the vertical. If set to false, the CCN concentration is equal to the reference value XCCN\_CONC below 1000m and exponentially decreasing above.
\item
\index{CCCN\_MODES!\innam{NAM\_PARAM\_LIMA}}
CCCN\_MODES : Select the size distribution of CCN modes ('JUNGFRAU','COPT','MACC','MACC\_JPP','SIRTA','CPS00','DEFAULT')
\item
\index{HINI\_CCN!\innam{NAM\_PARAM\_LIMA}}
HINI\_CCN : Switch to use aerosols as CCN or to describe directly the CCN activation spectrum : 'AER' (use aerosols) or 'CCN' (use the CCN activation spectrum directly)
\item
\index{HTYPE\_CCN!\innam{NAM\_PARAM\_LIMA}}
HTYPE\_CCN : Switch to affect maritime or continental activation properties to each CCN mode : 'C' continental or 'M' maritim
\item
\index{XALPHAC,XNUC!\innam{NAM\_PARAM\_LIMA}}
XALPHAC,XNUC : Droplets size distribution parameter
\item
\index{XALPHAR,XNUR!\innam{NAM\_PARAM\_LIMA}}
XALPHAR,XNUR : Rain size distribution parameter
\item
\index{XFSOLUB\_CCN!\innam{NAM\_PARAM\_LIMA}}
XFSOLUB\_CCN : Fractionnal solubility of the CCN
\item
\index{XACTEMP\_CCN!\innam{NAM\_PARAM\_LIMA}}
XACTEMP\_CCN : Expected temperature of CCN activation
\item
\index{LSCAV!\innam{NAM\_PARAM\_LIMA}}
LSCAV :Switch to activate below cloud scavenging of aerosols by rain
\item
\index{LAERO\_MASS!\innam{NAM\_PARAM\_LIMA}}
LAERO\_MASS : Switch to track the mass of scavenged aerosols
\item LACTTKE :  flag to use TKE in the CCN activation formulation
\index{LACTTKE!\innam{NAM\_PARAM\_LIMA}}
\item LPTSPLIT : flag to Activate the time-splitting scheme
\index{LPTSPLIT!\innam{NAM\_PARAM\_LIMA}}
\item LFEEDBACKT : Flag to Recompute tendencies if temperature reaches 0 (for the time-splitting scheme)
\index{LFEEDBACKT!\innam{NAM\_PARAM\_LIMA}}
\item NMAXITER : Maximum number of iterations (for the time-splitting scheme)
\index{NMAXITER!\innam{NAM\_PARAM\_LIMA}}
\item XMRSTEP : Recompute tendencies if any mixing ratio changes by more than XMRSTEP (0=no limit) (for the time-splitting scheme)
\index{XMRSTEP!\innam{NAM\_PARAM\_LIMA}}
\item XTSTEP\_TS : Maximum length of sub-time-steps (for the time-splitting scheme)
\index{XTSTEP\_TS!\innam{NAM\_PARAM\_LIMA}}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_PARAM\_MFSHALLn (options for the Mass Flux shallow convective
scheme of model n)}

\index{NAM\_PARAM\_MFSHALLn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
XIMPL\_MF      &  real         &   1        \\
CMF\_UPDRAFT   &  4 characters &   'EDKF'   \\
CMF\_CLOUD     &  4 characters &   'DIRE'   \\
LMIXUV         &  Logical      &    TRUE    \\ 
LMF\_FLX       &  Logical      &    FALSE   \\
XALP\_PERT     &  real         &    0.3     \\
XABUO          &  real         &    1.      \\
XBENTR         &   real        &    1.      \\
XBDETR         &  real         &    0.      \\
XCMF           &  real         &    0.065   \\
XENTR\_MF      &  real         &    0.035   \\
XCRAD\_MF      &  real         &    50.     \\
XENTR\_DRY     &  real         &    0.55    \\
XDETR\_DRY     &  real         &    10.     \\
XDETR\_LUP     &  real         &    1.      \\
XKCF\_MF       &  real         &    2.75    \\
XKRC\_MF       &  real         &    1.      \\
XTAUSIGMF      &  real         &    600.    \\
XPRES\_UV      &  real         &    0.5     \\
XALPHA\_MF     &  real         &    2.      \\
XSIGMA\_MF     &  real         &    20.     \\
XFRAC\_UP\_MAX &  real         &    0.33    \\
XA1            &  real         &    2./3.   \\
XB             &  real         &    0.002   \\
XC             &  real         &    0.012   \\
XBETA1         &  real         &    0.9     \\

\hline

\end{tabular}
\end{center}

It contains the options retained for the EDKF shallow convection scheme, used
by the  model n. They are included in the declarative module
MODD\_PARAM\_MFSHALLn. Contrary to the KAFR scheme,
EDKF can only be called  every time step. 

\begin{itemize}
\item
\index{XIMPL\_MF!\innam{NAM\_PARAM\_MFSHALLn}}
XIMPL\_MF : Degree of implicitness                                                        
\item
\index{CMF\_UPDRAFT!\innam{NAM\_PARAM\_MFSHALLn}}
CMF\_UPDRAFT : Type of Mass Flux Scheme                              
('EDKF' or 'NONE' or 'RHCJ')
\item
\index{CMF\_CLOUD!\innam{NAM\_PARAM\_MFSHALLn}}
CMF\_CLOUD : Type of statistical cloud                                 
('DIRE' for the direct calculation of the cloud fraction as a function of the updraft fraction 
or 'STAT' given by the subgrid condensation scheme )
\item
\index{LMIXUV!\innam{NAM\_PARAM\_MFSHALLn}}
LMIXUV: flag to take into account the mixing on momentum      
\item
\index{LMF\_FLX!\innam{NAM\_PARAM\_MFSHALLn}}
LMF\_FLX: flag to compute and store the mass fluxes on every synchronous output  file
\item
\index{XALP\_PERT!\innam{NAM\_PARAM\_MFSHALLn}}
XALP\_PERT : coefficient for the perturbation of theta\_l and r\_t at the first level of the updraft
\item
\index{XABUO!\innam{NAM\_PARAM\_MFSHALLn}}
XABUO : coefficient of the buoyancy term in the w\_up equation
\item
\index{XBENTR!\innam{NAM\_PARAM\_MFSHALLn}}
XBENTR : coefficient of the entrainment term in the w\_up equation
\item
\index{XBDETR!\innam{NAM\_PARAM\_MFSHALLn}}
XBDETR : coefficient of the detrainment term in the w\_up equation
\item
\index{XCMF!\innam{NAM\_PARAM\_MFSHALLn}}
XCMF :coefficient for the mass flux at the first level of the updraft (closure)

\item
\index{XENTR\_MF!\innam{NAM\_PARAM\_MFSHALLn}}
XENTR\_MF : entrainment constant (m/Pa)
\item
\index{XCRAD\_MF!\innam{NAM\_PARAM\_MFSHALLn}}
XCRAD\_MF : cloud radius in cloudy part
\item
\index{XENTR\_DRY!\innam{NAM\_PARAM\_MFSHALLn}}
XENTR\_DRY : coefficient for entrainment in dry part
\item
\index{XDETR\_DRY!\innam{NAM\_PARAM\_MFSHALLn}}
XDETR\_DRY : coefficient for detrainment in dry part
\item
\index{XDETR\_LUP!\innam{NAM\_PARAM\_MFSHALLn}}
XDETR\_LUP : coefficient for detrainment in dry part
\item
\index{XKCF\_MF!\innam{NAM\_PARAM\_MFSHALLn}}
XKCF\_MF : coefficient for cloud fraction
\item
\index{XKRC\_MF!\innam{NAM\_PARAM\_MFSHALLn}}
XKRC\_MF : coefficient for convective rc
%\item
\index{XTAUSIGMF!\innam{NAM\_PARAM\_MFSHALLn}}
%XTAUSIGMF : 
\item
\index{XPRES\_UV!\innam{NAM\_PARAM\_MFSHALLn}}
XPRES\_UV : coefficient for pressure term in wind mixing
\item
\index{XALPHA\_MF!\innam{NAM\_PARAM\_MFSHALLn}}
XALPHA\_MF : coefficient for cloudy fraction
\item
\index{XSIGMA\_MF!\innam{NAM\_PARAM\_MFSHALLn}}
XSIGMA\_MF : coefficient for sigma computation
\item
\index{XFRAC\_UP\_MAX!\innam{NAM\_PARAM\_MFSHALLn}}
XFRAC\_UP\_MAX : maximum Updraft fraction
\item
\index{XA1!\innam{NAM\_PARAM\_MFSHALLn}}
XA1 : Tuning variable for RHCJ10 updraft 
\item
\index{XB!\innam{NAM\_PARAM\_MFSHALLn}}
XB : Tuning variable for RHCJ10 updraft
\item
\index{XC!\innam{NAM\_PARAM\_MFSHALLn}}
XC : Tuning variable for RHCJ10 updraft
\item
\index{XBETA1!\innam{NAM\_PARAM\_MFSHALLn}}
XBETA1 : Tuning variable for RHCJ10 updraft
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_PARAM\_RADn (options for the radiations of model n)}
\index{NAM\_PARAM\_RADn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
XDTRAD         &  real          & XTSTEP \\
XDTRAD\_CLONLY &  real          & XTSTEP \\
CLW            &  4 characters  & 'RRTM'   \\
CAER           &  4 characters  & 'SURF'   \\
CEFRADL        &  4 characters  & 'MART'   \\
CEFRADI        &  4 characters  & 'LIOU'   \\
COPWLW         &  4 characters  & 'SMSH'   \\
COPILW         &  4 characters  & 'EBCU'   \\
COPWSW         &  4 characters  & 'FOUQ'   \\
COPISW         &  4 characters  & 'EBCU'   \\
CAOP           &  4 characters  & 'CLIM'   \\
LCLEAR\_SKY    & logical        & FALSE  \\
NRAD\_COLNBR   & integer        & 1000   \\
NRAD\_DIAG     & integer        & 0  \\
XFUDG          & real           &   1.   \\
LAERO\_FT      & logical        & FALSE  \\
LFIX\_DAT      & logical        & FALSE  \\
LRAD\_DUST     & logical        & FALSE  \\
\hline
\end{tabular}
\end{center}

It contains the options retained for the radiations scheme, used by the 
model n. They are
included in the declarative module MODD\_PARAM\_RADn.

\begin{itemize}
\item
\index{XDTRAD!\innam{NAM\_PARAM\_RADn}}
XDTRAD  : Interval of time (in seconds) between two full radiation
           computations. ( the radiative tendency is computed for all  
           verticals levels). This is done  to save
CPU time because the radiation scheme is very expensive and the radiative 
tendency is not evolving too much, in some cases, during periods greater than 
the model timestep XTSTEP. In this case, the "radiation timestep" is increased
to XDTRAD

\item
\index{XDTRAD\_CLONLY!\innam{NAM\_PARAM\_RADn}}
XDTRAD\_CLONLY : Interval of time (in seconds) between two radiation
 computations for the cloudy columns only. This is based on the same principle
as the intermittent full radiation call: the cloudy column radiative tendency
may, in some cases, evolve faster than the dry ones but still slower than the
timestep XTSTEP. In this case, the "cloudy radiation timestep" is increased
from XDTRAD to XDTRAD\_CLONLY. Of course, when all and part of the radiative tendencies must
be refreshed at the same MESONH timestep, only the full radiation call is
performed. 

\item
\index{CLW!\innam{NAM\_PARAM\_RADn}}
CLW :  choice of long wave radiative code
\begin{itemize}
\item 'RRTM': RAPID RADIATIVE TRANSFER MODEL
\item 'MORC': MORCRETTE model
\end{itemize}

\item
\index{CAER!\innam{NAM\_PARAM\_RADn}}
CAER :  type of aerosol distribution
\begin{itemize}
\item 'SURF': deduced from cover data
\item 'TEGE': computed from Tegen et al. (1997) mensual climatology
(horizontal resolution is $4$ degrees of latitude by $5$ degrees fo longitude
\item 'TANR': computed from ECMWF T5 climatology
\item 'NONE': no aerosol
\end{itemize}

\item
\index{CEFRADL!\innam{NAM\_PARAM\_RADn}}
CEFRADL :  liquid effective radius calculation
\begin{itemize}
\item 'MART' : based on Martin et al. (1994, JAS)
\item 'C2R2' : based on the prediction of the number concentrations.
Recommended with the 2-moment microphysical schemes.
\item 'PRES' : very old parametrization as f(pressure)
\item 'OCLN' : simple distinction between land (10) and ocean (13)
\end{itemize}

\item
\index{CEFRADI!\innam{NAM\_PARAM\_RADn}}
CEFRADI :  ice water effective radius calculation
\begin{itemize}
\item 'LIOU' : ice particle effective radius =f(T) from Liou and Ou (1994)
\item 'SURI' : ice particle effective radius =f(T,IWC) from Sun and Rikus (1999)
\item 'C3R5' : based on the prediction of the number concentrations.
Recommended with the 2-moment microphysical schemes (not yet available for mixed clouds).
\item 'FX40' : fixed 40 micron effective radius
\end{itemize}

\item
\index{COPWLW!\innam{NAM\_PARAM\_RADn}}
COPWLW : cloud water LW optical properties
\begin{itemize}
\item 'SMSH': Smith-Shi formulation
\item 'SAVI': Savijarvi formulation (recommended only with 1-moment microphysical schemes
with small precipitation)
\item 'MALA': Malavelle formulation (recommended only with 2-moment microphysical schemes
with small precipitation)
\end{itemize}

\item
\index{COPILW!\innam{NAM\_PARAM\_RADn}}
COPILW : ice water  LW optical properties
\begin{itemize}
\item 'EBCU': Ebert-Curry formulation
\item 'SMSH': Smith-Shi formulation, only with CLW='RRTM'
\item 'FULI': Fu-Liou  formulation, only with CLW='MORC'
\end{itemize}

\item
\index{COPWSW!\innam{NAM\_PARAM\_RADn}}
COPWSW : cloud water short wave optical properties
\begin{itemize}
\item 'FOUQ': Fouquart, 1991 formulation
\item 'SLIN': Slingo, 1989 formulation
\item 'MALA': Only for 2-moment microphysical schemes. According to Malavelle.
\end{itemize}

\item
\index{COPISW!\innam{NAM\_PARAM\_RADn}}
COPISW : ice water short wave optical properties  
\begin{itemize}
\item 'EBCU': Ebert-Curry formulation
\item 'FULI': Fu-Liou formulation
\end{itemize}

\item
\index{CAOP!\innam{NAM\_PARAM\_RADn}}
CAOP :  type of aerosol optical properties calculation
\begin{itemize}
\item 'CLIM': climatological aerosols
\item 'EXPL': explicit aerosols (if LORILAM=.T. in NAM\_CH\_ORILAM or LDUST=.T. in NAM\_DUST)
\end{itemize}

\item
\index{LCLEAR\_SKY!\innam{NAM\_PARAM\_RADn}}
LCLEAR\_SKY : When this flag is set  to .TRUE., the 
 radiative computations are made for a mean clear-sky and for the whole 
 cloudy columns. This is still the way to spare some CPU time, by postulating
that the clear sky columns do not lead to very different radiative tendencies.
This hypothesis is only valid in academical cases.

\item
\index{NRAD\_COLNBR!\innam{NAM\_PARAM\_RADn}}
NRAD\_COLNBR : Maximal number of air columns called by a single call
of the radiative subroutine. This is performed in order to save
memory, because the radiation subroutine allocate for every column of
size NKMAX , NKMAX working arrays . This leads to a quadratic
dependency of the memory with the number of vertical levels of the
model. A way to limit the necessary memory is to split the number of
columns passed to the radiation subroutine in several sets of
NRAD\_COLNBR column. Finally, all the desired columns ( depending on
the preceding parameters ) will be treated  by sequentially calling
the radiation subroutine for every set of column.

\item
\index{NRAD\_DIAG!\innam{NAM\_PARAM\_RADn}}
NRAD\_DIAG : number of diagnostic fields related to the
radiative scheme stored in every output synchronous file (same fields as
 NRAD\_3D in DIAG program, p.\pageref{nrad3d}).

\item
\index{XFUDG!\innam{NAM\_PARAM\_RADn}}
XFUDG : subgrid cloud inhomogeneity factor.

\item
\index{LAERO\_FT!\innam{NAM\_PARAM\_RADn}}
LAERO\_FT : for a temporal interpolation of aerosol and ozone distribution. 
                                                By default, they consist of monhtly averages kept constant for each month 
                                                If true, the climatology of O3 and aerosols (only in TEGE case) are interpolated at each 
                                                call of phys\_paramnn. 
                                                It is not usefull if your simulation lasts less than a month or does not contain any restard. 
                                                It is necessary for long-term simulation with several segments to avoid too strong  a perturbation at the 
                                                beginning of each month


\item
\index{LFIX\_DAT!\innam{NAM\_PARAM\_RADn}}
LFIX\_DAT : flag to fix the date to a constant perpetual day. It is set by the initial SOUNDING date (RSOU) 
            Note that the diurnal cycle is still considered.
\item
\index{LRAD\_DUST!\innam{NAM\_PARAM\_RADn}}
LRAD\_DUST : if true, the radiativ effect of dusts is take into account
\end{itemize}

The cloud overlap assumption is defined in the routine ini\_radconf.f90.
The different assumptions are :
\begin{itemize}
\item
$NOVLP=5 $ : Random overlap for Clear Sky fraction and Effective Zenithal Angle.
It is the best choice without subgrid condensation.

\item
$NOVLP=6 $ : Maximum Random Overlap for Clear Sky fraction,
and Random Overlap for Effective Zenithal Angle (DEFAULT VALUE). 
This option is well adapted to multi-layer clouds.

\item
$NOVLP=7 $ : Maximum overlap for Clear Sky fraction and Random Overlap
for Effective Zenithal Angle. This option is well adapted in the absence of multi-layer clouds.

\item
$NOVLP=8 $ : Maximum Random overlap for Clear Sky fraction and 
Effective Zenithal Angle. It corresponds to the previous configurations before  masdev4\_7.
\end{itemize}

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_PASPOL (Passive pollutants)}
\index{NAM\_PASPOL!namelist description}
\begin{center}
\begin{tabular}{|l|l|l| }
\hline 
 Fortran name  & Fortran type  & default value \\
\hline
 LPASPOL       & logical       & FALSE         \\
 NRELEASE      & integer       & 0             \\
 CPPINIT       & array (3 characters)& 100*'1PT'\\
 XPPLAT        & array (real)  & 100*0.   \\
 XPPLON        & array (real)  & 100*0.   \\
 XPPMASS       & array (real)  & 100*0.   \\
 XPPBOT        & array (real)  & 100*0.   \\
 XPPTOP        & array (real)  & 100*0.   \\
 CPPT1         & array (14 characters)& 100*'20010921090000'\\
 CPPT2         & array (14 characters)& 100*'20010921090000'\\
 CPPT3         & array (14 characters)& 100*'20010921091500'\\
 CPPT4         & array (14 characters)& 100*'20010921091500'\\
\hline
\end{tabular}
\end{center}

It contains the parameters to activate passive pollutants, by specifying the position and the kinetic of the release. 
\begin{itemize}
\item LPASPOL  \index{LPASPOL!\innam{NAM\_PASPOL}}:
Flag to activate passive pollutants                                            
\item NRELEASE \index{NRELEASE!\innam{NAM\_PASPOL}}:
Number of releases (up to 100).                                                                                                    
\item CPPINIT \index{CPPINIT!\innam{NAM\_PASPOL}}:
Type of initialization of the source ('1PT' or '9PT')          
\item XPPLAT \index{XPPLAT!\innam{NAM\_PASPOL}}:
Latitude of the release                      
\item XPPLON \index{XPPLON!\innam{NAM\_PASPOL}}:
Longitude of the release                      
\item XPPMASS \index{XPPMASS!\innam{NAM\_PASPOL}}:
Released mass (in g)                         
\item XPPBOT \index{XPPBOT!\innam{NAM\_PASPOL}}:
Height of the bottom of the release (in m)          
\item XPPTOP \index{XPPTOP!\innam{NAM\_PASPOL}}:
Height of the top of the release (in m)        
\item CPPT1 \index{CPPT1!\innam{NAM\_PASPOL}}:
Starting date of the release (in YYYYMMDDHHMMSS)        
\item CPPT2 \index{CPPT1!\innam{NAM\_PASPOL}}:
Starting date of the constant rate (in YYYYMMDDHHMMSS)        
\item CPPT3 \index{CPPT1!\innam{NAM\_PASPOL}}:
Ending date of the constant rate (in YYYYMMDDHHMMSS)        
\item CPPT4 \index{CPPT1!\innam{NAM\_PASPOL}}:
Ending date of the release (in YYYYMMDDHHMMSS)        
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_PDF (LES budgets) }                                
\index{NAM\_PDF!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LLES\_PDF                     &  logical          & .FALSE.  \\
NPDF                          & integer           & none \\
XTH\_PDF\_MIN                 & real              & none \\
XTH\_PDF\_MAX                 & real              & none \\
XW\_PDF\_MIN                  & real              & none \\
XW\_PDF\_MAX                  & real              & none \\
XTHV\_PDF\_MIN                 & real              & none \\
XTHV\_PDF\_MAX                 & real              & none \\
XRV\_PDF\_MIN                 & real              & none \\
XRV\_PDF\_MAX                 & real              & none \\
XRC\_PDF\_MIN                 & real              & none \\
XRC\_PDF\_MAX                 & real              & none \\
XRR\_PDF\_MIN                 & real              & none \\
XRR\_PDF\_MAX                 & real              & none \\
XRI\_PDF\_MIN                 & real              & none \\
XRI\_PDF\_MAX                 & real              & none \\
XRS\_PDF\_MIN                 & real              & none \\
XRS\_PDF\_MAX                 & real              & none \\
XRG\_PDF\_MIN                 & real              & none \\
XRG\_PDF\_MAX                 & real              & none \\
XRT\_PDF\_MIN                 & real              & none \\
XRT\_PDF\_MAX                 & real              & none \\
XTHL\_PDF\_MIN                 & real              & none \\
XTHL\_PDF\_MAX                 & real              & none \\
\hline
\end{tabular}
\end{center}

Each PDF includes $NPDF$ intervals number between X\_PDF\_MIN 
and X\_PDF\_MAX.

\begin{itemize}
\item
LLES\_PDF : Flag for pdf computation 

\item
NPDF : Number of PDF intervals           
 
\item
XTH\_PDF\_MIN : Minimum value of potential temperature pdf

\item
XTH\_PDF\_MAX : Maximum value of potential temperature pdf

\item
XW\_PDF\_MIN : Minimum value of vertical velocity pdf

\item
XW\_PDF\_MAX : Maximum value of vertical velocity pdf

\item
XTHV\_PDF\_MIN : Minimum value of virtual potential temperature pdf

\item
XTHV\_PDF\_MAX : Maximum value of virtual potential temperature pdf

\item
XRV\_PDF\_MIN : Minimum value of vapor mixing ratio pdf

\item
XRV\_PDF\_MAX : Maximum value of vapor mixing ratio pdf

\item
XRC\_PDF\_MIN : Minimum value of cloud mixing ratio pdf

\item
XRC\_PDF\_MAX : Maximum value of cloud mixing ratio pdf

\item
XRR\_PDF\_MIN : Minimum value of rain  mixing ratio pdf

\item
XRR\_PDF\_MAX : Maximum value of rain  mixing ratio pdf

\item
XRI\_PDF\_MIN : Minimum value of ice mixing ratio pdf

\item
XRI\_PDF\_MAX : Maximum value of ice mixing ratio pdf

\item
XRS\_PDF\_MIN : Minimum value of snow  mixing ratio pdf

\item
XRS\_PDF\_MAX : Maximum value of snow mixing ratio pdf

\item
XRG\_PDF\_MIN : Minimum value of graupel mixing ratio pdf

\item
XRG\_PDF\_MAX : Maximum value of graupel mixing ratio pdf

\item
XRT\_PDF\_MIN : Minimum value of total mixing ratio pdf

\item
XRT\_PDF\_MAX : Maximum value of total mixing ratio pdf

\item
XTHL\_PDF\_MIN : Minimum value of $\theta_l$ pdf

\item
XTHL\_PDF\_MAX : Maximum value of $\theta_l$ pdf

\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_SALT }
\index{NAM\_SALT!namelist description}
%
This namelist is used to active explicit sea salt aerosols. 
It is not necessary to use chemistry to activate sea salt but it is recommended to activate on-line sea salt emissions (see surface namelists).


\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
LSALT       & logical  & FALSE  \\
LVARSIG\_SLT& logical  & FALSE  \\
LSEDIMSALT  & logical  & FALSE  \\
NMODE\_SLT  & integer  &  3  \\
LRGFIX\_SLT & logical  & FALSE  \\
LDEPOS\_SLT & logical  & FALSE  \\
\hline
\end{tabular}
\end{center}

\begin{itemize}

\index{LSALT!\innam{NAM\_SALT}}
\item LSALT: flag to activate passive salt aerosol.
\index{LVARSIG\_SLT!\innam{NAM\_SALT}}
\item LVARSIG\_SLT: flag to activate variable standard deviation for each salt modes.
\index{LSEDIMSALT!\innam{NAM\_SALT}}
\item LSEDIMSALT: flag to activate salt sedimentation.
\index{NMODE\_SLT!\innam{NAM\_SALT}}
\item  NMODE\_SLT: number of lognormal salt modes (a maximum of 3 modes is allowed).
\index{LRGFIX\_SLT!\innam{NAM\_SALT}}
\item LRGFIX\_SLT: flag to use only 1 moment by salt mode (LRGFIX\_SLT='TRUE' associated to LVARSIG\_SLT='FALSE)
\index{LDEPOS\_SLT!\innam{NAM\_SALT}}
\item LDEPOS\_SLT: flag to activate salt wet deposition  
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_TURB}
\index{NAM\_TURB!namelist description}
It contains the characteristics of the turbulence scheme used by all models.
\begin{center}
\begin{tabular}{|l|l|l| }
\hline 
 Fortran name  & Fortran type  & default value \\
\hline
 XPHI\_LIM        & real        & 3.     \\
 XSBL\_O\_BL      & real        & 0.05   \\
 XFTOP\_O\_FSURF  & real        & 0.05   \\
\hline
\end{tabular}
\end{center}

\begin{itemize}
\item 'XPHI\_LIM'\index{XPHI\_LIM!\innam{NAM\_TURB}} is the threshold value for $\phi _{3}$ and $\psi _{3}$
\item 'XSBL\_O\_BL'\index{XSBL\_O\_BL!\innam{NAM\_TURB}} is SBL height / BL height ratio
\item 'XFTOP\_O\_FSURF'\index{XFTOP\_O\_FSURF!\innam{NAM\_TURB}} is the fraction of surface (heat or momentum) flux used to define top of BL
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_TURB\_CLOUD (mixing length for clouds)}
\index{NAM\_TURB\_CLOUD!namelist description}
\begin{center}
\begin{tabular}{|l|l|l| }
\hline 
 Fortran name  & Fortran type  & default value \\
\hline
 NMODEL\_CLOUD & integer       & 999           \\
 CTURBLEN\_CLOUD & 4 characters       & 'DELT'   \\
 XCOEF\_AMPL\_SAT& real        & 5.   \\
 XCEI\_MIN       & real        & 0.001E-6   \\
 XCEI\_MAX       & real        & 0.01E-6    \\
\hline
\end{tabular}
\end{center}

\begin{itemize}
\item NMODEL\_CLOUD \index{NMODEL\_CLOUD!\innam{NAM\_TURB\_CLOUD}}:
model number where the modification of the mixing length in the clouds is
computed,
\item CTURBLEN\_CLOUD \index{CTURBLEN\_CLOUD!\innam{NAM\_TURB\_CLOUD}}:
type of turbulent mixing length in the clouds
 ('BL89','DELT','DEAR': see CTURBLEN for meanings),
\item XCOEF\_AMPL\_SAT \index{XCOEF\_AMPL\_SAT!\innam{NAM\_TURB\_CLOUD}}:
saturation of the amplification coefficient,
\item XCEI\_MIN \index{XCEI\_MIN!\innam{NAM\_TURB\_CLOUD}}:
minimum threshold for the instability index (in kg/kg/m/s,
 beginning of the amplication),
\item XCEI\_MAX \index{XCEI\_MAX!\innam{NAM\_TURB\_CLOUD}}:
maximum threshold for the instability index (in kg/kg/m/s,
 beginning of the saturation of the amplification).
\end{itemize}
Diagnostic quantities are written on every synchronuous files 
(mixing length in clear sky, mixing length modified, amplification coefficient,...) if LTURB\_DIAG=.TRUE. in NAM\_TURBn.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Namelist NAM\_TURBn (turbulence parameters for model n)}
\index{NAM\_TURBn!namelist description}

\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
XIMPL       &  real          & 1.     \\
CTURBLEN    &  4 characters  & 'BL89'   \\
CTURBDIM    &  4 characters  & '1DIM'   \\
LTURB\_FLX  &  logical       & FALSE  \\
LTURB\_DIAG &  logical       & FALSE  \\
LSUBG\_COND &  logical       & FALSE  \\
CSUBG\_AUCV &  4 characters  & 'NONE' \\
LSIGMAS     &  logical       & TRUE   \\
LSIG\_CONV  &  logical       & FALSE   \\
LRMC01      &  logical       & FALSE  \\
CTOM        &  4 characters  & 'NONE'   \\
XKEMIN      &  real          & 0.01 \\
VSIGQSAT    & real           & 0. \\
\hline
\end{tabular}
\end{center}

It contains the characteristics of the turbulence scheme used by the model n. They are
included in the declarative module MODD\_TURBn
\begin{itemize}
\item
\index{XIMPL!\innam{NAM\_TURBn}}
XIMPL: degree of implicitness of the vertical part of the turbulence scheme.
(XIMPL = 0.5 corresponds to the Cranck-Nicholson scheme for the vertical
turbulent diffusion and  0. to a purely explicit scheme)
\item
\index{CTURBDIM!\innam{NAM\_TURBn}}
CTURBDIM: turbulence dimensionnality. 
\begin{itemize}
\item
CTURBDIM= '1DIM'  Only the vertical turbulent fluxes are taken
into account. This has to be done for relatively large horizontal gridsizes.
\item
CTURBDIM= '3DIM'  All the turbulent fluxes are computed, this is necessary for
small horizontal gridsizes ( meso-$\gamma$ scales or LES)
\end{itemize}

\item
\index{CTURBLEN!\innam{NAM\_TURBn}}
CTURBLEN: type of turbulent mixing length.
\begin{itemize}
\item
CTURBLEN='DELT' If CTURBDIM='3DIM', the cubic root of the grid volum is used
 in 3D simulations and  the squared root of the volum in 2D simulations.
If CTURBB='1DIM', we take 
$\Delta z $ in simulation of any dimensionality. 
This length is always limited to $\kappa * z$  near the ground.
\item
CTURBLEN='BL89'
The mixing length is computed according to the Bougeault and Lacarr\'ere scheme
(refer to the scientific documentation)
\item
CTURBLEN='DEAR'
the mixing length is given by the mesh size depending on the model
dimensionality, this length is limited to the ground distance and
also by the Deardorff mixing length pertinent in the stable cases.
\end{itemize}

\item
\index{LTURB\_FLX!\innam{NAM\_TURBn}}
LTURB\_FLX: flag to compute and store all the turbulent fluxes
 on every output synchronous file.

\item
\index{LTURB\_DIAG!\innam{NAM\_TURBn}}
LTURB\_DIAG: flag to  store diagnostic quantities related to the 
turbulent scheme  on every output synchronous file. (mesh length, Prandtl
number, Schmidt number, sources of TKE...)

\item
\index{LSUBG\_COND!\innam{NAM\_TURBn}}
LSUBG\_COND: flag to activate the subgrid condensation scheme (refer to the scientific 
documentation for more details)

\item
\index{CSUBG\_AUCV!\innam{NAM\_TURBn}}
CSUBG\_AUCV (formerly LSUBG\_AUCV in masdev47) : Type of subgrid autoconversion scheme.
\begin{itemize}
\item  'NONE' 
\item 'SIGM' for Redelsperger and Sommeria (1982) scheme using $\overline{s'r'_{c}}$ 
(if LSUBG\_COND
is set to TRUE and only with the mixed phase for the moment)
\item 'CLFR' from the convective cloud fraction given by EDKF 
(if CSCONV='EDKF' only)
\end{itemize}

\item
\index{LSIGMAS!\innam{NAM\_TURBn}}
LSIGMAS: Flag for using Sigma\_s from turbulence scheme instead parameterized values
in ice subgrid condensation scheme

\item
\index{LSIG\_CONV!\innam{NAM\_TURBn}}
LSIG\_CONV: Flag for computing Sigma\_s due to convection in ice subgrid 
condensation scheme

\item
\index{LRMC01!\innam{NAM\_TURBn}}
LRMC01: Flag for computing separate mixing and dissipative length
in the SBL according to Redelsperger, Mahe and Carlotti 2001

\item
\index{CTOM!\innam{NAM\_TURBn}}
CTOM: Consideration of Third Order Moments.

\begin{itemize}
\item
CTOM='NONE': No Third Order moments                             
\item
CTOM='TM06': Parameterization of Third Order moments of heat fluxes for dry CBL
according to Tomas and Masson (2006).
\end{itemize}

\item
\index{XKEMIN!\innam{NAM\_TURBn}}
XKEMIN: minimum value for the TKE ($m^{2}.s^{-2}$

\item
\index{VSIGQSAT!\innam{NAM\_TURBn}}
VSIGQSAT: coefficient applied to qsat variance contribution. Only available if LSIGMAS=.TRUE.

\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\section{SURFACE SCHEMES: namelists of the externalized surface}
\label{ss:surf}

The further definition of the surface parameters are not done by MESONH itself, but by the externalized surface included in it. 
Here are listed the namelists of SURFEX. See SURFEX documentation for details.

%%%%%%%%%%%%%%%%%%%%%% COPIE DOC SURFEX %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{itemize}
\item NAM\_SSO\index{NAM\_SSO!surfex namelist}
\item NAM\_SURF\_CSTS\index{NAM\_SURF\_CSTS!surfex namelist}
\item NAM\_SURF\_ATM\index{NAM\_SURF\_ATM!surfex namelist}
\item NAM\_WRITE\_SURF\_ATM\index{NAM\_WRITE\_SURF\_ATM!surfex namelist}
\item NAM\_SEAFLUXn\index{NAM\_SEAFLUXn!surfex namelist}
\item NAM\_SURF\_SLT\index{NAM\_SURF\_SLT!surfex namelist}
\item NAM\_WATFLUXn\index{NAM\_WATFLUXn!surfex namelist}
\item NAM\_FLAKEn\index{NAM\_FLAKEn!surfex namelist}
\item NAM\_TREEDRAG\index{NAM\_TREEDRAG!surfex namelist}
\item NAM\_DEEPSOIL\index{NAM\_DEEPSOIL!surfex namelist}
\item NAM\_AGRI\index{NAM\_AGRI!surfex namelist}
\item NAM\_ASSIM\index{NAM\_ASSIM!surfex namelist}
\item NAM\_SGH\_ISBAn\index{NAM\_SGH\_ISBAn!surfex namelist}
\item NAM\_ISBAn\index{NAM\_ISBAn!surfex namelist}
\item NAM\_SURF\_DST\index{NAM\_SURF\_DST!surfex namelist}
\item NAM\_IDEAL\_FLUX\index{NAM\_IDEAL\_FLUX!surfex namelist}
\item NAM\_TEBn\index{NAM\_TEBn!surfex namelist}
\item NAM\_CH\_CONTROLn\index{NAM\_CH\_CONTROLn!surfex namelist}
\item NAM\_CH\_SURFn\index{NAM\_CH\_SURFn!surfex namelist}
\item NAM\_CH\_SEAFLUXn\index{NAM\_CH\_SEAFLUXn!surfex namelist}
\item NAM\_CH\_WATFLUXn\index{NAM\_CH\_WATFLUXn!surfex namelist}
\item NAM\_CH\_TEBn\index{NAM\_CH\_TEBn!surfex namelist}
\item NAM\_CH\_ISBAn\index{NAM\_CH\_ISBAn!surfex namelist}
\item NAM\_CHS\_ORILAM\index{NAM\_CHS\_ORILAM!surfex namelist}
\item NAM\_DIAG\_SURF\_ATMn\index{NAM\_DIAG\_SURF\_ATMn!surfex namelist}
\item NAM\_WRITE\_DIAG\_SURFn\index{NAM\_WRITE\_DIAG\_SURFn!surfex namelist}
\item NAM\_DIAG\_SURFn\index{NAM\_DIAG\_SURFn!surfex namelist}
\item NAM\_DIAG\_ISBAn\index{NAM\_DIAG\_ISBAn!surfex namelist}
\item NAM\_DIAG\_TEBn\index{NAM\_DIAG\_TEBn!surfex namelist}
\item NAM\_DIAG\_FLAKEn\index{NAM\_DIAG\_FLAKEn!surfex namelist}
\item NAM\_DIAG\_OCEANn\index{NAM\_DIAG\_OCEANn!surfex namelist}
\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%
\section{Simulation on the fly of balloons or aircraft in the model fields.}
\label{ss:balloon}

In order to compare the model outputs to airborne observations
and measurements, it can be interesting to simulate the deplacment of a
balloon or an aircraft during the model run (in any model of
gridnesting runs). A balloon is launch at
a given location, and either for a particular density (iso-density balloon),
a particular volume (constant volume balloon)
or ascent speed (radio-sounding). In an ideal case, this suppose to be in conformal projection 
(LCARTESIAN=F in NAM\_CONF\_PRE).
For iso-density balloons, initial 
altitude or pressure is asked. A balloon is advected by the wind of the
model. It can crash. For an aircraft, the flight
legs must be given by the user (location and duration). 

All the prognostic fields (zonal and meridien wind
(from U and V components), vertical velocity, potential temperature, pression,
mixing ratios, tke, radiative surface temperature)
are recorded along the trajectory
of the balloon or the aircraft, as well as the trajectory itself (position in
X, Y and Z directions and orography).
All records are in the diachronic file (.000). Up to 30 balloons and aircraft
can be used.

The specification of the flight characteristics  are not given in a namelist,
but directly in Fortran routines:
\begin{itemize}
\item  {\it ini\_balloon.f90} for balloons,
\item  {\it ini\_aircraft.f90} for aircraft.
\end{itemize}

%%%%%%%%%%%%%%%%%%
\section{Temporal series}
If you need temporal series over one or different single points, you are going to use stationn.f90/ini\_stationn.f90 or profilern.f90/ini\_profilern.f90 (nothing in namelist). If you need temporal series of fields averaged over a cartesian area, you are going to use seriesn.f90/ini\_seriesn.f90 with LSERIES=T in NAM\_SERIES and the dimensions of the area defined in NAM\_SERIESn.

\subsection{Series}
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{\underline{Namelist NAM\_SERIES}}
\label{ss:series}
\index{NAM\_SERIES!namelist description}
\begin{center}
\begin{tabular}{|l|l|l| }
\hline 
 Fortran name & Fortran type  & default value \\
\hline
LSERIES      & boolean & FALSE \\
LMASKLANDSEA & boolean & FALSE \\
LWMINMAX     & boolean & FALSE \\
LSURF        & boolean & FALSE \\
\hline
\end{tabular}
\end{center}

\begin{itemize}
\item LSERIES \index{LSERIES!\innam{NAM\_SERIES}}:
 flag to write temporal series in the diachronic file (.000) of each model:
evolution of horizontally and vertically averaged fields (t), 
evolution of horizontaly averaged vertical profiles (z,t), 
evolution of y-horizontaly averaged fields at one level or verticaly averaged between 2 levels (x,t). 
\item LMASKLANDSEA \index{LMASKLANDSEA!\innam{NAM\_SERIES}}:
 flag to separate sea and land points in temporal series (t) and (z,t),
\item LWMINMAX \index{LWMINMAX!\innam{NAM\_SERIES}}:
 flag to compute minimum and maximum of vertical velocity W in temporal serie
(t).
\item LSURF \index{LSURF!\innam{NAM\_SERIES}}: flag to compute temporal series on surface fields.
You have to introduce in the code the surface fields you want : 
\begin{itemize}
\item In  get\_seriesn.f90 of SURFEX : put the requested fields in ZINF. In the example of the current version XTS, XT\_MNW,XT\_BOT, XCT, XH\_ML from modd\_flaken.f90 are requested.
\item In get\_surf\_varn.f90 of SURFEX: adjust the tile necessary to be present (in the example PWATER is required)
\item In ini\_seriesn.f90 of Meso-NH : put the number of requested fields  : ex: for 5 fields, NSTEMP\_SERIE1 = NSTEMP\_SERIE1 +5 and give the tittle of each field
\item In seriesn.f90 of Meso-NH : give the tittle of each field
\end{itemize}
\end{itemize}
See also the namelist NAM\_SERIESn. \\

Some examples of temporal series are available which treat pronostic fields 
averaged or not vertically. For other fields (for example diagnostic
fields such as relative humidity), the following Fortran
routines must be modified:
\begin{itemize}
\item  {\it ini\_series.f90} for initialization of size and name of diachronic
records,
\item  {\it seriesn.f90} to store and possibly vertically average values 
during the run,
\item  {\it write\_seriesn.f90} to horizontally average and write series in
diachronic file.
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Namelist NAM\_SERIESn (temporal series in diagnostic file of model n)} 
\index{NAM\_SERIESn!namelist description}
\begin{center}
\begin{tabular} {|l|l|l|}
\hline
Fortran name & Fortran type & default value \\
\hline
NIBOXL       & integer      & 1             \\
NIBOXH       & integer      & 1             \\
NJBOXL       & integer      & 1             \\
NJBOXH       & integer      & 1             \\
NKCLS        & integer      & 1            \\
NKCLA        & integer      & 1             \\
NKLOW        & integer      & 1             \\
NKMID        & integer      & 1             \\
NKUP         & integer      & 1             \\
NBJSLICE     & integer      & 1             \\
NJSLICEL     & array (20 integer)      & 20*1            \\
NJSLICEH     & array (20 integer)      & 20*1            \\
NFREQSERIES  & integer      & 43200/(100*60)=7     \\
\hline
\end{tabular}
\end{center}
\index{NIBOXL!\innam{NAM\_SERIESn}}
\index{NIBOXH!\innam{NAM\_SERIESn}}
\index{NJBOXL!\innam{NAM\_SERIESn}}
\index{NJBOXH!\innam{NAM\_SERIESn}}
\index{NKCLS!\innam{NAM\_SERIESn}}
\index{NKCLA!\innam{NAM\_SERIESn}}
\index{NKLOW!\innam{NAM\_SERIESn}}
\index{NKMID!\innam{NAM\_SERIESn}}
\index{NKUP!\innam{NAM\_SERIESn}}
\index{NBJSLICE!\innam{NAM\_SERIESn}}
\index{NJSLICEL!\innam{NAM\_SERIESn}}
\index{NJSLICEH!\innam{NAM\_SERIESn}}
\index{NFREQSERIES!\innam{NAM\_SERIESn}}


\begin{itemize}
\item
NIBOXL, NIBOXH, NJBOXL, NJBOXH: lower and upper indexes along x and y axes, respectively, 
 of the horizontal box used to average the series (t) and (z,t) in physical domain
\item
NKCLS, NKCLA: K level in physical domain respectively in the CLS and CLA ((x,t) series of
 U, Rv, Rr at KCLS and W at KCLA are stored).
\item NKLOW, NKUP: two K levels in physical domain ((x,t) series of mean W between KLOW and KUP
 and mean Rc between the ground and KUP are stored).
\item NKMID: a K level in physical domain ((x,t) serie of Rv at KMID is stored).
\item NBJSLICE: number of y-slices for (x,t) serie.
\item NJSLICEL, NJSLICEH: lower and higher index along y axe for the y-slices in physical domain.
\item NFREQSERIES : Temporal frequency of diagnostic writing (in time step unit).                    
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Profilers and stations} 
\label{ss:station}
To compare the model outputs to observations
and measurements, it can be interesting to store the simulated data for a given
profiler or station. Calculations are done for all the nested models and recorded in the corresponding diachronic files.
 A profiler is located at a given location defined by its
latitude and longitude, whereas a station is located with its latitude, 
longitude and altitude.
Pronostic fields are recorded at a prescribed time frequency : 
zonal and meridien wind
(from U and V components), vertical velocity, potential temperature, pression,
mixing ratios, tke, radiative surface temperature.
If surface diagnostics are asked (see surface namelists), surface variables
(10m-wind, 2m-temperature and humidity, surface fluxes) are also recorded. But if you want to add a new surface field, you have to introduce it in all the following routines : mnhget\_surf\_paramn.f90, ground\_paramn.f90, ini\_diag\_in\_run.f90, modd\_diag\_in\_run.f90, end\_diag\_in\_run.f90, modd\_type\_profiler.f90, ini\_posprofilern.f90, profilern.f90  following the example to HU2M field. 


The specification of the characteristics of profilers and stations are not
 given in a namelist, but directly in Fortran routines: 
\begin{itemize}
\item  {\it ini\_profilern.f90} for profilers,
\item  {\it ini\_stationn.f90} for stations.
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Run MESONH with ForeFire}
 If you want to use coupled (inline) run with FOREFIRE and MESONH you have to follow the instructions given in  the file A-INSTALL ( \url{http://mesonh.aero.obs-mip.fr/mesonh51/Download} to compile MESONH.
The documentation of ForeFire  is available in the mesonh website : \url{http://mesonh.aero.obs-mip.fr/mesonh51//BooksAndGuides}

%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Examples }

\underline{FILE {\bf EXSEG1.nam} for the previous example of prep\_ideal\_case}

\begin{verbatim}
&NAM_LUNITn  CINIFILE = "HYD2D",CINIFILEPGD = "HYD2D_PGD" /
&NAM_CONFn  LUSERV = T /
&NAM_DYNn  XTSTEP = 60., LITRADJ= T,
           LHORELAX_UVWTH = T, LVE_RELAX = T, NRIMX = 5, NRIMY = 3, 
           XRIMKMAX = .00166,  XT4DIFU = 1500. /
&NAM_PARAMn  CTURB = "TKEL", CRAD = "NONE", CCLOUD = "NONE" /
&NAM_TURBn XIMPL = 1., CTURBLEN = "BL89", CTURBDIM = "1DIM", LTURB_DIAG = T,
           LTURB_FLX = T /
&NAM_LBCn CLBCX = 2*"OPEN", CLBCY = 2*"CYCL", XCPHASE = 20. /
&NAM_CONF CCONF = "START", LTHINSHELL = T, L2D = T, LFLAT = F, NMODEL = 1, 
          CEQNSYS="DUR", NVERB = 1, CEXP = "EXPER", CSEG = "HYD2D" /
&NAM_DYN  XSEGLEN =20000., XASSELIN = 0.2, LCORIO = F, XALKTOP = 0.005,
          XALZBOT = 12570., LNUMDIFU =.T. /
&NAM_FMOUT XFMOUT(1,1) = 10000., XFMOUT(1,2) = 20000. /
&NAM_BLANK /
\end{verbatim}
\newpage
\underline{FILE {\bf EXSEG1.nam} for a real case}

\begin{verbatim}
&NAM_LUNITn  CINIFILE = "16J36.1.12B18.001",
             CINIFILEPGD = "16JAN_36km.neste1",
              CCPLFILE(1) = "16JAN_06_MNH" /
&NAM_CONFn  LUSERV = T, LUSERC = T, LUSERR = T ,
             LUSERI = T, LUSERS = T, LUSERG =T, LUSECI= T /
&NAM_DYNn  XTSTEP = 75.,  CPRESOPT = "RICHA", NITR = 8,
            LHORELAX_UVWTH = T, LHORELAX_RV = T, LVE_RELAX = T,
            NRIMX = 5, NRIMY = 5, XRIMKMAX = 0.0083, XT4DIFU = 5000. /
&NAM_ADVn  CMET_ADV_SCHEME = "PPM_00", CSV_ADV_SCHEME = "PPM_00" /
&NAM_PARAMn  CCLOUD = "ICE3",CTURB = "TKEL", CRAD = "ECMWF"
              CGROUND = "ISBA", CDCONV = "KAFR", CSCONV="EDKF" /
&NAM_PARAM_RADn  XDTRAD = 300., XDTRAD_CLONLY = 150.,
                  NRAD_COLNBR = 400 CAER='TANR' CLW="MORC"/
&NAM_PARAM_KAFRn XDTCONV = 300., NICE = 1 LREFRESH_ALL = T, LDOWN = T /
&NAM_PARAM_GROUNDN CROUGH='Z01D' /
&NAM_LBCn  CLBCX = 2*"OPEN", CLBCY = 2*"OPEN" /
&NAM_TURBn  CTURBLEN = "BL89", CTURBDIM = "1DIM", LSUBG_COND=.T., CSUBG_AUCV="CLFR",
           LTURB_DIAG=.FALSE.,  LTURB_FLX=.FALSE. LSIG_CONV=F, LSIGMAS=T /
&NAM_CONF  CCONF = "RESTA", NVERB=2,
            NMODEL = 2, CEXP = "16J36", CSEG = "12B18" /
&NAM_DYN  XSEGLEN = 800., LCORIO = T, LNUMDIFU = T,XALKTOP = 0.001, XALZBOT = 14500. /
&NAM_NESTING NDAD(2) = 1, NDTRATIO(2) = 3, XWAY(2) = 3. /
&NAM_FMOUT XFMOUT(1,1) = 10800., XFMOUT(1,2) = 21600. ,
           XFMOUT(2,1) = 10800., XFMOUT(2,2) = 21600. /

&NAM_ISBAn CRUNOFF = "WSAT", CSCOND  = "NP89", CALBEDO = "DRY",
       CC1DRY     = 'DEF', CSOILFRZ   = 'DEF', CDIFSFCOND = 'DEF', 
       CSNOWRES   = 'DEF', CROUGH = 'Z04D'/
&NAM_SEAFLUXn CSEA_ALB="UNIF", CSEA_FLUX="DIRECT"/
&NAM_DIAG_SURFn /
&NAM_DIAG_ISBAn /
&NAM_DIAG_SURF_ATMn /
\end{verbatim}
The five latest namelists are for the externalised surface.

